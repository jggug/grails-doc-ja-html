<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>7 Web&#12524;&#12452;&#12516; 2.3.0.BUILD-SNAPSHOT</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <ul>
        <li>
            <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                <a href="../guide/index.html" class="button">Table of contents</a>

                <div id="nav-summary-childs" style="display:none;">
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/introduction.html"><strong>1</strong><span>&#12452;&#12531;&#12488;&#12525;&#12480;&#12463;&#12471;&#12519;&#12531;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/gettingStarted.html"><strong>2</strong><span>&#12473;&#12479;&#12540;&#12488;&#12460;&#12452;&#12489;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/upgradingFromPreviousVersionsOfGrails.html"><strong>3</strong><span>Grails&#19979;&#20301;&#12496;&#12540;&#12472;&#12519;&#12531;&#12363;&#12425;&#12398;&#26356;&#26032;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/conf.html"><strong>4</strong><span>&#35373;&#23450;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/commandLine.html"><strong>5</strong><span>&#12467;&#12510;&#12531;&#12489;&#12521;&#12452;&#12531;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/GORM.html"><strong>6</strong><span>O/R&#12510;&#12483;&#12500;&#12531;&#12464; (GORM)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/theWebLayer.html"><strong>7</strong><span>Web&#12524;&#12452;&#12516;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/webServices.html"><strong>8</strong><span>Web&#12469;&#12540;&#12499;&#12473;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/async.html"><strong>9</strong><span>&#38750;&#21516;&#26399;&#12503;&#12525;&#12464;&#12521;&#12511;&#12531;&#12464;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/validation.html"><strong>10</strong><span>&#12496;&#12522;&#12487;&#12540;&#12471;&#12519;&#12531;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/services.html"><strong>11</strong><span>&#12469;&#12540;&#12499;&#12473;&#12524;&#12452;&#12516;&#12540;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/testing.html"><strong>12</strong><span>&#12486;&#12473;&#12488;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/i18n.html"><strong>13</strong><span>&#22269;&#38555;&#21270;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/security.html"><strong>14</strong><span>&#12475;&#12461;&#12517;&#12522;&#12486;&#12451;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/plugins.html"><strong>15</strong><span>&#12503;&#12521;&#12464;&#12452;&#12531;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/spring.html"><strong>16</strong><span>Grails&#12392;Spring</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/hibernate.html"><strong>17</strong><span>Grails&#12392;Hibernate</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/scaffolding.html"><strong>18</strong><span>&#12473;&#12459;&#12483;&#12501;&#12457;&#12523;&#12489;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/deployment.html"><strong>19</strong><span>&#12487;&#12503;&#12525;&#12452;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/contributing.html"><strong>20</strong><span>Grails&#12395;&#36002;&#29486;&#12377;&#12427;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/traslateReport.html"><strong>21</strong><span>&#32763;&#35379;&#12524;&#12509;&#12540;&#12488;</span></a>
                    </div>
                    
                </div>
            </div>
        </li>
        <li class="separator selected">
            <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
        </li>
    </ul>
</div>
<div id="header">
    <div class="images clearfix">
        
        <span id="logo"><a href="http://grails.org" target="_blank"><img alt="Grails Logo" title="The Grails Framework" src="../../img/grails.png" border="0"/></a></span>
        
        
        <span id="sponsor"><a href="http://springsource.com" target="_blank"><img alt="SpringSource Logo" title="SpringSource - Weapons for the War on Java Complexity" src="../../img/springsource-logo.png" border="0"/></a></span>
        
    </div>
    <p>See the light - agile, industrial strength, rapid web application development made easy</p>
</div>


<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../guide/GORM.html">&lt;&lt; <strong>6</strong><span>O/R&#12510;&#12483;&#12500;&#12531;&#12464; (GORM)</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../guide/webServices.html"><strong>8</strong><span>Web&#12469;&#12540;&#12499;&#12473;</span> >></a></div>
                


                <div class="project">
                    <h1>7 Web&#12524;&#12452;&#12516; - Reference Documentation</h1>

                    <p><strong>Authors:</strong> Graeme Rocher, Peter Ledbrook, Marc Palmer, Jeff Brown, Luke Daley, Burt Beckwith</p>

                    <p><strong>Version:</strong> 2.3.0.BUILD-SNAPSHOT</p>

                    
                    <p><strong>Translated by:</strong> T.Yamamoto, Japanese Grails Doc Translating Team. <br/>【注意】このドキュメントの内容はスナップショットバージョンを元に*意訳*されているため、一部現行バージョンでは未対応の機能もあります。</p>
                    
                </div>

                
                <div id="table-of-content">
                    <h2>Table of Contents</h2>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#controllers"><strong>7.1</strong><span>&#12467;&#12531;&#12488;&#12525;&#12540;&#12521;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#understandingControllersAndActions"><strong>7.1.1</strong><span>&#12467;&#12531;&#12488;&#12525;&#12540;&#12521;&#12392;&#12450;&#12463;&#12471;&#12519;&#12531;&#12398;&#29702;&#35299;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#controllersAndScopes"><strong>7.1.2</strong><span>&#12467;&#12531;&#12488;&#12525;&#12540;&#12521;&#12392;&#12473;&#12467;&#12540;&#12503;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#modelsAndViews"><strong>7.1.3</strong><span>&#12514;&#12487;&#12523;&#12392;&#12499;&#12517;&#12540;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#redirectsAndChaining"><strong>7.1.4</strong><span>&#12522;&#12480;&#12452;&#12524;&#12463;&#12488;&#12392;&#12481;&#12455;&#12452;&#12531;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#interceptors"><strong>7.1.5</strong><span>&#12467;&#12531;&#12488;&#12525;&#12540;&#12521;&#12539;&#12452;&#12531;&#12479;&#12540;&#12475;&#12503;&#12479;&#12540;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#dataBinding"><strong>7.1.6</strong><span>&#12487;&#12540;&#12479;&#12496;&#12452;&#12531;&#12487;&#12451;&#12531;&#12464;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#xmlAndJSON"><strong>7.1.7</strong><span>XML&#12392;JSON&#12398;&#12524;&#12473;&#12509;&#12531;&#12473;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#moreOnJSONBuilder"><strong>7.1.8</strong><span>JSONBuilder (JSON&#12499;&#12523;&#12480;&#12540;)</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#uploadingFiles"><strong>7.1.9</strong><span>&#12501;&#12449;&#12452;&#12523;&#12450;&#12483;&#12503;&#12525;&#12540;&#12489;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#commandObjects"><strong>7.1.10</strong><span>&#12467;&#12510;&#12531;&#12489;&#12458;&#12502;&#12472;&#12455;&#12463;&#12488;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#formtokens"><strong>7.1.11</strong><span>&#12501;&#12457;&#12540;&#12512;&#20108;&#37325;&#36865;&#20449;&#12398;&#12495;&#12531;&#12489;&#12522;&#12531;&#12464;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#typeConverters"><strong>7.1.12</strong><span>&#12471;&#12531;&#12503;&#12523;&#12479;&#12452;&#12503;&#12467;&#12531;&#12496;&#12540;&#12479;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#gsp"><strong>7.2</strong><span>Groovy&#12469;&#12540;&#12496;&#12540;&#12506;&#12540;&#12472;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#GSPBasics"><strong>7.2.1</strong><span>GSP&#12398;&#22522;&#26412;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#variablesAndScopes"><strong>7.2.1.1</strong><span>&#22793;&#25968;&#12392;&#12473;&#12467;&#12540;&#12503;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#logicAndIteration"><strong>7.2.1.2</strong><span>&#12525;&#12472;&#12483;&#12463;&#12392;&#12452;&#12486;&#12524;&#12540;&#12471;&#12519;&#12531;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#pageDirectives"><strong>7.2.1.3</strong><span>&#12506;&#12540;&#12472;&#12487;&#12451;&#12524;&#12463;&#12486;&#12451;&#12502;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#expressions"><strong>7.2.1.4</strong><span>&#12456;&#12463;&#12473;&#12503;&#12524;&#12483;&#12471;&#12519;&#12531;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#tags"><strong>7.2.2</strong><span>GSP&#12479;&#12464;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#tagVariablesAndScopes"><strong>7.2.2.1</strong><span>&#22793;&#25968;&#12392;&#12473;&#12467;&#12540;&#12503;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#tagLogicAndIteration"><strong>7.2.2.2</strong><span>&#12525;&#12472;&#12483;&#12463;&#12392;&#12452;&#12486;&#12524;&#12540;&#12471;&#12519;&#12531;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#searchAndFiltering"><strong>7.2.2.3</strong><span>&#26908;&#32034;&#12392;&#12501;&#12451;&#12523;&#12479;&#12522;&#12531;&#12464;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#linksAndResources"><strong>7.2.2.4</strong><span>&#12522;&#12531;&#12463;&#12392;&#12522;&#12477;&#12540;&#12473;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#formsAndFields"><strong>7.2.2.5</strong><span>&#12501;&#12457;&#12540;&#12512;&#12392;&#12501;&#12451;&#12540;&#12523;&#12489;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#tagsAsMethodCalls"><strong>7.2.2.6</strong><span>&#12479;&#12464;&#12434;&#12513;&#12477;&#12483;&#12489;&#12392;&#12375;&#12390;&#20351;&#29992;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#viewsAndTemplates"><strong>7.2.3</strong><span>&#12499;&#12517;&#12540;&#12392;&#12486;&#12531;&#12503;&#12524;&#12540;&#12488;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#layouts"><strong>7.2.4</strong><span>Sitemesh&#12391;&#12524;&#12452;&#12450;&#12454;&#12488;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#resources"><strong>7.2.5</strong><span>&#38745;&#30340;&#12522;&#12477;&#12540;&#12473;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#includingResourcesUsingTheResourceTags"><strong>7.2.5.1</strong><span>&#12522;&#12477;&#12540;&#12473;&#12479;&#12464;&#12391;&#12398;&#12522;&#12477;&#12540;&#12473;&#12398;&#20351;&#29992;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#otherResourceTags"><strong>7.2.5.2</strong><span>&#20182;&#12398;&#12522;&#12477;&#12540;&#12473;&#12479;&#12464;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#declaringResources"><strong>7.2.5.3</strong><span>&#12522;&#12477;&#12540;&#12473;&#12398;&#23459;&#35328;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#overridingPluginResources"><strong>7.2.5.4</strong><span>&#12503;&#12521;&#12464;&#12452;&#12531;&#12522;&#12477;&#12540;&#12473;&#12398;&#12458;&#12540;&#12496;&#12540;&#12521;&#12452;&#12489;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#optimizingYourResources"><strong>7.2.5.5</strong><span>&#12522;&#12477;&#12540;&#12473;&#12398;&#26368;&#36969;&#21270;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#debugging"><strong>7.2.5.6</strong><span>&#12487;&#12496;&#12483;&#12464;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#preventingProcessingOfResources"><strong>7.2.5.7</strong><span>&#12522;&#12477;&#12540;&#12473;&#29983;&#25104;&#12539;&#22793;&#25563;&#20966;&#29702;&#12434;&#38450;&#12368;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#otherResourcesPlugins"><strong>7.2.5.8</strong><span>&#12522;&#12477;&#12540;&#12473;&#38306;&#36899;&#12398;&#12503;&#12521;&#12464;&#12452;&#12531;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#sitemeshContentBlocks"><strong>7.2.6</strong><span>Sitemesh&#12467;&#12531;&#12486;&#12531;&#12488;&#12502;&#12525;&#12483;&#12463;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#makingChangesToADeployedApplication"><strong>7.2.7</strong><span>&#12487;&#12503;&#12525;&#12452;&#12373;&#12428;&#12383;&#12450;&#12503;&#12522;&#12465;&#12540;&#12471;&#12519;&#12531;&#12408;&#12398;&#22793;&#26356;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#GSPDebugging"><strong>7.2.8</strong><span>GSP&#12487;&#12496;&#12483;&#12464;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#taglibs"><strong>7.3</strong><span>&#12479;&#12464;&#12521;&#12452;&#12502;&#12521;&#12522;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#taglibVariablesAndScopes"><strong>7.3.1</strong><span>&#22793;&#25968;&#12392;&#12473;&#12467;&#12540;&#12503;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#simpleTags"><strong>7.3.2</strong><span>&#31777;&#21336;&#12394;&#12479;&#12464;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#logicalTags"><strong>7.3.3</strong><span>&#21046;&#24481;&#12479;&#12464;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#iterativeTags"><strong>7.3.4</strong><span>&#12452;&#12486;&#12524;&#12540;&#12488;&#12479;&#12464;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#namespaces"><strong>7.3.5</strong><span>&#12479;&#12464;&#12493;&#12540;&#12512;&#12473;&#12506;&#12540;&#12473;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#usingJSPTagLibraries"><strong>7.3.6</strong><span>JSP&#12479;&#12464;&#12521;&#12452;&#12502;&#12521;&#12522;&#12398;&#20351;&#29992;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#tagReturnValue"><strong>7.3.7</strong><span>&#12479;&#12464;&#12398;&#25147;&#12426;&#20516;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#urlmappings"><strong>7.4</strong><span>URL&#12510;&#12483;&#12500;&#12531;&#12464;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#mappingToControllersAndActions"><strong>7.4.1</strong><span>&#12467;&#12531;&#12488;&#12525;&#12540;&#12521;&#12392;&#12450;&#12463;&#12471;&#12519;&#12531;&#12395;&#12510;&#12483;&#12500;&#12531;&#12464;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#restfulMappings"><strong>7.4.2</strong><span>REST&#12522;&#12477;&#12540;&#12473;&#12408;&#12398;&#12510;&#12483;&#12500;&#12531;&#12464;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#embeddedVariables"><strong>7.4.3</strong><span>&#22475;&#36796;&#22793;&#25968;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#mappingToViews"><strong>7.4.4</strong><span>&#12499;&#12517;&#12540;&#12408;&#12510;&#12483;&#12500;&#12531;&#12464;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#mappingToResponseCodes"><strong>7.4.5</strong><span>&#12524;&#12473;&#12509;&#12531;&#12473;&#12467;&#12540;&#12489;&#12408;&#12510;&#12483;&#12500;&#12531;&#12464;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#mappingHTTP"><strong>7.4.6</strong><span>HTTP&#12513;&#12477;&#12483;&#12489;&#12408;&#12510;&#12483;&#12500;&#12531;&#12464;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#mappingWildcards"><strong>7.4.7</strong><span>&#12510;&#12483;&#12500;&#12531;&#12464;&#12527;&#12452;&#12523;&#12489;&#12459;&#12540;&#12489;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#automaticLinkRewriting"><strong>7.4.8</strong><span>&#33258;&#21205;&#12522;&#12531;&#12463;&#12522;&#12521;&#12452;&#12488;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#applyingConstraints"><strong>7.4.9</strong><span>&#21046;&#32004;&#12398;&#36969;&#29992;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#namedMappings"><strong>7.4.10</strong><span>&#21517;&#21069;&#20184;&#12365;URL&#12510;&#12483;&#12500;&#12531;&#12464;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#customizingUrlFormat"><strong>7.4.11</strong><span>URL&#12501;&#12457;&#12540;&#12510;&#12483;&#12488;&#12398;&#12459;&#12473;&#12479;&#12510;&#12452;&#12474;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#namespacedControllers"><strong>7.4.12</strong><span>&#12467;&#12531;&#12488;&#12525;&#12540;&#12521;&#12493;&#12540;&#12512;&#12473;&#12506;&#12540;&#12473;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#webflow"><strong>7.5</strong><span>Web&#12501;&#12525;&#12540;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#startAndEndStates"><strong>7.5.1</strong><span>&#38283;&#22987;&#12392;&#32066;&#20102;&#12398;&#12473;&#12486;&#12540;&#12488;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#actionStatesAndViewStates"><strong>7.5.2</strong><span>&#12450;&#12463;&#12471;&#12519;&#12531;&#12473;&#12486;&#12540;&#12488;&#12392;&#12499;&#12517;&#12540;&#12473;&#12486;&#12540;&#12488;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#flowExecutionEvents"><strong>7.5.3</strong><span>&#12501;&#12525;&#12540;&#23455;&#34892;&#12452;&#12505;&#12531;&#12488;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#flowScopes"><strong>7.5.4</strong><span>&#12501;&#12525;&#12540;&#12398;&#12473;&#12467;&#12540;&#12503;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#dataBindingAndValidation"><strong>7.5.5</strong><span>&#12487;&#12540;&#12479;&#12496;&#12452;&#12531;&#12487;&#12451;&#12531;&#12464;&#12392;&#12496;&#12522;&#12487;&#12540;&#12471;&#12519;&#12531;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#subflowsAndConversations"><strong>7.5.6</strong><span>&#12469;&#12502;&#12501;&#12525;&#12540;&#12392;&#12398;&#23550;&#35441;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#filters"><strong>7.6</strong><span>&#12501;&#12451;&#12523;&#12479;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#applyingFilters"><strong>7.6.1</strong><span>&#12501;&#12451;&#12523;&#12479;&#12398;&#36969;&#29992;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#filterTypes"><strong>7.6.2</strong><span>&#12501;&#12451;&#12523;&#12479;&#12398;&#31278;&#39006;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#filterVariablesAndScopes"><strong>7.6.3</strong><span>&#22793;&#25968;&#12392;&#12473;&#12467;&#12540;&#12503;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#filterDependencies"><strong>7.6.4</strong><span>&#12501;&#12451;&#12523;&#12479;&#20381;&#23384;&#38306;&#20418;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#ajax"><strong>7.7</strong><span>Ajax</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#ajaxSupport"><strong>7.7.1</strong><span>Ajax&#23550;&#24540;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#remotingLinking"><strong>7.7.1.1</strong><span>&#12522;&#12514;&#12540;&#12488;&#12522;&#12531;&#12463;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#updatingContent"><strong>7.7.1.2</strong><span>&#12467;&#12531;&#12486;&#12531;&#12484;&#12398;&#26356;&#26032;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#remoteFormSubmission"><strong>7.7.1.3</strong><span>&#12522;&#12514;&#12540;&#12488;&#12501;&#12457;&#12540;&#12512;&#36865;&#20449;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#ajaxEvents"><strong>7.7.1.4</strong><span>Ajax&#12452;&#12505;&#12531;&#12488;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#ajaxWithPrototype"><strong>7.7.2</strong><span>Prototype&#12434;&#20351;&#29992;&#12375;&#12383;Ajax</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#ajaxWithDojo"><strong>7.7.3</strong><span>Dojo&#12434;&#20351;&#29992;&#12375;&#12383;Ajax</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#ajaxWithGWT"><strong>7.7.4</strong><span>GWT&#12434;&#20351;&#29992;&#12375;&#12383;Ajax</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#ajaxOnTheServer"><strong>7.7.5</strong><span>Ajax&#20351;&#29992;&#26178;&#12398;&#12469;&#12540;&#12496;&#12469;&#12452;&#12489;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#contentNegotiation"><strong>7.8</strong><span>&#12467;&#12531;&#12486;&#12531;&#12488;&#12493;&#12468;&#12471;&#12456;&#12540;&#12471;&#12519;&#12531;</span></a>
                    </div>
                    
                </div>
                

                
<a name="7. The Web Layer"><!-- Legacy link --></a>
<h1 id="theWebLayer">7 Webレイヤ</h1>


<a name="7.1 Controllers"><!-- Legacy link --></a>
<h2 id="controllers">7.1 コントローラ</h2>
<div class="hidden-block">A controller handles requests and creates or prepares the response. A controller can generate the response directly or delegate to a view. To create a controller, simply create a class whose name ends with <code>Controller</code> in the <code>grails-app/controllers</code> directory (in a subdirectory if it's in a package).</div>
コントローラはリクエストを処理してレスポンスの準備・作成を行います。コントローラはレスポンスをビューに委譲したり、直接返す事ができます。単純に<code>grails-app/controlers</code>ディレクトリに、クラス名称の最後を<code>Controller</code>にしたクラスを作成することで、コントローラを追加できます。(パッケージに入れる場合は、パッケージ名のサブディレクトリに作成します。)<p class="paragraph"/><div class="hidden-block">The default <a href="../guide/single.html#urlmappings" class="guide">URL Mapping</a> configuration ensures that the first part of your controller name is mapped to a URI and each action defined within your controller maps to URIs within the controller name URI.</div>
<a href="../guide/single.html#urlmappings" class="guide">URL マッピング</a>のデフォルト設定では、Controllerの前に付けた名称がベースのURIにマップされ、コントローラに定義したそれぞれのアクション名称がコントローラ名称と繫がれてURIをマップします。


<a name="7.1.1 Understanding Controllers and Actions"><!-- Legacy link --></a>
<h2 id="understandingControllersAndActions">7.1.1 コントローラとアクションの理解</h2>
<h4>コントローラを作成する</h4><p class="paragraph"/><div class="hidden-block">Controllers can be created with the <a href="../ref/Command Line/create-controller.html" class="commandLine">create-controller</a> or <a href="../ref/Command Line/generate-controller.html" class="commandLine">generate-controller</a> command. For example try running the following command from the root of a Grails project:</div>
<a href="../ref/Command Line/create-controller.html" class="commandLine">create-controller</a>または<a href="../ref/Command Line/generate-controller.html" class="commandLine">generate-controller</a>コマンドでコントローラが作成できます。Grailsプロジェクトのルートで以下のようにコマンドを実行します。<p class="paragraph"/><div class="code"><pre>grails create&#45;controller book</pre></div><p class="paragraph"/><div class="hidden-block">The command will create a controller at the location <code>grails-app/controllers/myapp/BookController.groovy</code>:</div>
コマンドを実行すると<code>grails-app/controllers/myapp/BookController.groovy</code>にコントローラを生成します。<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">package</span> myapp<p class="paragraph"/>class BookController &#123;<p class="paragraph"/>    def index() &#123; &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">where "myapp" will be the name of your application, the default package name if one isn't specified.</div>
パッケージ名を指定しない場合は、"myapp"というアプリケーション名であれば、自動的にデフォルトパッケージとして生成されます。<p class="paragraph"/><div class="hidden-block"><code>BookController</code> by default maps to the /book URI (relative to your application root).</div>
デフォルトでは、<code>BookController</code>は、URIが /bookとなります。(アプリケーションのコンテキストルートからの相対パス)<p class="paragraph"/><div class="hidden-block"><blockquote class="note">
The <code>create-controller</code> and <code>generate-controller</code> commands are just for convenience and you can just as easily create controllers using your favorite text editor or IDE
<code>create-controller</code>と<code>generate-controller</code>コマンドは、簡単にコントローラを生成する便利なコマンドですが、IDEやテキストエディタの機能でクラスを作成してもかまいません。
</blockquote></div>
<blockquote class="note">
<code>create-controller</code>と<code>generate-controller</code>コマンドは、簡単にコントローラを生成する便利なコマンドですが、IDEやテキストエディタの機能でクラスを作成してもかまいません。
</blockquote><p class="paragraph"/><h4>アクションの作成</h4><p class="paragraph"/><div class="hidden-block">A controller can have multiple public action methods; each one maps to a URI:</div>
コントローラは複数のアクションメソッドを持つことができます。それぞれURIにマップされます:<p class="paragraph"/><div class="code"><pre>class BookController &#123;<p class="paragraph"/>    def list() &#123;<p class="paragraph"/>        // <span class="java&#45;keyword">do</span> controller logic
        // create model<p class="paragraph"/>        <span class="java&#45;keyword">return</span> model
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">This example maps to the <code>/book/list</code> URI by default thanks to the property being named <code>list</code>.</div>
この例では、アクションメソッド名が<code>list</code>なので、URIは<code>/book/list</code>にマップされます。<p class="paragraph"/><h4>パブリックメソッドをアクションとする</h4><p class="paragraph"/><div class="hidden-block">In earlier versions of Grails actions were implemented with Closures. This is still supported, but the preferred approach is to use methods.</div>
以前のバージョンまでは、アクションがクロージャで実装されてました。この方式はまだサポートされています。ただし今後のアクションの実装はメソッドを使用することを推奨します。<p class="paragraph"/><div class="hidden-block">Leveraging methods instead of Closure properties has some advantages:</div>
クロージャではなく、メソッドにすることによって以下の利点があります:
<div class="hidden-block">
<ul class="star">
<li>Memory efficient</li>
<li>Allow use of stateless controllers (<code>singleton</code> scope)</li>
<li>You can override actions from subclasses and call the overridden superclass method with <code>super.actionName()</code></li>
<li>Methods can be intercepted with standard proxying mechanisms, something that is complicated to do with Closures since they're fields.</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li>メモリ効率</li>
<li>ステートレスコントローラの使用 (<code>シングルトンスコープ</code>指定)</li>
<li>サブクラスでのアクションのオーバーライドが可能。スーパークラスのアクションメソッド呼び出しが可能。<code>super.actionName()</code></li>
<li>クロージャはフィールドのため複雑だった、スタンダードなプロキシを使用したメソッドのインターセプトが可能。</li>
</ul><p class="paragraph"/><div class="hidden-block">If you prefer the Closure syntax or have older controller classes created in earlier versions of Grails and still want the advantages of using methods, you can set the <code>grails.compile.artefacts.closures.convert</code> property to true in <code>BuildConfig.groovy</code>:</div>
クロージャを使用したい場合や、旧バージョンで作られたコントローラを使用しながら、メソッドの利点も欲しい場合は、<code>BuildConfig.groovy</code>に、 <code>grails.compile.artefacts.closures.convert</code>を定義します:
<div class="code"><pre>grails.compile.artefacts.closures.convert = <span class="java&#45;keyword">true</span></pre></div><p class="paragraph"/><div class="hidden-block">and a compile-time AST transformation will convert your Closures to methods in the generated bytecode.</div>
この定義をすることで、AST変換を使用してクロージャをメソッドに変換したバイトコードを生成します。<p class="paragraph"/><blockquote class="note">
If a controller class extends some other class which is not defined under the <code>grails-app/controllers/</code> directory, methods inherited from that class are not converted to controller actions.  If the intent is to expose those inherited methods as controller actions the methods may be overridden in the subclass and the subclass method may invoke the method in the super class.
</blockquote><p class="paragraph"/><h4>デフォルトアクション</h4><p class="paragraph"/><div class="hidden-block">A controller has the concept of a default URI that maps to the root URI of the controller, for example <code>/book</code> for <code>BookController</code>. The action that is called when the default URI is requested is dictated by the following rules:</div>
コントローラのルートURIににデフォルトURIをマップする概念をもっています。例として<code>BookController</code>の場合は <code>/book</code>になります。デフォルトURIが呼ばれたときに呼ばれるアクションは以下のルールになっています:
<div class="hidden-block">
<ul class="star">
<li>If there is only one action, it's the default</li>
<li>If you have an action named <code>index</code>, it's the default</li>
<li>Alternatively you can set it explicitly with the <code>defaultAction</code> property:</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li>アクションが１つの場合は、それがデフォルトになります。</li>
<li><code>index</code>という名称のアクションがある場合は、それがデフォルトになります。</li>
<li><code>defaultAction</code>を定義して指定できます。</li>
</ul><p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> defaultAction = <span class="java&#45;quote">"list"</span></pre></div>


<a name="7.1.2 Controllers and Scopes"><!-- Legacy link --></a>
<h2 id="controllersAndScopes">7.1.2 コントローラとスコープ</h2>
<h4>使用可能なスコープ</h4><p class="paragraph"/><div class="hidden-block">Scopes are hash-like objects where you can store variables. The following scopes are available to controllers:</div>
スコープは、変数を収納可能なハッシュのようなオブジェクトです。コントローラでは、次のスコープが使用可能です。
<div class="hidden-block">
<ul class="star">
<li><a href="../ref/Controllers/servletContext.html" class="controllers">servletContext</a> - Also known as application scope, this scope lets you share state across the entire web application. The servletContext is an instance of <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/ServletContext.html" class="api">ServletContext</a></li>
<li><a href="../ref/Controllers/session.html" class="controllers">session</a> - The session allows associating state with a given user and typically uses cookies to associate a session with a client. The session object is an instance of <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpSession.html" class="api">HttpSession</a></li>
<li><a href="../ref/Controllers/request.html" class="controllers">request</a> - The request object allows the storage of objects for the current request only. The request object is an instance of <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpServletRequest.html" class="api">HttpServletRequest</a></li>
<li><a href="../ref/Controllers/params.html" class="controllers">params</a> - Mutable map of incoming request query string or POST parameters</li>
<li><a href="../ref/Controllers/flash.html" class="controllers">flash</a> - See below</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li><a href="../ref/Controllers/servletContext.html" class="controllers">servletContext</a> - webアプリケーションの全体にわたってスコープを共有するアプリケーションスコープです。<a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/ServletContext.html" class="api">ServletContext</a>のインスタンスです。</li>
<li><a href="../ref/Controllers/session.html" class="controllers">session</a> - セッションは、通常クッキーを使用してリクエストを行ったクライアントとの連携をして、ステートを保持します。<a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpSession.html" class="api">HttpSession</a>のインスタンスです。</li>
<li><a href="../ref/Controllers/request.html" class="controllers">request</a> - リクエストオブジェクトはリクエスト時のみオブジェクトを保持するオブジェクトです。<a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpServletRequest.html" class="api">HttpServletRequest</a>のインスタンスです。</li>
<li><a href="../ref/Controllers/params.html" class="controllers">params</a> - 受け取ったリクエストクエリー文字列または、POSTパラメータを保持するミュータブルマップです。</li>
<li><a href="../ref/Controllers/flash.html" class="controllers">flash</a> - 以下を参照</li>
</ul><p class="paragraph"/><h4>スコープへのアクセス</h4><p class="paragraph"/><div class="hidden-block">Scopes can be accessed using the variable names above in combination with Groovy's array index operator, even on classes provided by the Servlet API such as the <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpServletRequest.html" class="api">HttpServletRequest</a>:</div>
以下のようにスコープはGroovyの配列インデクスオペレータで、変数の名称を指定して参照することができます。<a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpServletRequest.html" class="api">HttpServletRequest</a>にあるような、Servlet APIの提供する変数に関しても同じようにアクセスできます<p class="paragraph"/><div class="code"><pre>class BookController &#123;
    def find() &#123;
        def findBy = params&#91;<span class="java&#45;quote">"findBy"</span>&#93;
        def appContext = request&#91;<span class="java&#45;quote">"foo"</span>&#93;
        def loggedUser = session&#91;<span class="java&#45;quote">"logged_user"</span>&#93;
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">You can also access values within scopes using the de-reference operator, making the syntax even more clear:</div>
フィールド参照オペレータを使用してスコープの変数を参照すれば、シンタックスもっと簡潔にすることもできます:<p class="paragraph"/><div class="code"><pre>class BookController &#123;
    def find() &#123;
        def findBy = params.findBy
        def appContext = request.foo
        def loggedUser = session.logged_user
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">This is one of the ways that Grails unifies access to the different scopes.</div>
これはGrailsでの、様々なスコープにアクセスする一例です。<p class="paragraph"/><h4>フラッシュスコープを使用する</h4><p class="paragraph"/><div class="hidden-block">Grails supports the concept of <a href="../ref/Controllers/flash.html" class="controllers">flash</a> scope as a temporary store to make attributes available for this request and the next request only. Afterwards the attributes are cleared. This is useful for setting a message directly before redirecting, for example:</div>
Grailsは、今回のリクエストと次のリクエストのみで値を一時的に保持する <a href="../ref/Controllers/flash.html" class="controllers">flash</a>スコープをサポートしています。保持された内容は自動的に削除されます。リダイレクト等を行う前にメッセージを残す時などに使用できます。以下が例です。<p class="paragraph"/><div class="code"><pre>def delete() &#123;
    def b = Book.get(params.id)
    <span class="java&#45;keyword">if</span> (!b) &#123;
        flash.message = <span class="java&#45;quote">"User not found <span class="java&#45;keyword">for</span> id $&#123;params.id&#125;"</span>
        redirect(action:list)
    &#125;
    &#8230; // remaining code
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">When the <code>list</code> action is requested, the <code>message</code> value will be in scope and can be used to display an information message. It will be removed from the <code>flash</code> scope after this second request.</div>
この例では、<code>delete</code>アクションに対してリクエストをすると、リダイレクトされて<code>list</code>アクションが実行された際に、flashスコープの<code>message</code>に代入した内容がメッセージ表示等に使用可能になります。このリダイレクトされた<code>list</code>アクション(<code>delete</code>の次のアクション)の処理が終了したら、<code>flash</code>スコープの内容が削除されます。<p class="paragraph"/><div class="hidden-block">Note that the attribute name can be anything you want, and the values are often strings used to display messages, but can be any object type.</div>
メッセージ表示などで文字列型が頻繁に使用されますが、flashスコープに一時的に保持する値は、どのようなオブジェクトでもかまいません。<p class="paragraph"/><h4>コントローラのスコープ設定</h4><p class="paragraph"/><div class="hidden-block">By default, a new controller instance is created for each request. In fact, because the controller is <code>prototype</code> scoped, it is thread-safe since each request happens on its own thread.</div>
デフォルトでは、コントローラはリクエスト毎にインスタンスが生成されます。コントローラのスコープは<code>prototype</code>になっているため、リクエストがそれぞれのスレッドを持っているので、スレッドセーフになります。<p class="paragraph"/><div class="hidden-block">You can change this behaviour by placing a controller in a particular scope. The supported scopes are:</div>
コントローラにスコープを指定することで振る舞いを変更できます。サポートされているスコープは:
<div class="hidden-block">
<ul class="star">
<li><code>prototype</code> (default) - A new controller will be created for each request (recommended for actions as Closure properties)</li>
<li><code>session</code> - One controller is created for the scope of a user session</li>
<li><code>singleton</code> - Only one instance of the controller ever exists (recommended for actions as methods)</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li><code>prototype</code> (デフォルト) - リクエスト毎にコントローラが生成されます。(クロージャでアクションを推奨)</li>
<li><code>session</code> - ユーザのセッションを通して1個のコントローラが生成されます。</li>
<li><code>singleton</code> -  1個のコントローラのみが存在する状態です。(メソッドでのアクションをお勧めします)</li>
</ul><p class="paragraph"/><div class="hidden-block">To enable one of the scopes, add a static <code>scope</code> property to your class with one of the valid scope values listed above, for example</div>
スコープを定義するには、コントローラクラスに、static scope 変数で指定したいスコープを定義します。以下が例になります。<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> scope = <span class="java&#45;quote">"singleton"</span></pre></div><p class="paragraph"/><div class="hidden-block">You can define the default strategy under in <code>Config.groovy</code> with the <code>grails.controllers.defaultScope</code> key, for example:</div>
デフォルトスコープは、<code>Config.groovy</code>に<code>grails.controllers.defaultScope</code>を指定する事で変更できます。<p class="paragraph"/><div class="code"><pre>grails.controllers.defaultScope = <span class="java&#45;quote">"singleton"</span></pre></div>
<div class="hidden-block">
<blockquote class="note">
Use scoped controllers wisely. For instance, we don't recommend having any properties in a singleton-scoped controller since they will be shared for  <em class="italic">all</em>  requests. Setting a default scope other than <code>prototype</code> may also lead to unexpected behaviors if you have controllers provided by installed plugins that expect that the scope is <code>prototype</code>.
</blockquote>
</div>
<blockquote class="note">
コントローラのスコープは使用状況を考えてお使いください。例えば、シングルトンのコントローラは、_全ての_リクエストで共有されるためプロパティを持つべきではありません。デフォルトで定義されているスコープの<code>prototype</code> を変更することで、プラグインなどで提供されたコントローラが<code>protopype</code>を前提で実装されている場合があるので注意しましょう
</blockquote>


<a name="7.1.3 Models and Views"><!-- Legacy link --></a>
<h2 id="modelsAndViews">7.1.3 モデルとビュー</h2>
<h4>モデルを返す</h4><p class="paragraph"/><div class="hidden-block">A model is a Map that the view uses when rendering. The keys within that Map correspond to variable names accessible by the view. There are a couple of ways to return a model. First, you can explicitly return a Map instance:</div>
モデルはビューを描写する際に使用するMapインスタンスです。ビュー内でMapのキーに一致する変数名が使用できます。モデルを返すには、数種類の方法があります。先ずはじめにMapインスタンスを明示的に返す方法です。<p class="paragraph"/><div class="code"><pre>def show() &#123;
    &#91;book: Book.get(params.id)&#93;
&#125;</pre></div><p class="paragraph"/><blockquote class="note">
<div class="hidden-block">The above does  <em class="italic">not</em>  reflect what you should use with the scaffolding views - see the <a href="../guide/single.html#scaffolding" class="guide">scaffolding section</a> for more details.</div>
上記の例はスカッフォルドのビューで使用する例ではありません。スカッフォルドに関しては、スカッフォルドのセクションを参照してください。
</blockquote><p class="paragraph"/><div class="hidden-block">If no explicit model is returned the controller's properties will be used as the model, thus allowing you to write code like this:</div>
以下の例のように、明示的にモデルを返さない場合は、コントローラのプロパティがモデルとして使用されます。<p class="paragraph"/><div class="code"><pre>class BookController &#123;<p class="paragraph"/>    List books
    List authors<p class="paragraph"/>    def list() &#123;
        books = Book.list()
        authors = Author.list()
    &#125;
&#125;</pre></div><p class="paragraph"/><blockquote class="note">
<div class="hidden-block">This is possible due to the fact that controllers are prototype scoped. In other words a new controller is created for each request. Otherwise code such as the above would not be thread-safe, and all users would share the same data.</div>
これはコントローラのスコープがprototype(リクエスト毎にコントローラが生成される)の場合に可能な方法です。他の場合はスレッドセーフではありません。
</blockquote><p class="paragraph"/><div class="hidden-block">In the above example the <code>books</code> and <code>authors</code> properties will be available in the view.</div>
上記の例では、 プロパティの<code>book</code>と<code>authors</code>がビューで参照できます。<p class="paragraph"/><div class="hidden-block">A more advanced approach is to return an instance of the Spring <a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/servlet/ModelAndView.html" class="api">ModelAndView</a> class:</div>
上級者向けのアプローチとしては、Springの<a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/servlet/ModelAndView.html" class="api">ModelAndView</a>インスタンスを返す方法があります。<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> org.springframework.web.servlet.ModelAndView<p class="paragraph"/>def index() &#123;
    // get some books just <span class="java&#45;keyword">for</span> the index page, perhaps your favorites
    def favoriteBooks = ...<p class="paragraph"/>    // forward to the list view to show them
    <span class="java&#45;keyword">return</span> <span class="java&#45;keyword">new</span> ModelAndView(<span class="java&#45;quote">"/book/list"</span>, &#91; bookList : favoriteBooks &#93;)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">One thing to bear in mind is that certain variable names can not be used in your model:</div>
一つ覚えておいて欲しいのが、一定の変数名が、モデル使用できないという事です。
<ul class="star">
<li><code>attributes</code></li>
<li><code>application</code></li>
</ul><p class="paragraph"/><div class="hidden-block">Currently, no error will be reported if you do use them, but this will hopefully change in a future version of Grails.</div>
現状では使用したとしてもエラーが出ることはありませんが、将来的には変わるかもしれません。<p class="paragraph"/><h4>ビューの選択<div class="hidden-block">Selecting the View </div></h4><p class="paragraph"/><div class="hidden-block">In both of the previous two examples there was no code that specified which <a href="../guide/single.html#gsp" class="guide">view</a> to render. So how does Grails know which one to pick? The answer lies in the conventions. Grails will look for a view at the location <code>grails-app/views/book/show.gsp</code> for this <code>show</code> action:</div>
これまでの例ではビューがどのように設定されるのかを説明しませんでたが、Grailsではどのようにビューを選択しているのでしょうか？答えは慣習にあります。何も指定しなければ、以下のアクションでは、Grailsが自動的に、<code>grails-app/views/book/show.gsp</code>をビューとして使用します。<p class="paragraph"/><div class="code"><pre>class BookController &#123;
    def show() &#123;
         &#91;book: Book.get(params.id)&#93;
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">To render a different view, use the <a href="../ref/Controllers/render.html" class="controllers">render</a> method:</div>
別のビューを描写する場合は、<a href="../ref/Controllers/render.html" class="controllers">render</a>メソッドで指定します。<p class="paragraph"/><div class="code"><pre>def show() &#123;
    def map = &#91;book: Book.get(params.id)&#93;
    render(view: <span class="java&#45;quote">"display"</span>, model: map)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">In this case Grails will attempt to render a view at the location <code>grails-app/views/book/display.gsp</code>. Notice that Grails automatically qualifies the view location with the <code>book</code> directory of the <code>grails-app/views</code> directory. This is convenient, but to access shared views you need instead you can use an absolute path instead of a relative one:</div>
上記の例では、<code>grails-app/views/book/display.gsp</code>の描写を試みます。注目する場所はGrailsは自動的にコントローラが<code>book</code>であれば、<code>grails-app/views</code>ディレクトリの<code>book</code>ディレクトリを、指定しなくても取得する所です。これは便利なのですが、ビューを共有する場合は、パスを指定する必要があります。<p class="paragraph"/><div class="code"><pre>def show() &#123;
    def map = &#91;book: Book.get(params.id)&#93;
    render(view: <span class="java&#45;quote">"/shared/display"</span>, model: map)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">In this case Grails will attempt to render a view at the location <code>grails-app/views/shared/display.gsp</code>.</div>
上記の例では、<code>grails-app/views/shared/display.gsp</code>の描写を試みます。<p class="paragraph"/><div class="hidden-block">Grails also supports JSPs as views, so if a GSP isn't found in the expected location but a JSP is, it will be used instead.</div>
Grailsでは、ビューにJSPもサポートしています。これによって、参照したパスにGSPが存在しない場合は、JSPが代わりに使用されます。<p class="paragraph"/><h4>レスポンスの描写</h4><p class="paragraph"/><div class="hidden-block">Sometimes it's easier (for example with Ajax applications) to render snippets of text or code to the response directly from the controller. For this, the highly flexible <code>render</code> method can be used:</div>
直接文字列をコントローラからレスポンス(例としてAjaxアプリケーションなど)したい場合、とてもフレキシブルな<code>render</code>メソッドを使うと簡単にできます。<p class="paragraph"/><div class="code"><pre>render <span class="java&#45;quote">"Hello World!"</span></pre></div><p class="paragraph"/><div class="hidden-block">The above code writes the text "Hello World!" to the response. Other examples include:</div>
上記の例ではレスポンスに"Hello World!"を返します。他の例として:<p class="paragraph"/><div class="hidden-block">
// write some markup
// render a specific view
// render a template for each item in a collection
// render some text with encoding and content type
</div><p class="paragraph"/><div class="code"><pre>// マークアップを返す
render &#123;
   <span class="java&#45;keyword">for</span> (b in books) &#123;
      div(id: b.id, b.title)
   &#125;
&#125;</pre></div><p class="paragraph"/><div class="code"><pre>// 指定したビューを描写
render(view: 'show')</pre></div><p class="paragraph"/><div class="code"><pre>// コレクションの中身をそれぞれ指定したテンプレートを適応して描写
render(template: 'book_template', collection: Book.list())</pre></div><p class="paragraph"/><div class="code"><pre>// 文字列を指定したエンコーディングとコンテントタイプで描写
render(text: <span class="java&#45;quote">"&#60;xml&#62;some xml&#60;/xml&#62;"</span>, contentType: <span class="java&#45;quote">"text/xml"</span>, encoding: <span class="java&#45;quote">"UTF&#45;8"</span>)</pre></div><p class="paragraph"/><div class="hidden-block">If you plan on using Groovy's <code>MarkupBuilder</code> to generate HTML for use with the <code>render</code> method be careful of naming clashes between HTML elements and Grails tags, for example:</div>
<code>render</code>メソッドでGroovyの<code>MarkupBuilder</code>を使用してHTMLを生成する場合は、HTMLエレメント名とGrailsタグとの名称衝突を気をつけましょう。(Grailsのタグはアクション内部でメソッドとして使用できるため)<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> groovy.xml.MarkupBuilder
&#8230;
def login() &#123;
    def writer = <span class="java&#45;keyword">new</span> StringWriter()
    def builder = <span class="java&#45;keyword">new</span> MarkupBuilder(writer)
    builder.html &#123;
        head &#123;
            title 'Log in'
        &#125;
        body &#123;
            h1 'Hello'
            form &#123;
            &#125;
        &#125;
    &#125;<p class="paragraph"/>    def html = writer.toString()
    render html
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">This will actually <a href="../guide/single.html#tagsAsMethodCalls" class="guide">call the form tag</a> (which will return some text that will be ignored by the <code>MarkupBuilder</code>). To correctly output a <code>&#60;form&#62;</code> element, use the following:</div>
上記の例ではformの場所にform<a href="../guide/single.html#tagsAsMethodCalls" class="guide">タグが呼ばれて</a>しまいます。これを回避して<code>&#60;form&#62;</code>タグを正常に生成するには、以下のように<code>builder.form</code>とします。<p class="paragraph"/><div class="code"><pre>def login() &#123;
    // &#8230;
    body &#123;
        h1 'Hello'
        builder.form &#123;
        &#125;
    &#125;
    // &#8230;
&#125;</pre></div>


<a name="7.1.4 Redirects and Chaining"><!-- Legacy link --></a>
<h2 id="redirectsAndChaining">7.1.4 リダイレクトとチェイン</h2>
<h4>リダイレクト<div class="hidden-block">Redirects</div></h4><p class="paragraph"/><div class="hidden-block">Actions can be redirected using the <a href="../ref/Controllers/redirect.html" class="controllers">redirect</a> controller method:</div>
コントローラのメソッド、<a href="../ref/Controllers/redirect.html" class="controllers">redirect</a>を使用して、アクションをリダイレクトすることができます:<p class="paragraph"/><div class="code"><pre>class OverviewController &#123;<p class="paragraph"/>    def login() &#123;&#125;<p class="paragraph"/>    def find() &#123;
        <span class="java&#45;keyword">if</span> (!session.user)
            redirect(action: 'login')
            <span class="java&#45;keyword">return</span>
        &#125;
        &#8230;
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Internally the <a href="../ref/Controllers/redirect.html" class="controllers">redirect</a> method uses the <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpServletResponse.html" class="api">HttpServletResponse</a> object's <code>sendRedirect</code> method.</div>
<a href="../ref/Controllers/redirect.html" class="controllers">redirect</a>メソッドは内部的に<a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpServletResponse.html" class="api">HttpServletResponse</a>オブジェクトの<code>sendRedirect</code>メソッドを使用しています。<p class="paragraph"/><div class="hidden-block">The <code>redirect</code> method expects one of:</div>
<code>redirect</code>メソッドでは以下のいずれかのように使用します:<p class="paragraph"/><div class="hidden-block">* Another closure within the same controller class:</div>
*同じコントローラ内のアクションクロージャ(プロパティで)の指定:<p class="paragraph"/><div class="code"><pre>// Call the login action within the same class
redirect(action: login)</pre></div><p class="paragraph"/><div class="hidden-block">* The name of an action (and controller name if the redirect isn't to an action in the current controller):</div>
<ul class="star">
<li>アクション名称でのしていと、別のコントローラのアクションの場合はコントローラの指定:</li>
</ul><p class="paragraph"/><div class="code"><pre>// Also redirects to the index action in the home controller
redirect(controller: 'home', action: 'index')</pre></div><p class="paragraph"/><div class="hidden-block">*  A URI for a resource relative the application context path:</div>
<ul class="star">
<li>アプリケーションコンテキストパス内のリソースのURI:</li>
</ul><p class="paragraph"/><div class="code"><pre>// Redirect to an explicit URI
redirect(uri: <span class="java&#45;quote">"/login.html"</span>)</pre></div><p class="paragraph"/><div class="hidden-block">* Or a full URL:</div>
<ul class="star">
<li>URLを全指定:</li>
</ul><p class="paragraph"/><div class="code"><pre>// Redirect to a URL
redirect(url: <span class="java&#45;quote">"http://grails.org"</span>)</pre></div><p class="paragraph"/><div class="hidden-block">Parameters can optionally be passed from one action to the next using the <code>params</code> argument of the method:</div>
メソッドのparams引数をにパラメータを指定することで、アクションへのパラメータを渡せます:<p class="paragraph"/><div class="code"><pre>redirect(action: 'myaction', params: &#91;myparam: <span class="java&#45;quote">"myvalue"</span>&#93;)</pre></div><p class="paragraph"/><div class="hidden-block">These parameters are made available through the <a href="../ref/Controllers/params.html" class="controllers">params</a> dynamic property that accesses request parameters. If a parameter is specified with the same name as a request parameter, the request parameter is overridden and the controller parameter is used.</div>
これらのパラメータは、アクセス時のリクエストパラメータの<a href="../ref/Controllers/params.html" class="controllers">params</a>プロパティから参照できるようになります。もしリクエストと同じパラメータを指定した場合は、パラメータは上書きされます。<p class="paragraph"/><div class="hidden-block">Since the <code>params</code> object is a Map, you can use it to pass the current request parameters from one action to the next:</div>
<code>params</code>オブジェクトはMapなので、以下のように、そのまま全てのリクエストパラメータを次のアクションに渡すことができます:<p class="paragraph"/><div class="code"><pre>redirect(action: <span class="java&#45;quote">"next"</span>, params: params)</pre></div><p class="paragraph"/><div class="hidden-block">Finally, you can also include a fragment in the target URI:</div>
ターゲットURIに、フラグメントを含めることもできます:<p class="paragraph"/><div class="code"><pre>redirect(controller: <span class="java&#45;quote">"test"</span>, action: <span class="java&#45;quote">"show"</span>, fragment: <span class="java&#45;quote">"profile"</span>)</pre></div><p class="paragraph"/><div class="hidden-block">which will (depending on the URL mappings) redirect to something like "/myapp/test/show#profile".</div>
この例では(URLマッピング定義によりますが)、リダイレクトは"/myapp/test/show#profile"になります。<p class="paragraph"/><h4>チェイニング <div class="hidden-block">Chaining </div></h4><p class="paragraph"/><div class="hidden-block">Actions can also be chained. Chaining allows the model to be retained from one action to the next. For example calling the <code>first</code> action in this action:</div>
アクションのチェインが可能です。チェインではアクションからアクションへのモデル参照が可能です。以下の例でアクション<code>first</code>を呼び出します:<p class="paragraph"/><div class="code"><pre>class ExampleChainController &#123;<p class="paragraph"/>    def first() &#123;
        chain(action: second, model: &#91;one: 1&#93;)
    &#125;<p class="paragraph"/>    def second () &#123;
        chain(action: third, model: &#91;two: 2&#93;)
    &#125;<p class="paragraph"/>    def third() &#123;
        &#91;three: 3&#93;)
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">results in the model:</div>
結果モデルは以下のようになります:<p class="paragraph"/><div class="code"><pre>&#91;one: 1, two: 2, three: 3&#93;</pre></div><p class="paragraph"/><div class="hidden-block">The model can be accessed in subsequent controller actions in the chain using the <code>chainModel</code> map. This dynamic property only exists in actions following the call to the <code>chain</code> method:</div>
途中でコントローラアクションからモデルにアクセスするには、chainModelマップを使用します。この動的プロパティはchainメソッドから呼ばれた時のみに存在します。<p class="paragraph"/><div class="code"><pre>class ChainController &#123;<p class="paragraph"/>    def nextInChain() &#123;
        def model = chainModel.myModel
        &#8230;
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Like the <code>redirect</code> method you can also pass parameters to the <code>chain</code> method:</div>
<code>redirect</code>メソッドと同じように、<code>chain</code>メソッドにパラメータを渡すこともできます:<p class="paragraph"/><div class="code"><pre>chain(action: <span class="java&#45;quote">"action1"</span>, model: &#91;one: 1&#93;, params: &#91;myparam: <span class="java&#45;quote">"param1"</span>&#93;)</pre></div>


<a name="7.1.5 Controller Interceptors"><!-- Legacy link --></a>
<h2 id="interceptors">7.1.5 コントローラ・インターセプター</h2>
<div class="hidden-block">Often it is useful to intercept processing based on either request, session or application state. This can be achieved with action interceptors. There are currently two types of interceptors: before and after.</div>
リクエスト、セッションまたはアプリケーションで処理のインターセプトができると、たいへん役に立ちます。これはアクションインターセプターで達成できます。現在2種類のインターセプターbeforeとafterがあります。<p class="paragraph"/><blockquote class="note">
<div class="hidden-block">If your interceptor is likely to apply to more than one controller, you are almost certainly better off writing a <a href="../guide/single.html#filters" class="guide">Filter</a>. Filters can be applied to multiple controllers or URIs without the need to change the logic of each controller </div>
複数のコントローラにインターセプターを反映させたい場合は、<a href="../guide/single.html#filters" class="guide">Filter</a>を使用することをお勧めします。Filterは多数のコントローラまたはURIに、ロジックを追加すること無く反映できます。
</blockquote><p class="paragraph"/><h4>ビフォア・インターセプション<div class="hidden-block">Before Interception </div></h4><p class="paragraph"/><div class="hidden-block">The <code>beforeInterceptor</code> intercepts processing before the action is executed. If it returns <code>false</code> then the intercepted action will not be executed. The interceptor can be defined for all actions in a controller as follows:</div>
<code>beforeInterceptor</code>は、アクションが実行される前に処理の追加を行うことができます。<code>beforeInterceptor</code>で、<code>false</code>を返すとアクションは実行されません。コントローラ内の全てのアクションにインターセプターを定義するには以下のようにします。<p class="paragraph"/><div class="code"><pre>def beforeInterceptor = &#123;
    println <span class="java&#45;quote">"Tracing action $&#123;actionUri&#125;"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">The above is declared inside the body of the controller definition.  It will be executed before all actions and does not interfere with processing. A common use case is very simplistic authentication:</div>
上記はコントローラ内部に設定します。全てのアクションの前に実行され処理を干渉することはありません。
他によくある実装例としては簡単な認証などです:<p class="paragraph"/>
<div class="code"><pre>def beforeInterceptor = &#91;action: <span class="java&#45;keyword">this</span>.&#38;auth, except: 'login'&#93;<p class="paragraph"/>// defined with <span class="java&#45;keyword">private</span> scope, so it's not considered an action
<span class="java&#45;keyword">private</span> auth() &#123;
    <span class="java&#45;keyword">if</span> (!session.user) &#123;
        redirect(action: 'login')
        <span class="java&#45;keyword">return</span> <span class="java&#45;keyword">false</span>
    &#125;
&#125;<p class="paragraph"/>def login() &#123;
    // display login page
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">The above code defines a method called <code>auth</code>. A private method is used so that it is not exposed as an action to the outside world. The <code>beforeInterceptor</code> then defines an interceptor that is used on all actions  <em class="italic">except</em>  the login action and it executes the <code>auth</code> method. The <code>auth</code> method is referenced using Groovy's method pointer syntax. Within the method it detects whether there is a user in the session, and if not it redirects to the <code>login</code> action and returns <code>false</code>, causing the intercepted action to not be processed.</div>
上記の例では先ず、<code>auth</code>メソッドを定義します。外部にアクションとして認識されないように<code>private</code>メソッドにします。
今回は、アクション名が<code>login</code>以外の全てのアクションで実行されるように、実行するメソッドをaction:に指定し、除外するアクション'login'を except:に指定して、<code>beforeInterceptor</code>を定義します。<code>auth</code>メソッドはGroovyのメソッドポインターシンタックスで指定します。これで、<code>auth</code>の処理によって、sessionにuser変数が見つからなかった場合は'login'アクションへリダイレクトして<code>false</code>を返しアクションを実行しないインターセプターが行えます。<p class="paragraph"/>
<h4>アフター・インターセプション <div class="hidden-block">After Interception </div></h4><p class="paragraph"/><div class="hidden-block">Use the <code>afterInterceptor</code> property to define an interceptor that is executed after an action:</div>
<code>afterInterceptor</code>は、アクションが実行される後に処理の追加を行うことができます:<p class="paragraph"/><div class="code"><pre>def afterInterceptor = &#123; model &#45;&#62;
    println <span class="java&#45;quote">"Tracing action $&#123;actionUri&#125;"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">The after interceptor takes the resulting model as an argument and can hence manipulate the model or response.</div>
アフター・インターセプターでは、処理結果のモデルを引数として取得して、モデルやレスポンスを操作することができます。<p class="paragraph"/><div class="hidden-block">An after interceptor may also modify the Spring MVC <a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/servlet/ModelAndView.html" class="api">ModelAndView</a> object prior to rendering. In this case, the above example becomes:</div>
描写直前のSpring MVCの<a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/servlet/ModelAndView.html" class="api">ModelAndView</a>も取得して変更することも可能です。以下のケースでは、前の例に追記すると:<p class="paragraph"/><div class="code"><pre>def afterInterceptor = &#123; model, modelAndView &#45;&#62;
    println <span class="java&#45;quote">"Current view is $&#123;modelAndView.viewName&#125;"</span>
    <span class="java&#45;keyword">if</span> (model.someVar) modelAndView.viewName = <span class="java&#45;quote">"/mycontroller/someotherview"</span>
    println <span class="java&#45;quote">"View is now $&#123;modelAndView.viewName&#125;"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">This allows the view to be changed based on the model returned by the current action. Note that the <code>modelAndView</code> may be <code>null</code> if the action being intercepted called <code>redirect</code> or <code>render</code>.</div>
この例では返されたモデルの内容を元にビューを変更しています。インターセプトされた、アクションが<code>redirect</code>や<code>render</code>を呼び出している場合は、<code>modelANdView</code>は<code>null</code>になります。<p class="paragraph"/><h4>インターセプションの条件指定 <div class="hidden-block">Interception Conditions </div></h4><p class="paragraph"/><div class="hidden-block">Rails users will be familiar with the authentication example and how the 'except' condition was used when executing the interceptor (interceptors are called 'filters' in Rails; this terminology conflicts with Servlet filter terminology in Java):</div>
'excepr'条件は、Railsユーザにとってインターセプターを使う時はお馴染みだと思います。(Railsではインターセプターはフィルターと呼ばれています。Javaでは用語的にサーブレットフィルターと衝突するのでインターセプターとしています)<p class="paragraph"/><div class="code"><pre>def beforeInterceptor = &#91;action: <span class="java&#45;keyword">this</span>.&#38;auth, except: 'login'&#93;</pre></div><p class="paragraph"/><div class="hidden-block">This executes the interceptor for all actions except the specified action. A list of actions can also be defined as follows:</div>
上記の例では、exceptで指定したアクション以外でインターセプターを実行します。次のように、複数指定する場合はリストで指定します:<p class="paragraph"/><div class="code"><pre>def beforeInterceptor = &#91;action: <span class="java&#45;keyword">this</span>.&#38;auth, except: &#91;'login', 'register'&#93;&#93;</pre></div><p class="paragraph"/><div class="hidden-block">The other supported condition is 'only', this executes the interceptor for only the specified action(s):</div>
指定したアクションのみでインターセプターを実行する場合は、'only'を使用します:<p class="paragraph"/><div class="code"><pre>def beforeInterceptor = &#91;action: <span class="java&#45;keyword">this</span>.&#38;auth, only: &#91;'secure'&#93;&#93;</pre></div>


<a name="7.1.6 Data Binding"><!-- Legacy link --></a>
<h2 id="dataBinding">7.1.6 データバインディング</h2>
<div class="hidden-block">Data binding is the act of "binding" incoming request parameters onto the properties of an object or an entire graph of objects. Data binding should deal with all necessary type conversion since request parameters, which are typically delivered by a form submission, are always strings whilst the properties of a Groovy or Java object may well not be.</div>
データバインディングとは、受信したリクエストパラメータを、オブジェクトのプロパティやオブジェクト構造へ結合させる機能です。データバインディングでは、フォームから送信された文字列のリクエストパラメータを必要な型へに変換します。<p class="paragraph"/><div class="hidden-block">h4. Map Based Binding</div>
<h4>マップを用いたバインディング</h4><p class="paragraph"/><div class="hidden-block">The data binder is capable of converting and assigning values in a Map to properties of an object.  The binder will associate entries in the Map to properties of the object using the keys in the Map that have values which correspond to property names on the object.  The following code demonstrates the basics:</div>
データバインダは、マップの値を変換してオブジェクトのプロパティに代入します。
バインダは、オブジェクトのプロパティ名に一致するマップのキーを使って、マップのエントリをオブジェクトのプロパティに結びつけます。
以下のコードはその基本形を示します:<p class="paragraph"/><div class="code"><pre>// grails&#45;app/domain/Person.groovy
class Person &#123;
    <span class="java&#45;object">String</span> firstName
    <span class="java&#45;object">String</span> lastName
    <span class="java&#45;object">Integer</span> age
&#125;</pre></div><p class="paragraph"/><div class="code"><pre>def bindingMap = &#91;firstName: 'Peter', lastName: 'Gabriel', age: 63&#93;<p class="paragraph"/>def person = <span class="java&#45;keyword">new</span> Person(bindingMap)<p class="paragraph"/>assert person.firstName == 'Peter'
assert person.lastNaem == 'Gabriel'
assert person.age == 63</pre></div><p class="paragraph"/><div class="hidden-block">To update properties of a domain object you may assign a Map to the <code>properties</code> property of the domain class:</div>
ドメインオブジェクトのプロパティを更新するために、そのドメインクラスの<code>properties</code>プロパティにマップを代入できます。<p class="paragraph"/><div class="code"><pre>def bindingMap = &#91;firstName: 'Peter', lastName: 'Gabriel', age: 63&#93;<p class="paragraph"/>def person = Person.get(someId)
person.properties = bindingMap<p class="paragraph"/>assert person.firstName == 'Peter'
assert person.lastNaem == 'Gabriel'
assert person.age == 63</pre></div><p class="paragraph"/><div class="hidden-block">The binder can populate a full graph of objects using Maps of Maps.</div>
バインダはオブジェクトの完全なデータ構造をマップのマップを使って表現できます。<p class="paragraph"/><div class="code"><pre>class Person &#123;
    <span class="java&#45;object">String</span> firstName
    <span class="java&#45;object">String</span> lastName
    <span class="java&#45;object">Integer</span> age
    Address homeAddress
&#125;<p class="paragraph"/>class Address &#123;
    <span class="java&#45;object">String</span> county
    <span class="java&#45;object">String</span> country
&#125;</pre></div><p class="paragraph"/><div class="code"><pre>def bindingMap = &#91;firstName: 'Peter', lastName: 'Gabriel', age: 63, homeAddress: &#91;county: 'Surrey', country: 'England'&#93; &#93;<p class="paragraph"/>def person = <span class="java&#45;keyword">new</span> Person(bindingMap)<p class="paragraph"/>assert person.firstName == 'Peter'
assert person.lastNaem == 'Gabriel'
assert person.age == 63
assert person.homeAddress.county == 'Surrey'
assert person.homeAddress.country == 'England'</pre></div><p class="paragraph"/><div class="hidden-block">h4. Binding To Collections And Maps</div>
<h4>コレクションとマップへのバインディング</h4><p class="paragraph"/><div class="hidden-block">The data binder can populate and update Collections and Maps.  The following code shows a simple example of populating a <code>List</code> of objects in a domain class:</div>
データバインダは、コレクションとマップへの格納と更新ができます。
以下のコードはドメインクラス上の<code>List</code>への格納の単純な例を示します。<p class="paragraph"/><div class="code"><pre>class Band &#123;
    <span class="java&#45;object">String</span> name
    <span class="java&#45;keyword">static</span> hasMany = &#91;albums: Album&#93;
    List albums
&#125;<p class="paragraph"/>class Album &#123;
    <span class="java&#45;object">String</span> title
    <span class="java&#45;object">Integer</span> numberOfTracks
&#125;</pre></div><p class="paragraph"/><div class="code"><pre>def bindingMap = &#91;name: 'Genesis',
                  'albums&#91;0&#93;': &#91;title: 'Foxtrot', numberOfTracks: 6&#93;,
                  'albums&#91;1&#93;': &#91;title: 'Nursery Cryme', numberOfTracks: 7&#93;&#93;<p class="paragraph"/>def band = <span class="java&#45;keyword">new</span> Band(bindingMap)<p class="paragraph"/>assert band.name == 'Genesis'
assert band.albums.size() == 2
assert band.albums&#91;0&#93;.title == 'Foxtrot'
assert band.albums&#91;0&#93;.numberOfTracks == 6
assert band.albums&#91;1&#93;.title == 'Nursery Cryme'
assert band.albums&#91;1&#93;.numberOfTracks == 7</pre></div><p class="paragraph"/><div class="hidden-block">That code would work in the same way if <code>albums</code> were an array instead of a <code>List</code>.</div>
このコードは<code>albums</code>が<code>List</code>の代わりに配列だったとしても同様に動作します。<p class="paragraph"/><div class="hidden-block">Note that when binding to a <code>Set</code> the structure of the <code>Map</code> being bound to the <code>Set</code> is the same as that of a <code>Map</code> being bound to a <code>List</code> but since a <code>Set</code> is unordered, the indexes don't necessarily correspond to the order of elements in the <code>Set</code>.  In the code example above, if <code>albums</code> were a <code>Set</code> instead of a <code>List</code>, the <code>bindingMap</code> could look exactly the same but 'Foxtrot' might be the first album in the <code>Set</code> or it might be the second.  When updating existing elements in a <code>Set</code> the <code>Map</code> being assigned to the <code>Set</code> must have <code>id</code> elements in it which represent the element in the <code>Set</code> being updated, as in the following example:</div>
<code>Set</code>へとバインディングするとき、<code>Set</code>にバインドされた<code>Map</code>の構造は<code>List</code>にバインドされた<code>Map</code>と同じですが、<code>Set</code>は順序を保持しないため、添字は必ずしも<code>Set</code>内の要素の順序と一致しないことに注意してください。
上記のサンプルコードで<code>albums</code>が<code>List</code>の代わりに<code>Set</code>だったとしたら、<code>bindingMap</code>は一見まったく同じに見えるかもしれませんが、「Foxtrot」は<code>Set</code>内の最初のアルバムかもしれませんし、2番目であるかもしれません。
以下の例のように、<code>Set</code>内の既存の要素を更新するとき、<code>Set</code>に代入する<code>Map</code>は更新されようとしている<code>Set</code>内の要素を表す<code>id</code>要素を持っていなければなりません:<p class="paragraph"/><div class="code"><pre>/&#42;
 &#42; The value of the indexes 0 and 1 in albums&#91;0&#93; and albums&#91;1&#93; are arbitrary
 &#42; values that can be anything as <span class="java&#45;object">long</span> as they are unique within the Map.
 &#42; They <span class="java&#45;keyword">do</span> not correspond to the order of elements in albums because albums
 &#42; is a Set.
 &#42;/
def bindingMap = &#91;'albums&#91;0&#93;': &#91;id: 9, title: 'The Lamb Lies Down On Broadway'&#93;
                  'albums&#91;1&#93;': &#91;id: 4, title: 'Selling England By The Pound'&#93;&#93;<p class="paragraph"/>def band = Band.get(someBandId)<p class="paragraph"/>/&#42;
 &#42; This will find the Album in albums that has an id of 9 and will set its title
 &#42; to 'The Lamb Lies Down On Broadway' and will find the Album in albums that has
 &#42; an id of 4 and set its title to 'Selling England By The Pound'.  In both
 &#42; cases <span class="java&#45;keyword">if</span> the Album cannot be found in albums then the album will be retrieved
 &#42; from the database by id, the Album will be added to albums and will be updated
 &#42; with the values described above.  If a Album with the specified id cannot be
 &#42; found in the database, then a binding error will be created and associated
 &#42; with the band object.  More on binding errors later.
 &#42;/
band.properties = bindingMap</pre></div><p class="paragraph"/><div class="hidden-block">When binding to a <code>Map</code> the structure of the binding <code>Map</code> is the same as the structore of a <code>Map</code> used for binding to a <code>List</code> or a <code>Set</code> and the index inside of square brackets corresponds to the key in the <code>Map</code> being bound to.  See the following code:</div>
<code>Map</code>へとバインディングするとき、バインド元の<code>Map</code>の構造は<code>List</code>や<code>Set</code>へのバインディングに使われる<code>Map</code>と同じです。
角括弧内の添字はバインド先の<code>Map</code>内のキーとなります。
以下のコードを見てください:<p class="paragraph"/><div class="code"><pre>class Album &#123;
    <span class="java&#45;object">String</span> title
    <span class="java&#45;keyword">static</span> hasMany = &#91;players: Player&#93;
    Map players
&#125;<p class="paragraph"/>class Player &#123;
    <span class="java&#45;object">String</span> name
&#125;</pre></div><p class="paragraph"/><div class="code"><pre>def bindingMap = &#91;title: 'The Lamb Lies Down On Broadway',
                  'players&#91;guitar&#93;': &#91;name: 'Steve Hacket'&#93;,
                  'players&#91;vocals&#93;': &#91;name: 'Peter Gabriel'&#93;
                  'players&#91;keyboards&#93;': &#91;name: 'Tony Banks'&#93;&#93;<p class="paragraph"/>def album = <span class="java&#45;keyword">new</span> Album(bindingMap)<p class="paragraph"/>assert album.title == 'The Lamb Lies Down On Broadway'
assert album.players.size() == 3
assert album.players.guitar == 'Steve Hacket'
assert album.players.vocals == 'Peter Gabriel'
assert album.players.keyboards == 'Tony Banks'</pre></div><p class="paragraph"/><div class="hidden-block">When updating an exisiting <code>Map</code>, if the key specified in the binding <code>Map</code> does not exist in the <code>Map</code> being bound to then a new value will be created and added to the <code>Map</code> with the specified key as in the following example:</div>
以下の例のように、既存の<code>Map</code>を更新するときに、バインド元の<code>Map</code>内で指定されたキーがバインド先の<code>Map</code>内に存在しない場合、新しい値が生成されて指定されたキーでバインド先の<code>Map</code>に追加されます:<p class="paragraph"/><div class="code"><pre>def bindingMap = &#91;title: 'The Lamb Lies Down On Broadway',
                  'players&#91;guitar&#93;': &#91;name: 'Steve Hacket'&#93;,
                  'players&#91;vocals&#93;': &#91;name: 'Peter Gabriel'&#93;
                  'players&#91;keyboards&#93;': &#91;name: 'Tony Banks'&#93;&#93;<p class="paragraph"/>def album = <span class="java&#45;keyword">new</span> Album(bindingMap)<p class="paragraph"/>assert album.title == 'The Lamb Lies Down On Broadway'
assert album.players.size() == 3
assert album.players.guitar == 'Steve Hacket'
assert album.players.vocals == 'Peter Gabriel'
assert album.players.keyboards == 'Tony Banks'<p class="paragraph"/>def updatedBindingMap = &#91;'players&#91;drums&#93;': &#91;name: 'Phil Collins'&#93;,
                         'players&#91;keyboards&#93;': &#91;name: 'Anthony George Banks'&#93;&#93;<p class="paragraph"/>album.properties = updatedBindingMap<p class="paragraph"/>assert album.title == 'The Lamb Lies Down On Broadway'
assert album.players.size() == 4
assert album.players.guitar == 'Steve Hacket'
assert album.players.vocals == 'Peter Gabriel'
assert album.players.keyboards == 'Anthony George Banks'
assert album.players.drums == 'Phil Collins'</pre></div><p class="paragraph"/><div class="hidden-block">h4. Binding Request Data to the Model</div>
<h4>モデルにリクエストデータをバインドする</h4><p class="paragraph"/><div class="hidden-block">The <a href="../ref/Controllers/params.html" class="controllers">params</a> object that is available in a controller has special behavior that helps convert dotted request parameter names into nested Maps that the data binder can work with.  For example, if a request includes request parameters named <code>person.homeAddress.country</code> and <code>person.homeAddress.city</code> with values 'USA' and 'St. Louis' respectively, <code>params</code> would include entries like these:</div>
コントローラで利用できる<a href="../ref/Controllers/params.html" class="controllers">params</a>オブジェクトには、ドット区切りのリクエストパラメータ名をネストされたMapに変換する
という特別なサポートがあります。
たとえば、値がそれぞれ「USA」と「St. Louis」であるような<code>person.homeAddress.country</code>と<code>person.homeAddress.city</code>という名前のリクエストパラメータを持っているリクエストの場合、<code>params</code>のエントリは以下のようになります:<p class="paragraph"/><div class="code"><pre>&#91;person: &#91;homeAddress: &#91;country: 'USA', city: 'St. Louis'&#93;&#93;&#93;</pre></div><p class="paragraph"/><div class="hidden-block">There are two ways to bind request parameters onto the properties of a domain class. The first involves using a domain classes' Map constructor:</div>
リクエストパラメータをドメインクラスのプロパティへバインドするには、2通りの方法があります。1つめはドメインクラスのマップを指定するコンストラクタを使用します。<p class="paragraph"/><div class="code"><pre>def save() &#123;
    def b = <span class="java&#45;keyword">new</span> Book(params)
    b.save()
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">The data binding happens within the code <code>new Book(params)</code>. By passing the <a href="../ref/Controllers/params.html" class="controllers">params</a> object to the domain class constructor Grails automatically recognizes that you are trying to bind from request parameters. So if we had an incoming request like:</div>
この例では、<code>new Book(params)</code>の部分でデータバインディングが実行されます。<a href="../ref/Controllers/params.html" class="controllers">params</a>オブジェクトをドメインクラスのコンストラクタに渡すことで、Grailsが自動にリクエストパラメータを認識してバインドします。例えば、以下のようなリクエストを受信したとします。<p class="paragraph"/><div class="code"><pre>/book/save?title=The%20Stand&#38;author=Stephen%20King</pre></div><p class="paragraph"/><div class="hidden-block">Then the <code>title</code> and <code>author</code> request parameters would automatically be set on the domain class. You can use the <a href="../ref/Domain Classes/properties.html" class="domainClasses">properties</a> property to perform data binding onto an existing instance:</div>
リクエストパラメータの<code>title</code>と<code>author</code>が、自動的にドメインクラスへセットされます。もう1つの方法として、既存のドメインクラスインスタンスへデータバインディングするために、<a href="../ref/Domain Classes/properties.html" class="domainClasses">properties</a>プロパティを利用することができます。<p class="paragraph"/><div class="code"><pre>def save() &#123;
    def b = Book.get(params.id)
    b.properties = params
    b.save()
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">This has the same effect as using the implicit constructor.</div>
これは先ほどのコンストラクタを利用したのと同じ結果になります。<p class="paragraph"/><div class="hidden-block">When binding an empty String (a String with no characters in it, not even spaces) to a constrained property which has been configured as nullable, the data binder will convert the empty String to null.  This simplifies the most common case where the intent is to treat an empty form field as having the value null since there isn't a way to actually submit a null as a request parameter.  When this behavior is not desireable the application may assign the value directly.</div>
空文字(スペースすら含まない文字数0のString)をnullable制約を付与されたプロパティにバインディングするとき、データバインダはその空文字をnullに変換します。
これによって、リクエストパラメータとしてnullをサブミットする方法が実際には存在しないため空文字として送信せざるを得ないが、フォームの空フィールドについて値がnullであるとみなしたい、というよくあるケースを簡単に扱えるようになります。
この振る舞いが望ましくないときは、アプリケーションは値を直接代入することもできます。<p class="paragraph"/><div class="hidden-block">The mass property binding mechanism will by default automatically trim all Strings at binding time.  To disable this behavior set the <code>grails.databinding.trimStrings</code> property to false in <code>grails-app/conf/Config.groovy</code>.</div>
大量プロパティバインディング機構は、デフォルトでバインディング時にすべての文字列を自動的にトリムします。
この挙動を無効化するには、<code>grails-app/conf/Config.groovy</code>の<code>grails.databinding.trimStrings</code> プロパティにfalseをセットしてください。<p class="paragraph"/><div class="code"><pre>// the <span class="java&#45;keyword">default</span> value is <span class="java&#45;keyword">true</span>
grails.databinding.trimStrings = <span class="java&#45;keyword">false</span><p class="paragraph"/>// ...</pre></div><p class="paragraph"/><div class="hidden-block">The mass property binding mechanism will by default automatically convert all empty Strings to null at binding time.  To disable this behavior set the <code>grails.databinding.convertEmptyStringsToNull</code> property to false in <code>grials-app/conf/Config.groovy</code>.</div>
大量プロパティバインディング機構は、デフォルトでバインディング時にすべての空文字を自動的にnullに変換します。
この挙動を無効化するには、<code>grails-app/conf/Config.groovy</code>の<code>grails.databinding.convertEmptyStringsToNull</code> プロパティにfalseをセットしてください。<p class="paragraph"/><div class="code"><pre>// the <span class="java&#45;keyword">default</span> value is <span class="java&#45;keyword">true</span>
grails.databinding.convertEmptyStringsToNull = <span class="java&#45;keyword">false</span><p class="paragraph"/>// ...</pre></div><p class="paragraph"/><div class="hidden-block">The order of events is that the String trimming happens and then null conversion happens so if <code>trimStrings</code> is <code>true</code> and <code>convertEmptyStringsToNull</code> is <code>true</code>, not only will empty Strings be converted to null but also blank Strings.  A blank String is any String such that the <code>trim()</code> method returns an empty String.</div>
<code>trimStrings</code>が<code>true</code>で<code>convertEmptyStringsToNull</code>が<code>true</code>のとき、イベントの順番としては、文字列がトリムされた後にnull変換が実行されます。つまり、空文字がnullに変換されるだけでなく、空白文字列もnullに変換されることになります。
ここで、空白文字列とは<code>trim()</code>メソッドが空文字を返す文字列のことです。<p class="paragraph"/><blockquote class="warning">
<div class="hidden-block">These forms of data binding in Grails are very convenient, but also indiscriminate. In other words, they will bind  <em class="italic">all</em>  non-transient, typed instance properties of the target object, including ones that you may not want bound. Just because the form in your UI doesn't submit all the properties, an attacker can still send malign data via a raw HTTP request. Fortunately, Grails also makes it easy to protect against such attacks - see the section titled "Data Binding and Security concerns" for more information.</div>
Grailsでのこのようなデータバインディングは大変便利ですが、同時に無差別的でもあります。
言い換えると、バインドしたくないものまで含めて、対象オブジェクトの「すべて」の非transientな型付けされたインスタンスプロパティをバインドしてしまいます。
単にUI上のフォームがすべてのプロパティをサブミットするわけではないだけであって、今もなお攻撃者は生のHTTPリクエストを使って悪意あるデータを送信することができます。
幸い、Grailsではそのような攻撃に対して防御するのも簡単です。
詳しくは、「データバインディングとセキュリティ考慮」のセクションを参照してください。
</blockquote><p class="paragraph"/><div class="hidden-block">h4. Data binding and Single-ended Associations </div>
<h4>単一終端関連のデータバインディング</h4><p class="paragraph"/><div class="hidden-block">If you have a <code>one-to-one</code> or <code>many-to-one</code> association you can use Grails' data binding capability to update these relationships too. For example if you have an incoming request such as:</div>
1対1や多対1関連の場合も、Grailsデータバインディングの機能で更新可能です。例として次のようなリクエストを受信したとします:<p class="paragraph"/><div class="code"><pre>/book/save?author.id=20</pre></div><p class="paragraph"/><div class="hidden-block">Grails will automatically detect the <code>.id</code> suffix on the request parameter and look up the <code>Author</code> instance for the given id when doing data binding such as:</div>
同じ方法で、Grailsがリクエストパラメータの<code>.id</code>接尾辞を自動認識して、与えられたidで該当する<code>Author</code>インスタンスを検索してデータバインディングを行います<p class="paragraph"/><div class="code"><pre>def b = <span class="java&#45;keyword">new</span> Book(params)</pre></div><p class="paragraph"/><div class="hidden-block">An association property can be set to <code>null</code> by passing the literal <code>String</code> "null". For example:</div>
次のように、関連のプロパティに文字列で"null"と指定することで<code>null</code>をセットすることができます<p class="paragraph"/><div class="code"><pre>/book/save?author.id=<span class="java&#45;keyword">null</span></pre></div><p class="paragraph"/><div class="hidden-block">h4. Data Binding and Many-ended Associations </div>
<h4>複数終端関連のデータバインディング</h4><p class="paragraph"/><div class="hidden-block">If you have a one-to-many or many-to-many association there are different techniques for data binding depending of the association type.</div>
1対多や多対多関連の場合、それぞれの関連タイプによって違ったデータバインディング方法があります。<p class="paragraph"/><div class="hidden-block">If you have a <code>Set</code> based association (the default for a <code>hasMany</code>) then the simplest way to populate an association is to send a list of identifiers. For example consider the usage of <code>&#60;g:select&#62;</code> below:</div>
<code>Set</code>ベースの関連(<code>hasMany</code>でのデフォルト)で、簡単に関連を設定するには、idのリストを送る方法が有ります。以下の例は<code>&#60;g:select&#62;</code>を使用した方法です:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:select name=<span class="xml&#45;quote">"books"</span>
          from=<span class="xml&#45;quote">"$&#123;Book.list()&#125;"</span>
          size=<span class="xml&#45;quote">"5"</span> multiple=<span class="xml&#45;quote">"yes"</span> optionKey=<span class="xml&#45;quote">"id"</span>
          value=<span class="xml&#45;quote">"$&#123;author?.books&#125;"</span> /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">This produces a select box that lets you select multiple values. In this case if you submit the form Grails will automatically use the identifiers from the select box to populate the <code>books</code> association.</div>
このタグでは複数選択のセレクトボックスが生成されます。この例でフォームを送信すると、Grailsが自動的にセレクトボックスで選択されたidを使用して、<code>books</code>の関連を設定します。<p class="paragraph"/><div class="hidden-block">However, if you have a scenario where you want to update the properties of the associated objects the this technique won't work. Instead you use the subscript operator:</div>
ただしこの方法は、関連オブジェクトのプロパティを更新する場合は使用できません。代わりに添字演算子を使用します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:textField name=<span class="xml&#45;quote">"books&#91;0&#93;.title"</span> value=<span class="xml&#45;quote">"the Stand"</span> /&#62;</span>
<span class="xml&#45;tag">&#60;g:textField name=<span class="xml&#45;quote">"books&#91;1&#93;.title"</span> value=<span class="xml&#45;quote">"the Shining"</span> /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">However, with <code>Set</code> based association it is critical that you render the mark-up in the same order that you plan to do the update in. This is because a <code>Set</code> has no concept of order, so although we're referring to <code>books0</code> and <code>books1</code> it is not guaranteed that the order of the association will be correct on the server side unless you apply some explicit sorting yourself.</div>
ただし、<code>Set</code>ベースの関連では、マークアップ(HTML)が描写された順序とは同じ順序で更新されない危険性あります。 これは<code>Set</code>には順序という概念がなく、<code>books&#91;0&#93;</code>や<code>books&#91;1&#93;</code>と指定したとしても、サーバサイドでの関連のソートを明快に指定しない限り、順序が保証されないことになるからです。<p class="paragraph"/><div class="hidden-block">This is not a problem if you use <code>List</code> based associations, since a <code>List</code> has a defined order and an index you can refer to. This is also true of <code>Map</code> based associations.</div>
<code>List</code>ベースの関連の場合は、<code>List</code>の順序とインデックスを指定することができるので問題ありません。<code>Map</code>ベースの関連も同じことがいえます。<p class="paragraph"/><div class="hidden-block">Note also that if the association you are binding to has a size of two and you refer to an element that is outside the size of association:</div>
さらに注意するポイントとして、バインドする関連が2個の物に、それより多い数の場合は:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:textField name=<span class="xml&#45;quote">"books&#91;0&#93;.title"</span> value=<span class="xml&#45;quote">"the Stand"</span> /&#62;</span>
<span class="xml&#45;tag">&#60;g:textField name=<span class="xml&#45;quote">"books&#91;1&#93;.title"</span> value=<span class="xml&#45;quote">"the Shining"</span> /&#62;</span>
<span class="xml&#45;tag">&#60;g:textField name=<span class="xml&#45;quote">"books&#91;2&#93;.title"</span> value=<span class="xml&#45;quote">"Red Madder"</span> /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Then Grails will automatically create a new instance for you at the defined position. If you "skipped" a few elements in the middle:</div>
Grailsが新たにインスタンスを指定したポジションに生成します。途中のいくつかのエレメントを飛ばした数値を指定した場合は:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:textField name=<span class="xml&#45;quote">"books&#91;0&#93;.title"</span> value=<span class="xml&#45;quote">"the Stand"</span> /&#62;</span>
<span class="xml&#45;tag">&#60;g:textField name=<span class="xml&#45;quote">"books&#91;1&#93;.title"</span> value=<span class="xml&#45;quote">"the Shining"</span> /&#62;</span>
<span class="xml&#45;tag">&#60;g:textField name=<span class="xml&#45;quote">"books&#91;5&#93;.title"</span> value=<span class="xml&#45;quote">"Red Madder"</span> /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Then Grails will automatically create instances in between. For example in the above case Grails will create 4 additional instances if the association being bound had a size of 2.</div>
Grailsが間のインスタンスも自動的に生成します。上記のケースでは関連が2個の場合は、4個のインスタンスが追加されます。<p class="paragraph"/><div class="hidden-block">You can bind existing instances of the associated type to a <code>List</code> using the same <code>.id</code> syntax as you would use with a single-ended association. For example:</div>
既存のインスタンスを<code>List</code>関連でバインドするには、単一終端関連と同じように<code>.id</code>シンタックスを使用します。例として:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:select name=<span class="xml&#45;quote">"books&#91;0&#93;.id"</span> from=<span class="xml&#45;quote">"$&#123;bookList&#125;"</span>
          value=<span class="xml&#45;quote">"$&#123;author?.books&#91;0&#93;?.id&#125;"</span> /&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;g:select name=<span class="xml&#45;quote">"books&#91;1&#93;.id"</span> from=<span class="xml&#45;quote">"$&#123;bookList&#125;"</span>
          value=<span class="xml&#45;quote">"$&#123;author?.books&#91;1&#93;?.id&#125;"</span> /&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;g:select name=<span class="xml&#45;quote">"books&#91;2&#93;.id"</span> from=<span class="xml&#45;quote">"$&#123;bookList&#125;"</span>
          value=<span class="xml&#45;quote">"$&#123;author?.books&#91;2&#93;?.id&#125;"</span> /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Would allow individual entries in the <code>books List</code> to be selected separately.</div>
この例では、別々に選択して、<code>books List</code>の特定の場所にエントリを可能にします。<p class="paragraph"/><div class="hidden-block">Entries at particular indexes can be removed in the same way too. For example:</div>
同じ方法で、個々のインデックスからエントリの削除も可能です:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:select name=<span class="xml&#45;quote">"books&#91;0&#93;.id"</span>
          from=<span class="xml&#45;quote">"$&#123;Book.list()&#125;"</span>
          value=<span class="xml&#45;quote">"$&#123;author?.books&#91;0&#93;?.id&#125;"</span>
          noSelection=<span class="xml&#45;quote">"&#91;'null': ''&#93;"</span>/&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Will render a select box that will remove the association at <code>books0</code> if the empty option is chosen.</div>
上記の例では、空のオプションを選択することで、<code>book&#91;0&#93;</code>の関連を削除します。<p class="paragraph"/><div class="hidden-block">Binding to a <code>Map</code> property works the same way except that the list index in the parameter name is replaced by the map key:</div>
リストのインデックス数値をパラメータ名称にすることで、マップのキーとして認識されるので、<code>Map</code>のプロパティも同じ方法で動作します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:select name=<span class="xml&#45;quote">"images&#91;cover&#93;.id"</span>
          from=<span class="xml&#45;quote">"$&#123;Image.list()&#125;"</span>
          value=<span class="xml&#45;quote">"$&#123;book?.images&#91;cover&#93;?.id&#125;"</span>
          noSelection=<span class="xml&#45;quote">"&#91;'null': ''&#93;"</span>/&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">This would bind the selected image into the <code>Map</code> property <code>images</code> under a key of <code>"cover"</code>.</div>
この例では、Mapプロパティimagesのキー"cover"に対してバインドされます。<p class="paragraph"/><div class="hidden-block">When binding to Maps, Arrays and Collections the data binder will automatically grow the size of the collections as necessary.  The default limit to how large the binder will grow a collection is 256.  If the data binder encounters an entry that requires the collection be grown beyond that limit, the entry is ignored.  The limit may be configured by assigning a value to the <code>grails.databinding.autoGrowCollectionLimit</code> property in <code>Config.groovy</code>.</div>
Map・配列・コレクションにバインディングするとき、データバインダは必要に応じて自動的にコレクションのサイズを大きくします。
バインダがコレクションを大きくするときのデフォルトの上限は256です。
もしデータバインダが上限を超えてコレクションを大きくする必要のある要素に出会った場合、その要素は無視されます。
上限は<code>Config.groovy</code>の<code>grails.databinding.autoGrowCollectionLimit</code>プロパティに値を代入すれば変更できます。<p class="paragraph"/><div class="code"><pre>// grails&#45;app/conf/Config.groovy<p class="paragraph"/>// the <span class="java&#45;keyword">default</span> value is 256
grails.databinding.autoGrowCollectionLimit = 128<p class="paragraph"/>// ...</pre></div><p class="paragraph"/><div class="hidden-block">h4. Data binding with Multiple domain classes </div>
<h4>複数ドメインクラスでのデータバインディング</h4><p class="paragraph"/><div class="hidden-block">It is possible to bind data to multiple domain objects from the <a href="../ref/Controllers/params.html" class="controllers">params</a> object.</div>
<a href="../ref/Controllers/params.html" class="controllers">params</a>オブジェクトから、複数のドメインオブジェクトへのデータのバインドが可能です。<p class="paragraph"/><div class="hidden-block">For example so you have an incoming request to:</div>
例として以下のようなリクエストがあったとします:<p class="paragraph"/><div class="code"><pre>/book/save?book.title=The%20Stand&#38;author.name=Stephen%20King</pre></div><p class="paragraph"/><div class="hidden-block">You'll notice the difference with the above request is that each parameter has a prefix such as <code>author.</code> or <code>book.</code> which is used to isolate which parameters belong to which type. Grails' <code>params</code> object is like a multi-dimensional hash and you can index into it to isolate only a subset of the parameters to bind.</div>
上記のリクエストでは、それぞれのパラメータに<code>author.</code>また<code>book.</code>という接頭辞が付いていて、どちらの型(ドメインクラス)に属するかを区別しています。Grailsの<code>params</code>オブジェクトは多次元ハッシュのようになっており、それぞれバインドするためのパラメータサブセットとして区別されて索引されます。<p class="paragraph"/><div class="code"><pre>def b = <span class="java&#45;keyword">new</span> Book(params.book)</pre></div><p class="paragraph"/><div class="hidden-block">Notice how we use the prefix before the first dot of the <code>book.title</code> parameter to isolate only parameters below this level to bind. We could do the same with an <code>Author</code> domain class:</div>
上記のように接頭辞bookをparams指定することで、ドメインクラスBookに対して、<code>book.title</code>パラメータだけが区別されてバインドされます。ドメインクラス<code>Author</code>も同じように指定します。<p class="paragraph"/><div class="code"><pre>def a = <span class="java&#45;keyword">new</span> Author(params.author)</pre></div><p class="paragraph"/><div class="hidden-block">h4. Data Binding and Action Arguments </div>
<h4>データバインディングとアクション引数</h4><p class="paragraph"/><div class="hidden-block">Controller action arguments are subject to request parameter data binding.  There are 2 categories of controller action arguments.  The first category is command objects.  Complex types are treated as command objects.  See the <a href="../guide/single.html#commandObjects" class="guide">Command Objects</a> section of the user guide for details.  The other category is basic object types.  Supported types are the 8 primitives, their corresponding type wrappers and <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/String.html" class="api">java.lang.String</a>.  The default behavior is to map request parameters to action arguments by name:</div>
コントローラのアクション引数はリクエストパラメータのデータバインディング対象です。
コントローラのアクション引数は大きく2つに分類されます。
1つめはコマンドオブジェクトです。
複合型はコマンドオブジェクトとして扱われます。
詳しくはこのユーザガイドの<a href="../guide/single.html#commandObjects" class="guide">コマンドオブジェクト</a>のセクションを参照してください。
もう一つは基本オブジェクト型です。
サポートしている方は8つのプリミティブ型とそれに対応するラッパー型と<a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/String.html" class="api">java.lang.String</a>です。
デフォルトの挙動では、リクエストパラメータとアクション引数は名前に基づいて関連づけられます。<p class="paragraph"/><div class="code"><pre>class AccountingController &#123;<p class="paragraph"/>   // accountNumber will be initialized with the value of params.accountNumber
   // accountType will be initialized with params.accountType
   def displayInvoice(<span class="java&#45;object">String</span> accountNumber, <span class="java&#45;object">int</span> accountType) &#123;
       // &#8230;
   &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">For primitive arguments and arguments which are instances of any of the primitive type wrapper classes a type conversion has to be carried out before the request parameter value can be bound to the action argument.  The type conversion happens automatically.  In a case like the example shown above, the <code>params.accountType</code> request parameter has to be converted to an <code>int</code>.  If type conversion fails for any reason, the argument will have its default value per normal Java behavior (null for type wrapper references, false for booleans and zero for numbers) and a corresponding error will be added to the <code>errors</code> property of the defining controller.</div>
プリミティブ型の引数とプリミティブ型のラッパークラスのインスタンスの引数に対しては、リクエストパラメータの値がアクション引数にバインドされる前に、型変換を実行する必要があります。
この型変換は自動的に行われます。
先に示した例のようなケースでは、<code>params.accountType</code>リクエストパラメータは<code>int</code>型に変換する必要があります。
もし型変換が何らかの理由により失敗した場合は、引数はJava標準的な挙動によるデフォルト値(ラッパー型はnull、boolean型はfalse、数値型は0)をとります。
そして、対応するエラーが対象コントローラの<code>errors</code>プロパティに追加されます。<p class="paragraph"/><div class="code"><pre>/accounting/displayInvoice?accountNumber=B59786&#38;accountType=bogusValue</pre></div><p class="paragraph"/><div class="hidden-block"></div>Since "bogusValue" cannot be converted to type int, the value of accountType will be zero, the controller's <code>errors.hasErrors()</code> will be true, the controller's <code>errors.errorCount</code> will be equal to 1 and the controller's <code>errors.getFieldError('accountType')</code> will contain the corresponding error.
"bogusValue"はint型に変換できないため、<code>accountType</code>は0になります。そして、コントローラの<code>errors.hasErrors()</code>はtrueに、<code>errors.errorCount</code>は1になり、<code>errors.getFieldError('accountType')</code>には対応するエラーが保持されます。<p class="paragraph"/><div class="hidden-block">If the argument name does not match the name of the request parameter then the <code>&#64;grails.web.RequestParameter</code> annotation may be applied to an argument to express the name of the request parameter which should be bound to that argument:</div>
引数名がリクエストパラメータの名前と一致しない場合、その引数にバインドすべきリクエストパラメータの名前を指定するために、<code>&#64;grails.web.RequestParameter</code>アノテーションを引数に付与することができます。<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> grails.web.RequestParameter<p class="paragraph"/>class AccountingController &#123;<p class="paragraph"/>   // mainAccountNumber will be initialized with the value of params.accountNumber
   // accountType will be initialized with params.accountType
   def displayInvoice(@RequestParameter('accountNumber') <span class="java&#45;object">String</span> mainAccountNumber, <span class="java&#45;object">int</span> accountType) &#123;
       // &#8230;
   &#125;
&#125;</pre></div><p class="paragraph"/>
<div class="hidden-block">h4. Data binding and type conversion errors </div>
<h4>型変換エラーとデータバインディング</h4><p class="paragraph"/><div class="hidden-block">Sometimes when performing data binding it is not possible to convert a particular String into a particular target type. This results in a type conversion error. Grails will retain type conversion errors inside the <a href="../ref/Domain Classes/errors.html" class="domainClasses">errors</a> property of a Grails domain class. For example:</div>
時折データバインディングの際に、特有の文字列を特有の型に変換できない場合があります。この場合の結果は型変換エラーとなります。Grailsではドメインインスタンスの<a href="../ref/Domain Classes/errors.html" class="domainClasses">errors</a>プロパティで型変換エラーを保持します。例えば:<p class="paragraph"/>
<div class="code"><pre>class Book &#123;
    &#8230;
    URL publisherURL
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Here we have a domain class <code>Book</code> that uses the <code>java.net.URL</code> class to represent URLs. Given an incoming request such as:</div>
ドメインクラス<code>Book</code>でURLを表すプロパティに<code>java.net.URL</code>クラスを使用したとします。次のようなリクエストを受信したとします:<p class="paragraph"/><div class="code"><pre>/book/save?publisherURL=a&#45;bad&#45;url</pre></div><p class="paragraph"/><div class="hidden-block">it is not possible to bind the string <code>a-bad-url</code> to the <code>publisherURL</code> property as a type mismatch error occurs. You can check for these like this:</div>
型違いエラーが起きるため、文字列<code>a-bad-url</code>を<code>publisherURL</code>にバインドすることはできません。次のようにしてエラーを確認します:<p class="paragraph"/><div class="code"><pre>def b = <span class="java&#45;keyword">new</span> Book(params)<p class="paragraph"/><span class="java&#45;keyword">if</span> (b.hasErrors()) &#123;
    println <span class="java&#45;quote">"The value $&#123;b.errors.getFieldError('publisherURL').rejectedValue&#125;"</span> +
            <span class="java&#45;quote">" is not a valid URL!"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Although we have not yet covered error codes (for more information see the section on <a href="../guide/single.html#validation" class="guide">Validation</a>), for type conversion errors you would want a message from the <code>grails-app/i18n/messages.properties</code> file to use for the error. You can use a generic error message handler such as:</div>
この章までは、まだエラーコードの説明していませんが(詳しくは<a href="../guide/single.html#validation" class="guide">Validation</a>を参照)、型変換エラーでは<code>grails-app/i18n/messages.properties</code>を使用してメッセージを返す事もあると思います。次のような一般的なメッセージハンドラーを使用することもできます<p class="paragraph"/><div class="code"><pre>typeMismatch.java.net.URL=The field &#123;0&#125; is not a valid URL</pre></div><p class="paragraph"/><div class="hidden-block">Or a more specific one:</div>
また、さらに対象を特定する場合は:<p class="paragraph"/><div class="code"><pre>typeMismatch.Book.publisherURL=The publisher URL you specified is not a valid URL</pre></div><p class="paragraph"/><div class="hidden-block">h4. The BindUsing Annotation</div>
<h4>BindUsingアノテーション</h4><p class="paragraph"/><div class="hidden-block">The <a href="http://grails.org/doc/latest/api/org/grails/databinding/BindUsing.html" class="api">BindUsing</a> annotation may be used to define a custom binding mechanism for a particular field in a class.  Any time data binding is being applied to the field the closure value of the annotation will be invoked with 2 arguments.  The first argument is the object that data binding is being applied to and the second argument is a <code>Map</code> which is the data source for the data binding.  The value returned from the closure will be bound to the property.  The following example would result in the upper case version of the <code>name</code> value in the source being applied to the <code>name</code> field during data binding.</div>
<a href="http://grails.org/doc/latest/api/org/grails/databinding/BindUsing.html" class="api">BindUsing</a>アノテーションはクラスの特定のフィールドに独自のバインディング方法を定義するために使います。
データバインディングがそのフィールドに適用されるときは毎回アノテーションに指定されたクロージャが2つの引数で実行されます。
最初の引数はデータバインディングを適用しようとしているオブジェクトで、2番目の引数はデータバインディングのためのデータソースとなる<code>Map</code>です。
クロージャが返す値はオブジェクトのプロパティにバインドされます。
以下の例では、データバーディングによってデータソースの<code>name</code>の値が大文字に変換されたものが<code>name</code>フィールドに設定されます。<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> org.grails.databinding.BindUsing<p class="paragraph"/>class SomeClass &#123;
    @BindUsing(&#123;
        obj, source &#45;&#62; source&#91;'name'&#93;?.toUpperCase()
    &#125;)
    <span class="java&#45;object">String</span> name
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">The <a href="http://grails.org/doc/latest/api/org/grails/databinding/BindUsing.html" class="api">BindUsing</a> annotation may be used to define a custom binding mechanism for all of the fields on a particular class. When the annotation is applied to a class, the value assigned to the annotation should be a class which implements the <a href="http://grails.org/doc/latest/api/org/grails/databinding/BindingHelper.html" class="api">BindingHelper</a> interface.  An instance of that class will be used any time a value is bound to a property in the class that this annotation has been applied to.</div>
<a href="http://grails.org/doc/latest/api/org/grails/databinding/BindUsing.html" class="api">BindUsing</a>アノテーションは特定のクラス上のすべてのフィールドに対する独自のバインディング方法を定義するためにも使えます。
このアノテーションをクラスに指定するときは、アノテーションに指定する値は <a href="http://grails.org/doc/latest/api/org/grails/databinding/BindingHelper.html" class="api">BindingHelper</a>インターフェイスを実装したクラスにしなくてはいけません。
このクラスのインスタンスは、アノテーションが指定されたクラス内のプロパティに値がバインドされるときに毎回使われます。<p class="paragraph"/><div class="code"><pre>@BindUsing(SomeClassWhichImplementsBindingHelper)
class SomeClass &#123;
    <span class="java&#45;object">String</span> someProperty
    <span class="java&#45;object">Integer</span> someOtherProperty
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">h4. Custom Data Converters</div>
<h4>カスタムデータコンバータ</h4><p class="paragraph"/><div class="hidden-block">The binder will do a lot of type conversion automatically.  Some applications may want to define their own mechanism for converting values and a simple way to do this is to write a class which implements <a href="http://grails.org/doc/latest/api/org/grails/databinding/converters/ValueConverter.html" class="api">ValueConverter</a> and register an instance of that class as a bean in the Spring application context.</div>
バインダはたくさんの型変換を自動的に行います。
いくつかのアプリケーションでは、値を変換するための独自の機構を定義したいかもしれません。
そのための簡単な方法は<a href="http://grails.org/doc/latest/api/org/grails/databinding/converters/ValueConverter.html" class="api">ValueConverter</a>を実装するクラスを書いて、そのクラスのインスタンスをビーンとしてSpringのアプリケーションコンテキストに登録することです。<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">package</span> com.myapp.converters<p class="paragraph"/><span class="java&#45;keyword">import</span> org.grails.databinding.converters.ValueConverter<p class="paragraph"/>/&#42;&#42;
 &#42; A custom converter which will convert <span class="java&#45;object">String</span> of the
 &#42; form 'city:state' into an Address object.
 &#42;/
class AddressValueConverter <span class="java&#45;keyword">implements</span> ValueConverter &#123;<p class="paragraph"/>    <span class="java&#45;object">boolean</span> canConvert(value) &#123;
        value <span class="java&#45;keyword">instanceof</span> <span class="java&#45;object">String</span>
    &#125;<p class="paragraph"/>    def convert(value) &#123;
        def pieces = value.split(':')
        <span class="java&#45;keyword">new</span> com.myapp.Address(city: pieces&#91;0&#93;, state: pieces&#91;1&#93;)
    &#125;<p class="paragraph"/>    <span class="java&#45;object">Class</span>&#60;?&#62; getTargetType() &#123;
        com.myapp.Address
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">An instance of that class needs to be registered as a bean in the Spring application context.  The bean name is not important.  All beans that implemented ValueConverter will be automatically plugged in to the data binding process.</div>
クラスのインスタンスはSpringのアプリケーションコンテキストにビーンとして登録する必要があります。
ビーンの名前は重要ではありません。
<code>ValueConverter</code>を実装したすべてのビーンは、自動的にデータバインディングプロセスに組み込まれます。<p class="paragraph"/><div class="code"><pre>// grails&#45;app/conf/spring/resources.groovy<p class="paragraph"/>beans = &#123;<p class="paragraph"/>    addressConverter com.myapp.converters.AddressValueConverter<p class="paragraph"/>    // ...<p class="paragraph"/>&#125;</pre></div><p class="paragraph"/><div class="code"><pre>class Person &#123;
    <span class="java&#45;object">String</span> firstName
    Address homeAddress
&#125;<p class="paragraph"/>class Address &#123;
    <span class="java&#45;object">String</span> city
    <span class="java&#45;object">String</span> state
&#125;<p class="paragraph"/>def person = <span class="java&#45;keyword">new</span> Person()
person.properties = &#91;firstName: 'Jeff', homeAddress: <span class="java&#45;quote">"O'Fallon:Missouri"</span>&#93;
assert person.firstName == 'Jeff'
assert person.homeAddress.city = <span class="java&#45;quote">"O'Fallon"</span>
assert person.homeAddress.state = 'Missouri'</pre></div><p class="paragraph"/><div class="hidden-block">h4. Date Formats For Data Binding</div>
<h4>データバインディングのためのデータフォーマット</h4><p class="paragraph"/><div class="hidden-block">A custom date format may be specified to be used when binding a String to a Date value by applying the <a href="http://grails.org/doc/latest/api/org/grails/databinding/BindingFormat.html" class="api">BindingFormat</a> annotation to a Date field.</div>
文字列を<code>Date</code>の値にバインドするとき、<a href="http://grails.org/doc/latest/api/org/grails/databinding/BindingFormat.html" class="api">BindingFormat</a>アノテーションをデータフィールドに付与することで、カスタムデータフォーマットを指定できます。<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> org.grails.databinding.BindingFormat<p class="paragraph"/>class Person &#123;
    @BindingFormat('MMddyyyy')
    Date birthDate
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">h4. Custom Formatted Converters</div>
<h4>カスタムフォーマットコンバータ</h4><p class="paragraph"/><div class="hidden-block">You may supply your own handler for the <a href="http://grails.org/doc/latest/api/org/grails/databinding/BindingFormat.html" class="api">BindingFormat</a> annotation by writing a class which implements the <a href="http://grails.org/doc/latest/api/org/grails/databinding/converters/FormattedValueConverter.html" class="api">FormattedValueConverter</a> interface and regiserting an instance of that class as a bean in the Spring application context.  Below is an example of a trivial custom String formatter that might convert the case of a String based on the value assigned to the BindingFormat annotation.</div>
<a href="http://grails.org/doc/latest/api/org/grails/databinding/converters/FormattedValueConverter.html" class="api">FormattedValueConverter</a>インターフェイスを実装したクラスを書いて、そのクラスのインスタンスをビーンとしてSpringのアプリケーションコンテキストに登録することで、<a href="http://grails.org/doc/latest/api/org/grails/databinding/BindingFormat.html" class="api">BindingFormat</a>アノテーションに対して独自のハンドラを提供できます。
以下は、<code>BindingFormat</code>アノテーションが指定された値の文字列の大文字/小文字を変換するという、ちょっとした文字列のカスタムフォーマッタの例です。<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">package</span> com.myapp.converters<p class="paragraph"/><span class="java&#45;keyword">import</span> org.grails.databinding.converters.FormattedValueConverter<p class="paragraph"/>class FormattedStringValueConverter <span class="java&#45;keyword">implements</span> FormattedValueConverter &#123;
    def convert(value, <span class="java&#45;object">String</span> format) &#123;
        <span class="java&#45;keyword">if</span>('UPPERCASE' == format) &#123;
            value = value.toUpperCase()
        &#125; <span class="java&#45;keyword">else</span> <span class="java&#45;keyword">if</span>('LOWERCASE' == format) &#123;
            value = value.toLowerCase()
        &#125;
        value
    &#125;<p class="paragraph"/>    <span class="java&#45;object">Class</span> getTargetType() &#123;
        // specifies the type to which <span class="java&#45;keyword">this</span> converter may be applied
        <span class="java&#45;object">String</span>
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">An instance of that class needs to be registered as a bean in the Spring application context.  The bean name is not important.  All beans that implemented FormattedValueConverter will be automatically plugged in to the data binding process.</div>
クラスのインスタンスはSpringのアプリケーションコンテキストにビーンとして登録する必要があります。
ビーンの名前は重要ではありません。
<code>FormattedValueConverter</code>を実装したすべてのビーンは、自動的にデータバインディングプロセスに組み込まれます。<p class="paragraph"/><div class="code"><pre>// grails&#45;app/conf/spring/resources.groovy<p class="paragraph"/>beans = &#123;<p class="paragraph"/>    formattedStringConverter com.myapp.converters.FormattedStringValueConverter<p class="paragraph"/>    // ...<p class="paragraph"/>&#125;</pre></div><p class="paragraph"/><div class="hidden-block">With that in place the <code>BindingFormat</code> annotation may be applied to String fields to inform the data binder to take advantage of the custom converter.</div>
所定の場所にこれがあれば、データバインダにカスタムコンバータを利用することを伝えるために、<code>BindingFormat</code>アノテーションを文字列フィールドに適用できます。<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> org.grails.databinding.BindingFormat<p class="paragraph"/>class Person &#123;
    @BindingFormat('UPPERCASE')
    <span class="java&#45;object">String</span> someUpperCaseString<p class="paragraph"/>    @BindingFormat('LOWERCASE')
    <span class="java&#45;object">String</span> someLowerCaseString<p class="paragraph"/>    <span class="java&#45;object">String</span> someOtherString
&#125;</pre></div><p class="paragraph"/>
<div class="hidden-block">h4. Data Binding and Security concerns </div>
<h4>データバインディングとセキュリティ考慮</h4><p class="paragraph"/><div class="hidden-block">When batch updating properties from request parameters you need to be careful not to allow clients to bind malicious data to domain classes and be persisted in the database. You can limit what properties are bound to a given domain class using the subscript operator:</div>
リクエストパラメータからの一括プロパティ更新をする際は、クライアントからの悪意のあるデータをドメインクラスにバインドし、データベースに永続化してしまわないように注意が必要です。
添字演算子を使用してドメインクラスにバインドするプロパティを制限することができます:<p class="paragraph"/><div class="code"><pre>def p = Person.get(1)<p class="paragraph"/>p.properties&#91;'firstName','lastName'&#93; = params</pre></div><p class="paragraph"/><div class="hidden-block">In this case only the <code>firstName</code> and <code>lastName</code> properties will be bound.</div>
上記の例では、<code>firstName</code>と<code>lastName</code>のみバインドされます。<p class="paragraph"/><div class="hidden-block">Another way to do this is is to use <a href="../guide/single.html#commandObjects" class="guide">Command Objects</a> as the target of data binding instead of domain classes. Alternatively there is also the flexible <a href="../ref/Controllers/bindData.html" class="controllers">bindData</a> method.</div>
他には、データバインディングの対象をドメインクラスではなく<a href="../guide/single.html#commandObjects" class="guide">コマンドオブジェクト</a>を利用する方法があります。あるいは柔軟な<a href="../ref/Controllers/bindData.html" class="controllers">bindData</a>メソッドを使用します。<p class="paragraph"/><div class="hidden-block">The <code>bindData</code> method allows the same data binding capability, but to arbitrary objects:</div>
<code>bindData</code>メソッドは任意のオブジェクトに同様のデータバインディングができます:<p class="paragraph"/><div class="code"><pre>def p = <span class="java&#45;keyword">new</span> Person()
bindData(p, params)</pre></div><p class="paragraph"/><div class="hidden-block">The <code>bindData</code> method also lets you exclude certain parameters that you don't want updated:</div>
<code>bindData</code>メソッドでは、更新したくないパラメータを除外することができます:<p class="paragraph"/><div class="code"><pre>def p = <span class="java&#45;keyword">new</span> Person()
bindData(p, params, &#91;exclude: 'dateOfBirth'&#93;)</pre></div><p class="paragraph"/><div class="hidden-block">Or include only certain properties:</div>
または、指定したプロパティのみの更新も可能です:<p class="paragraph"/><div class="code"><pre>def p = <span class="java&#45;keyword">new</span> Person()
bindData(p, params, &#91;include: &#91;'firstName', 'lastName'&#93;&#93;)</pre></div><p class="paragraph"/><blockquote class="note">
<div class="hidden-block">Note that if an empty List is provided as a value for the <code>include</code> parameter then all fields will be subject to binding if they are not explicitly excluded.</div>
空のリストが<code>include</code>パラメータの値として与えられた場合、明示的に除外指定がなされていない限り、すべてのフィールドがバインディング対象となることに注意してください。
</blockquote>



<h2 id="xmlAndJSON">7.1.7 XMLとJSONのレスポンス</h2>
<h4>renderメソッドでXMLを出力する <div class="hidden-block">Using the render method to output XML </div></h4><p class="paragraph"/><div class="hidden-block">Grails supports a few different ways to produce XML and JSON responses. The first is the <a href="../ref/Controllers/render.html" class="controllers">render</a> method.</div>
GrailsにはXMLとJSONを生成する複数の方法があります。はじめに<a href="../ref/Controllers/render.html" class="controllers">render</a>メソッド。<p class="paragraph"/><div class="hidden-block">The <code>render</code> method can be passed a block of code to do mark-up building in XML:</div>
<code>render</code>メソッドに、マークアップビルダーのコードブロックを渡してXML生成:<p class="paragraph"/><div class="code"><pre>def list() &#123;<p class="paragraph"/>    def results = Book.list()<p class="paragraph"/>    render(contentType: <span class="java&#45;quote">"text/xml"</span>) &#123;
        books &#123;
            <span class="java&#45;keyword">for</span> (b in results) &#123;
                book(title: b.title)
            &#125;
        &#125;
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">The result of this code would be something like:</div>
このコードの結果は以下のようになります:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;books&#62;</span>
    <span class="xml&#45;tag">&#60;book title=<span class="xml&#45;quote">"The Stand"</span> /&#62;</span>
    <span class="xml&#45;tag">&#60;book title=<span class="xml&#45;quote">"The Shining"</span> /&#62;</span>
<span class="xml&#45;tag">&#60;/books&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Be careful to avoid naming conflicts when using mark-up building. For example this code would produce an error:</div>
マークアップビルダーを使用する際は、変数名称の衝突を回避する必要があります。例として次のコードはエラーになります:<p class="paragraph"/><div class="code"><pre>def list() &#123;<p class="paragraph"/>    def books = Book.list()  // naming conflict here<p class="paragraph"/>    render(contentType: <span class="java&#45;quote">"text/xml"</span>) &#123;
        books &#123;
            <span class="java&#45;keyword">for</span> (b in results) &#123;
                book(title: b.title)
            &#125;
        &#125;
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">This is because there is local variable <code>books</code> which Groovy attempts to invoke as a method.</div>
この例では、Groovyがローカル変数のbooksをメソッドとして実行してしまいます。<p class="paragraph"/><h4>renderメソッドでJSONを出力する <div class="hidden-block">Using the render method to output JSON </div></h4><p class="paragraph"/><div class="hidden-block">The <code>render</code> method can also be used to output JSON:</div>
JSONを出力する場合も<code>render</code>メソッドが使用できます:<p class="paragraph"/><div class="code"><pre>def list() &#123;<p class="paragraph"/>    def results = Book.list()<p class="paragraph"/>    render(contentType: <span class="java&#45;quote">"text/json"</span>) &#123;
        books = array &#123;
            <span class="java&#45;keyword">for</span> (b in results) &#123;
                book title: b.title
            &#125;
        &#125;
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">In this case the result would be something along the lines of:</div>
このコードの結果は以下のようになります:<p class="paragraph"/><div class="code"><pre>&#91;
    &#123;<span class="java&#45;quote">"title"</span>:<span class="java&#45;quote">"The Stand"</span>&#125;,
    &#123;<span class="java&#45;quote">"title"</span>:<span class="java&#45;quote">"The Shining"</span>&#125;
&#93;</pre></div><p class="paragraph"/><div class="hidden-block">The same dangers with naming conflicts described above for XML also apply to JSON building.</div>
JSONビルダーもXMLと同じく、変数名称の衝突を回避する必要があります。<p class="paragraph"/><h4>自動XMLマーシャリング <div class="hidden-block">Automatic XML Marshalling </div></h4><p class="paragraph"/><div class="hidden-block">Grails also supports automatic marshalling of <a href="../guide/single.html#GORM" class="guide">domain classes</a> to XML using special converters.</div>
Grailsでは<a href="../guide/single.html#GORM" class="guide">ドメインクラス</a>から特別なコンバータを使用した自動マーシャリングをサポートしています。<p class="paragraph"/><div class="hidden-block">To start off with, import the <code>grails.converters</code> package into your controller:</div>
使用するには、<code>grails.converters</code>パッケージをインポートする必要があります:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> grails.converters.&#42;</pre></div><p class="paragraph"/><div class="hidden-block">Now you can use the following highly readable syntax to automatically convert domain classes to XML:</div>
ドメインクラスをXMLに変換するのに、次のように見やすいシンタックスで記述できます:<p class="paragraph"/><div class="code"><pre>render Book.list() as XML</pre></div><p class="paragraph"/><div class="hidden-block">The resulting output would look something like the following::</div>
この例では次のような結果を出力します:<p class="paragraph"/><div class="code"><pre>&#60;?xml version=<span class="java&#45;quote">"1.0"</span> encoding=<span class="java&#45;quote">"ISO&#45;8859&#45;1"</span>?&#62;
&#60;list&#62;
  &#60;book id=<span class="java&#45;quote">"1"</span>&#62;
    &#60;author&#62;Stephen King&#60;/author&#62;
    &#60;title&#62;The Stand&#60;/title&#62;
  &#60;/book&#62;
  &#60;book id=<span class="java&#45;quote">"2"</span>&#62;
    &#60;author&#62;Stephen King&#60;/author&#62;
    &#60;title&#62;The Shining&#60;/title&#62;
  &#60;/book&#62;
&#60;/list&#62;</pre></div><p class="paragraph"/><div class="hidden-block">An alternative to using the converters is to use the <a href="../guide/single.html#codecs" class="guide">codecs</a> feature of Grails. The codecs feature provides <a href="../guide/single.html#codecs" class="guide">encodeAsXML</a> and <a href="../guide/single.html#codecs" class="guide">encodeAsJSON</a> methods:</div>
またconvertersを使用する別の方法としてGrailsの<a href="../guide/single.html#codecs" class="guide">codecs</a>を使用することもできます。codecsでは、<a href="../guide/single.html#codecs" class="guide">encodeAsXML</a>と<a href="../guide/single.html#codecs" class="guide">encodeAsJSON</a>メソッドを提供しています:<p class="paragraph"/><div class="code"><pre>def xml = Book.list().encodeAsXML()
render xml</pre></div><p class="paragraph"/><div class="hidden-block">For more information on XML marshalling see the section on <a href="../guide/single.html#REST" class="guide">REST</a></div>
XMLマーシャリングの情報は<a href="../guide/single.html#REST" class="guide">REST</a>のセクションも参照してください。<p class="paragraph"/><h4>自動JSONマーシャリング <div class="hidden-block">Automatic JSON Marshalling </div></h4><p class="paragraph"/><div class="hidden-block">Grails also supports automatic marshalling to JSON using the same mechanism. Simply substitute <code>XML</code> with <code>JSON</code>:</div>
Grailsでは<code>XML</code>と同じ仕組みで、<code>JSON</code>の自動マーシャリングもサポートしています。単純に先の<code>XML</code>を<code>JSON</code>にするだけです<p class="paragraph"/><div class="code"><pre>render Book.list() as JSON</pre></div><p class="paragraph"/><div class="hidden-block">The resulting output would look something like the following:</div>
この例では次のような結果を出力します:<p class="paragraph"/><div class="code"><pre>&#91;
    &#123;<span class="java&#45;quote">"id"</span>:1,
     <span class="java&#45;quote">"class"</span>:<span class="java&#45;quote">"Book"</span>,
     <span class="java&#45;quote">"author"</span>:<span class="java&#45;quote">"Stephen King"</span>,
     <span class="java&#45;quote">"title"</span>:<span class="java&#45;quote">"The Stand"</span>&#125;,
    &#123;<span class="java&#45;quote">"id"</span>:2,
     <span class="java&#45;quote">"class"</span>:<span class="java&#45;quote">"Book"</span>,
     <span class="java&#45;quote">"author"</span>:<span class="java&#45;quote">"Stephen King"</span>,
     <span class="java&#45;quote">"releaseDate"</span>:<span class="java&#45;keyword">new</span> Date(1194127343161),
     <span class="java&#45;quote">"title"</span>:<span class="java&#45;quote">"The Shining"</span>&#125;
 &#93;</pre></div><p class="paragraph"/><div class="hidden-block">Again as an alternative you can use the <code>encodeAsJSON</code> to achieve the same effect.</div>
もちろん、<code>encodeAsJSON</code>も同じ結果になります。


<a name="7.1.8 More on JSONBuilder"><!-- Legacy link --></a>
<h2 id="moreOnJSONBuilder">7.1.8 JSONBuilder (JSONビルダー)</h2>
<div class="hidden-block">The previous section on on XML and JSON responses covered simplistic examples of rendering XML and JSON responses. Whilst the XML builder used by Grails is the standard <a href="http://groovy.codehaus.org/Reading+XML+using+Groovy's+XmlSlurper" target="blank">XmlSlurper</a> found in Groovy, the JSON builder is a custom implementation specific to Grails.</div>
前のセクション「 XMLとJSONレスポンス」で単純なXMLとJSONのを描写してレスポンスする例を紹介しました。Grailsで使用してるXMLビルダーがGroovyの標準的な <a href="http://groovy.codehaus.org/Reading+XML+using+Groovy's+XmlSlurper" target="blank">XmlSlurper</a> に対して、JSONビルダーに関してはGrails特有の実装になっています。<p class="paragraph"/><h4>JSONBuilderとGrailsのバージョン <div class="hidden-block">JSONBuilder and Grails versions </div></h4><p class="paragraph"/><div class="hidden-block">JSONBuilder behaves different depending on the version of Grails you use. For version below 1.2 the deprecated <a href="http://grails.org/doc/latest/api/grails/web/JSONBuilder.html" class="api">grails.web.JSONBuilder</a> class is used. This section covers the usage of the Grails 1.2 JSONBuilder </div>
JSONBuilderの振る舞いは使用するGrailsのバージョンに依存します。1.2以前では現在非推奨となる<a href="http://grails.org/doc/latest/api/grails/web/JSONBuilder.html" class="api">grails.web.JSONBuilder</a>が使用されます。このセクションでは、Grails 1.2のJSONBuilderの説明をします。<p class="paragraph"/><div class="hidden-block">For backwards compatibility the old <code>JSONBuilder</code> class is used with the <code>render</code> method for older applications; to use the newer/better <code>JSONBuilder</code> class set the following in <code>Config.groovy</code>:</div>
下位互換として、古いバージョンからメンテナンスしているアプリケーションのために、<code>render</code>メソッドで古い<code>JSONBuilder</code>を使用するようになっています。新しい良くなった<code>JSONBuilder</code>を使用するには<code>Config.groovy</code>に、次のような設定をします:<p class="paragraph"/><div class="code"><pre>grails.json.legacy.builder = <span class="java&#45;keyword">false</span></pre></div><p class="paragraph"/><h4>単純なオブジェクトを描写 <div class="hidden-block">Rendering Simple Objects </div></h4><p class="paragraph"/><div class="hidden-block">To render a simple JSON object just set properties within the context of the Closure:</div>
単純なJSONオブジェクトを生成するには、クロージャの中にプロパティをセットするだけです:<p class="paragraph"/><div class="code"><pre>render(contentType: <span class="java&#45;quote">"text/json"</span>) &#123;
    hello = <span class="java&#45;quote">"world"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">The above will produce the JSON:</div>
上記の例では、このような結果が得られます:<p class="paragraph"/><div class="code"><pre>&#123;<span class="java&#45;quote">"hello"</span>:<span class="java&#45;quote">"world"</span>&#125;</pre></div><p class="paragraph"/><h4>JSON配列描写 <div class="hidden-block">Rendering JSON Arrays </div></h4><p class="paragraph"/><div class="hidden-block">To render a list of objects simple assign a list:</div>
オブジェクトのリストを描写するには、変数に配列を指定するだけです:<p class="paragraph"/><div class="code"><pre>render(contentType: <span class="java&#45;quote">"text/json"</span>) &#123;
    categories = &#91;'a', 'b', 'c'&#93;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">This will produce:</div>
この例では以下を生成:<p class="paragraph"/><div class="code"><pre>&#123;<span class="java&#45;quote">"categories"</span>:&#91;<span class="java&#45;quote">"a"</span>,<span class="java&#45;quote">"b"</span>,<span class="java&#45;quote">"c"</span>&#93;&#125;</pre></div><p class="paragraph"/><div class="hidden-block">You can also render lists of complex objects, for example:</div>
複雑なオブジェクトのリストも可能です。例として:<p class="paragraph"/><div class="code"><pre>render(contentType: <span class="java&#45;quote">"text/json"</span>) &#123;
    categories = &#91; &#123; a = <span class="java&#45;quote">"A"</span> &#125;, &#123; b = <span class="java&#45;quote">"B"</span> &#125; &#93;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">This will produce:</div>
この例では以下を生成:<p class="paragraph"/><div class="code"><pre>&#123;<span class="java&#45;quote">"categories"</span>:&#91; &#123;<span class="java&#45;quote">"a"</span>:<span class="java&#45;quote">"A"</span>&#125; , &#123;<span class="java&#45;quote">"b"</span>:<span class="java&#45;quote">"B"</span>&#125;&#93; &#125;</pre></div><p class="paragraph"/><div class="hidden-block">Use the special <code>element</code> method to return a list as the root:</div>
<code>element</code>メソッドを使用することで、リストをルートとして返す事ができます:<p class="paragraph"/><div class="code"><pre>render(contentType: <span class="java&#45;quote">"text/json"</span>) &#123;
    element 1
    element 2
    element 3
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">The above code produces:</div>
この例では以下を生成:<p class="paragraph"/><div class="code"><pre>&#91;1,2,3&#93;</pre></div><p class="paragraph"/><h4>複雑なオブジェクトの描写 <div class="hidden-block">Rendering Complex Objects </div></h4><p class="paragraph"/><div class="hidden-block">Rendering complex objects can be done with Closures. For example:</div>
より複雑なオブジェクトをクロージャで描写できます。例として:<p class="paragraph"/><div class="code"><pre>render(contentType: <span class="java&#45;quote">"text/json"</span>) &#123;
    categories = &#91;'a', 'b', 'c'&#93;
    title = <span class="java&#45;quote">"Hello JSON"</span>
    information = &#123;
        pages = 10
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">The above will produce the JSON:</div>
この例では次のようなJSONを生成します:<p class="paragraph"/><div class="code"><pre>&#123;<span class="java&#45;quote">"categories"</span>:&#91;<span class="java&#45;quote">"a"</span>,<span class="java&#45;quote">"b"</span>,<span class="java&#45;quote">"c"</span>&#93;,<span class="java&#45;quote">"title"</span>:<span class="java&#45;quote">"Hello JSON"</span>,<span class="java&#45;quote">"information"</span>:&#123;<span class="java&#45;quote">"pages"</span>:10&#125;&#125;</pre></div><p class="paragraph"/><h4>複雑なオブジェクトの配列 <div class="hidden-block">Arrays of Complex Objects </div></h4><p class="paragraph"/><div class="hidden-block">As mentioned previously you can nest complex objects within arrays using Closures:</div>
前述したように、クロージャを使用してオブジェクトを配列にネストすることも可能です:<p class="paragraph"/><div class="code"><pre>render(contentType: <span class="java&#45;quote">"text/json"</span>) &#123;
    categories = &#91; &#123; a = <span class="java&#45;quote">"A"</span> &#125;, &#123; b = <span class="java&#45;quote">"B"</span> &#125; &#93;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">You can use the <code>array</code> method to build them up dynamically:</div>
<code>array</code>メソッドを使用して動的に生成する事もできます:<p class="paragraph"/><div class="code"><pre>def results = Book.list()
render(contentType: <span class="java&#45;quote">"text/json"</span>) &#123;
    books = array &#123;
        <span class="java&#45;keyword">for</span> (b in results) &#123;
            book title: b.title
        &#125;
    &#125;
&#125;</pre></div><p class="paragraph"/><h4>JSONBuilder APIに直接アクセスする <div class="hidden-block">Direct JSONBuilder API Access </div></h4><p class="paragraph"/><div class="hidden-block">If you don't have access to the <code>render</code> method, but still want to produce JSON you can use the API directly:</div>
renderメソッドと関係の無い場所ではJSONを生成したい場合はAPIを直に使用できます:<p class="paragraph"/><div class="code"><pre>def builder = <span class="java&#45;keyword">new</span> JSONBuilder()<p class="paragraph"/>def result = builder.build &#123;
    categories = &#91;'a', 'b', 'c'&#93;
    title = <span class="java&#45;quote">"Hello JSON"</span>
    information = &#123;
        pages = 10
    &#125;
&#125;<p class="paragraph"/>// prints the JSON text
println result.toString()<p class="paragraph"/>def sw = <span class="java&#45;keyword">new</span> StringWriter()
result.render sw</pre></div>


<a name="7.1.9 Uploading Files"><!-- Legacy link --></a>
<h2 id="uploadingFiles">7.1.9 ファイルアップロード</h2>
<h4>プログラムによるファイルアップロード <div class="hidden-block">Programmatic File Uploads </div></h4><p class="paragraph"/><div class="hidden-block">Grails supports file uploads using Spring's <a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/multipart/MultipartHttpServletRequest.html" class="api">MultipartHttpServletRequest</a> interface. The first step for file uploading is to create a multipart form like this:</div>
Grailsでは、Springの<a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/multipart/MultipartHttpServletRequest.html" class="api">MultipartHttpServletRequest</a>インターフェイスを使用してファイルアップロードをサポートしています。ファイルアップロードを実装するには、先に次のようにフォームをマルチパートフォームにします:<p class="paragraph"/><div class="code"><pre>Upload Form: <span class="xml&#45;tag">&#60;br /&#62;</span>
    <span class="xml&#45;tag">&#60;g:uploadForm action=<span class="xml&#45;quote">"upload"</span>&#62;</span>
        <span class="xml&#45;tag">&#60;input type=<span class="xml&#45;quote">"file"</span> name=<span class="xml&#45;quote">"myFile"</span> /&#62;</span>
        <span class="xml&#45;tag">&#60;input type=<span class="xml&#45;quote">"submit"</span> /&#62;</span>
    <span class="xml&#45;tag">&#60;/g:uploadForm&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">The <code>uploadForm</code> tag conveniently adds the <code>enctype="multipart/form-data"</code> attribute to the standard <code>&#60;g:form&#62;</code> tag.</div>
<code>uploadForm</code>タグは、通常の<code>&#60;g:form&#62;</code>タグに、<code>enctype="multipart/form-data"</code>の属性を追加します。<p class="paragraph"/><div class="hidden-block">There are then a number of ways to handle the file upload. One is to work with the Spring <a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/multipart/MultipartFile.html" class="api">MultipartFile</a> instance directly:</div>
アップロードされたファイルを処理するには複数の方法があります。そのうちの一つはSpringの<a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/multipart/MultipartFile.html" class="api">MultipartFile</a>インスタンスを直接操作する方法です:<p class="paragraph"/><div class="code"><pre>def upload() &#123;
    def f = request.getFile('myFile')
    <span class="java&#45;keyword">if</span> (f.empty) &#123;
        flash.message = 'file cannot be empty'
        render(view: 'uploadForm')
        <span class="java&#45;keyword">return</span>
    &#125;<p class="paragraph"/>    f.transferTo(<span class="java&#45;keyword">new</span> File('/some/local/dir/myfile.txt'))
    response.sendError(200, 'Done')
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">This is convenient for doing transfers to other destinations and manipulating the file directly as you can obtain an <code>InputStream</code> and so on with the <a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/multipart/MultipartFile.html" class="api">MultipartFile</a> interface.</div>
この<a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/multipart/MultipartFile.html" class="api">MultipartFile</a>を使用すると、ファイルを別の場所に転送したり、<code>InputStream</code>を取得して直接ファイルを操作したりなど便利です。<p class="paragraph"/><h4>データバインディング経由のファイルアップロード <div class="hidden-block">File Uploads through Data Binding </div></h4><p class="paragraph"/><div class="hidden-block">File uploads can also be performed using data binding. Consider this <code>Image</code> domain class:</div>
データバインディングでファイルアップロードを処理する事ができます。<code>Image</code>というドメインクラスがあるとします:<p class="paragraph"/><div class="code"><pre>class Image &#123;
    <span class="java&#45;object">byte</span>&#91;&#93; myFile<p class="paragraph"/>    <span class="java&#45;keyword">static</span> constraints = &#123;
        // Limit upload file size to 2MB
        myFile maxSize: 1024 &#42; 1024 &#42; 2
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">If you create an image using the <code>params</code> object in the constructor as in the example below, Grails will automatically bind the file's contents as a <code>byte</code> to the <code>myFile</code> property:</div>
次の例のように、<code>params</code>をコンストラクタに渡してImageオブジェクトを生成すると、Grailsが自動的にファイルのコンテントを<code>myFile</code>プロパティに<code>byte&#91;&#93;</code>としてバインドします:<p class="paragraph"/><div class="code"><pre>def img = <span class="java&#45;keyword">new</span> Image(params)</pre></div><p class="paragraph"/><div class="hidden-block">It's important that you set the <a href="../ref/Constraints/size.html" class="constraints">size</a> or <a href="../ref/Constraints/maxSize.html" class="constraints">maxSize</a> constraints, otherwise your database may be created with a small column size that can't handle reasonably sized files. For example, both H2 and MySQL default to a blob size of 255 bytes for <code>byte</code> properties.</div>
この場合、データベースカラムのサイズが小さいと処理できなくなるので、<a href="../ref/Constraints/size.html" class="constraints">size</a>または<a href="../ref/Constraints/maxSize.html" class="constraints">maxSize</a>の制約を指定しましょう。例としてH2とMySQLは、<code>byte&#91;&#93;</code>プロパティで指定した場合のblobのデフォルトサイズが255バイトになります。<p class="paragraph"/><div class="hidden-block">It is also possible to set the contents of the file as a string by changing the type of the <code>myFile</code> property on the image to a String type:</div>
テキストファイルなどの場合は、<code>myFile</code>プロパティの型をString型にすることで文字列にすることも可能です:<p class="paragraph"/><div class="code"><pre>class Image &#123;
   <span class="java&#45;object">String</span> myFile
&#125;</pre></div>


<a name="7.1.10 Command Objects"><!-- Legacy link --></a>
<h2 id="commandObjects">7.1.10 コマンドオブジェクト</h2>
<div class="hidden-block">Grails controllers support the concept of command objects. A command object is a class that is used in conjunction with <a href="../guide/single.html#dataBinding" class="guide">data binding</a>, usually to allow validation of data that may not fit into an existing domain class.</div><p class="paragraph"/>Grailsのコマンドオブジェクトの設計概念をサポートしています。 コマンドオブジェクトは <a href="../guide/single.html#dataBinding" class="guide">data binding</a> と連結して使用するクラスであり、通常ドメインクラスとして扱わないデータに対してバリデーションを可能にします。<p class="paragraph"/><blockquote class="note">
Note: A class is only considered to be a command object when it is used as a parameter of an action.
</blockquote><p class="paragraph"/><h4>コマンドオブジェクトの宣言 <div class="hidden-block">Declaring Command Objects </div></h4><p class="paragraph"/><div class="hidden-block">Command object classes are defined just like any other class.</div>
コマンドオブジェクトクラスは他の通常クラスと同じように設定します:<p class="paragraph"/><div class="code"><pre>@grails.validation.Validateable
class LoginCommand &#123;
    <span class="java&#45;object">String</span> username
    <span class="java&#45;object">String</span> password<p class="paragraph"/>    <span class="java&#45;keyword">static</span> constraints = &#123;
        username(blank: <span class="java&#45;keyword">false</span>, minSize: 6)
        password(blank: <span class="java&#45;keyword">false</span>, minSize: 6)
    &#125;
&#125;</pre></div><p class="paragraph"/>In this example, the command object is marked with the <code>Validateable</code> annotation. The <code>Validateable</code> annotation allows the definition of <a href="../guide/single.html#constraints" class="guide">constraints</a> just like in <a href="../guide/single.html#GORM" class="guide">domain classes</a>. If the command object is defined in the same source file as the controller that is using it, Grails will automatically mark it as <code>Validateable</code>. It is not required that command object classes be validateable.<p class="paragraph"/>
<h4>コマンドオブジェクトを使用する <div class="hidden-block">Using Command Objects </div></h4><p class="paragraph"/>To use command objects, controller actions may optionally specify any number of command object parameters. The parameter types must be supplied so that Grails knows what objects to create and initialize.<p class="paragraph"/>Before the controller action is executed Grails will automatically create an instance of the command object class and populate its properties by binding the request parameters.  If the command object class is marked with <code>Validateable</code> then the command object will be validated. For example:<p class="paragraph"/><div class="code"><pre>class LoginController &#123;<p class="paragraph"/>    def login(LoginCommand cmd) &#123;
        <span class="java&#45;keyword">if</span> (cmd.hasErrors()) &#123;
            redirect(action: 'loginForm')
            <span class="java&#45;keyword">return</span>
        &#125;<p class="paragraph"/>        // work with the command object data
    &#125;
&#125;</pre></div><p class="paragraph"/>If the command object's type is that of a domain class and there is an <code>id</code> request parameter then instead of invoking the domain class constructor to create a new instance a call will be made to the static <code>get</code> method on the domain class and the value of the <code>id</code> parameter will be passed as an argument.  Whatever is returned from that call to <code>get</code> is what will be passed into the controller action.  This means that if there is an <code>id</code> request parameter and no corresponding record is found in the database then the value of the command object will be <code>null</code>.<p class="paragraph"/><h4>コマンドオブジェクトと依存注入 <div class="hidden-block">Command Objects and Dependency Injection </div></h4><p class="paragraph"/><div class="hidden-block">Command objects can participate in dependency injection. This is useful if your command object has some custom validation logic which uses a Grails <a href="../guide/single.html#services" class="guide">service</a>:</div>
コマンドオブジェクトに依存注入をすることが可能です。Grailsの<a href="../guide/single.html#services" class="guide">サービス</a>を使用したカスタムバリデーションなどを使用する際に便利です:<p class="paragraph"/>
<div class="code"><pre>@grails.validation.Validateable
class LoginCommand &#123;<p class="paragraph"/>    def loginService<p class="paragraph"/>    <span class="java&#45;object">String</span> username
    <span class="java&#45;object">String</span> password<p class="paragraph"/>    <span class="java&#45;keyword">static</span> constraints = &#123;
        username validator: &#123; val, obj &#45;&#62;
            obj.loginService.canLogin(obj.username, obj.password)
        &#125;
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">In this example the command object interacts with the <code>loginService</code> bean which is injected by name from the Spring <code>ApplicationContext</code>.</div>
この例では、<code>loginService</code>をSpringの<code>ApplicatinContext</code>から名前解決でコマンドオブジェクトに注入しています。


<a name="7.1.11 Handling Duplicate Form Submissions"><!-- Legacy link --></a>
<h2 id="formtokens">7.1.11 フォーム二重送信のハンドリング</h2>
<div class="hidden-block">Grails has built-in support for handling duplicate form submissions using the "Synchronizer Token Pattern". To get started you define a token on the <a href="../ref/Tags/form.html" class="tags">form</a> tag:</div>
Grailsには、"同期トークンパターン"を使用した、フォーム二重送信ハンドリングをサポートしています。使用するには、先ずは<a href="../ref/Tags/form.html" class="tags">form</a>タグにuseToken属性を指定します:<p class="paragraph"/><p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:form useToken=<span class="xml&#45;quote">"true"</span> ...&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Then in your controller code you can use the <a href="../ref/Controllers/withForm.html" class="controllers">withForm</a> method to handle valid and invalid requests:</div>
そして、コントローラアクションで<a href="../ref/Controllers/withForm.html" class="controllers">withForm</a>メソッドを利用して、リクエストの有効・無効それぞれのコードを記述します:<p class="paragraph"/><div class="code"><pre>withForm &#123;
   // good request
&#125;.invalidToken &#123;
   // bad request
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">If you only provide the <a href="../ref/Controllers/withForm.html" class="controllers">withForm</a> method and not the chained <code>invalidToken</code> method then by default Grails will store the invalid token in a <code>flash.invalidToken</code> variable and redirect the request back to the original page. This can then be checked in the view:</div>
<a href="../ref/Controllers/withForm.html" class="controllers">withForm</a>メソッドのみを提供して<code>invalidToken</code>にチェインしなかった場合は、デフォルトでGrailsが無効トークンを<code>flash.invalidToken</code>に保持して、元のページにリクエストをリダイレクトします。これによってビューで以下のように確認できます:<p class="paragraph"/>
<div class="code"><pre><span class="xml&#45;tag">&#60;g:if test=<span class="xml&#45;quote">"$&#123;flash.invalidToken&#125;"</span>&#62;</span>
  Don't click the button twice!
<span class="xml&#45;tag">&#60;/g:if&#62;</span></pre></div><p class="paragraph"/><blockquote class="warning">
<div class="hidden-block">The <a href="../ref/Controllers/withForm.html" class="controllers">withForm</a> tag makes use of the <a href="../ref/Controllers/session.html" class="controllers">session</a> and hence requires session affinity or clustered sessions if used in a cluster.</div>
<a href="../ref/Controllers/withForm.html" class="controllers">withForm</a>メソッドはセッション(<a href="../ref/Controllers/session.html" class="controllers">session</a>)を使用するので、セッションの類似性またはクラスタで使用する場合はクラスタ化されたセッションが必要です。
</blockquote>


<a name="7.1.12 Simple Type Converters"><!-- Legacy link --></a>
<h2 id="typeConverters">7.1.12 シンプルタイプコンバータ</h2>
<h3>型変換メソッド <div class="hidden-block">Type Conversion Methods </div></h3><p class="paragraph"/><div class="hidden-block">If you prefer to avoid the overhead of <a href="../guide/single.html#dataBinding" class="guide">Data Binding</a> and simply want to convert incoming parameters (typically Strings) into another more appropriate type the <a href="../ref/Controllers/params.html" class="controllers">params</a> object has a number of convenience methods for each type:</div>
<a href="../guide/single.html#dataBinding" class="guide">データバインディング</a>でのオーバーヘッドを避けたい場合や、受信したパラメータに対して、単純な型変換行いたい場合、 <a href="../ref/Controllers/params.html" class="controllers">params</a>オブジェクトには、型によって幾つかの便利なメソッドが有ります:<p class="paragraph"/><div class="code"><pre>def total = params.<span class="java&#45;object">int</span>('total')</pre></div><p class="paragraph"/><div class="hidden-block">The above example uses the <code>int</code> method, and there are also methods for <code>boolean</code>, <code>long</code>, <code>char</code>, <code>short</code> and so on. Each of these methods is null-safe and safe from any parsing errors, so you don't have to perform any additional checks on the parameters.</div>
上記の例ではintメソッドを使用しています。ほかに、<code>boolean</code>,<code>long</code>,<code>char</code>,<code>short</code>等多数のメソッドがあります。これらのメソッドはnullセーフであり、パースエラーセーフなので、パラメータに対してのチェックを追加する必要がありません。<p class="paragraph"/>
<div class="hidden-block">Each of the conversion methods allows a default value to be passed as an optional second argument.  The default value will be returned if a corresponding entry cannot be found in the map or if an error occurs during the conversion.  Example:</div>
型変換メソッドの第二引数にデフォルト値を設定することができます。一致する入力が無い場合や、型変換でエラーが起きた場合に指定したデフォルト値が返されます:<p class="paragraph"/><div class="code"><pre>def total = params.<span class="java&#45;object">int</span>('total', 42)</pre></div><p class="paragraph"/><div class="hidden-block">These same type conversion methods are also available on the <code>attrs</code> parameter of GSP tags.</div>
GSPタグの<code>attrs</code>パラメータでも、同じ仕組みの型変換機能が使用できます。<p class="paragraph"/><h3>複数の同一名称パラメータのハンドリング <div class="hidden-block">Handling Multi Parameters </div></h3><p class="paragraph"/><div class="hidden-block">A common use case is dealing with multiple request parameters of the same name. For example you could get a query string such as <code>?name=Bob&#38;name=Judy</code>.</div>
よくあるケースとして、リクエストパラメータ内の複数の同じ名称を扱う場合があります。クエリーの例として、<code>"?name=Bob&#38;name=Judy"</code>等。<p class="paragraph"/><div class="hidden-block">In this case dealing with one parameter and dealing with many has different semantics since Groovy's iteration mechanics for <code>String</code> iterate over each character. To avoid this problem the <a href="../ref/Controllers/params.html" class="controllers">params</a> object provides a <code>list</code> method that always returns a list:</div>
パラメータに1つのみしか無い場合にイテレートしてしまうと、<code>String</code>の文字列が1文字ずつ参照されてしまいます。この問題を避けるために、<a href="../ref/Controllers/params.html" class="controllers">params</a>オブジェクトの<code>list</code>メソッドを使用することで毎回リストを返すことが可能です:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">for</span> (name in params.list('name')) &#123;
    println name
&#125;</pre></div>


<a name="7.2 Groovy Server Pages"><!-- Legacy link --></a>
<h2 id="gsp">7.2 Groovyサーバーページ</h2>
<div class="hidden-block">Groovy Servers Pages (or GSP for short) is Grails' view technology. It is designed to be familiar for users of technologies such as ASP and JSP, but to be far more flexible and intuitive.</div>
Groovy Server Pages(GSPと略す)は、Grailsのビュー技術です。より柔軟で直感的であり、ASPやJSPのような技術に精通しているユーザ向けに設計されています。<p class="paragraph"/>
<div class="hidden-block">GSPs live in the <code>grails-app/views</code> directory and are typically rendered automatically (by convention) or with the <a href="../ref/Controllers/render.html" class="controllers">render</a> method such as:</div>
GSPは、grails-app/viewsディレクトリに配置されていて、通常は自動的(慣習によって)または、以下のように<a href="../ref/Controllers/render.html" class="controllers">render</a>メソッドで描写します。<p class="paragraph"/><div class="code"><pre>render(view: <span class="java&#45;quote">"index"</span>)</pre></div><p class="paragraph"/><div class="hidden-block">A GSP is typically a mix of mark-up and GSP tags which aid in view rendering.</div>
GSPはマークアップとビュー描写を補助するGSPタグで内容が構成されています。<p class="paragraph"/><blockquote class="note">
<div class="hidden-block">Although it is possible to have Groovy logic embedded in your GSP and doing this will be covered in this document, the practice is strongly discouraged. Mixing mark-up and code is a <strong class="bold">bad</strong> thing and most GSP pages contain no code and needn't do so.</div>
GroovyロジックをGSPに埋め込むことも可能ですが推奨しません。マークアップとコードが混在するのは良いことではありません。ほとんどのGSPではコードを持つべきで無く、そうする必要がありません。
</blockquote><p class="paragraph"/><div class="hidden-block">A GSP typically has a "model" which is a set of variables that are used for view rendering. The model is passed to the GSP view from a controller. For example consider the following controller action:</div>
GSPは通常ビュー描写に使用される変数のセットなどの"モデル"を持っています。モデルはコントローラからGSPビューげ渡されます。例として次のコントローラアクションを見てみましょう。<p class="paragraph"/><div class="code"><pre>def show() &#123;
    &#91;book: Book.get(params.id)&#93;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">This action will look up a <code>Book</code> instance and create a model that contains a key called <code>book</code>. This key can then be referenced within the GSP view using the name <code>book</code>:</div>
このアクションは<code>Book</code>インスタンスを取り出して、<code>book</code>というキーでモデルを作成しています。GSPでは、このキー<code>book</code>が参照できます。<p class="paragraph"/><div class="code"><pre>$&#123;book.title&#125;</pre></div><p class="paragraph"/><blockquote class="warning">
Embedding data received from user input has the risk of making your application vulnerable to an Cross Site Scripting (XSS) attack. Please read the documentation on <a href="../guide/single.html#xssPrevention" class="guide">XSS prevention</a> for information on how to prevent XSS attacks.
</blockquote>

<a name="7.2.1 GSP Basics"><!-- Legacy link --></a>
<h2 id="GSPBasics">7.2.1 GSPの基本</h2>
<div class="hidden-block">In the next view sections we'll go through the basics of GSP and what is available to you. First off let's cover some basic syntax that users of JSP and ASP should be familiar with.</div>
ここのセクションでは、GSPで何が可能かの基礎を見ていきましょう。先ずはじめにJSPやASPのユーザに親和性の高い基本的なシンタックスをカバーしていきます。<p class="paragraph"/><div class="hidden-block">GSP supports the usage of <code>&#60;% %&#62;</code> scriptlet blocks to embed Groovy code (again this is discouraged):</div>
GSPは、Groovyを記述できる、スクリプトレットブロック<code>&#60;% %&#62;</code>をサポートしています。(しつこいですが推奨しません)<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;html&#62;</span>
   <span class="xml&#45;tag">&#60;body&#62;</span>
     <span class="xml&#45;tag">&#60;% out &#60;&#60; <span class="xml&#45;quote">"Hello GSP!"</span> %&#62;</span>
   <span class="xml&#45;tag">&#60;/body&#62;</span>
<span class="xml&#45;tag">&#60;/html&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">You can also use the <code>&#60;%= %&#62;</code> syntax to output values:</div>
もちろん<code>&#60;%= %&#62;</code>を使用して値を出力することもできます。<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;html&#62;</span>
   <span class="xml&#45;tag">&#60;body&#62;</span>
     <span class="xml&#45;tag">&#60;%=<span class="xml&#45;quote">"Hello GSP!"</span> %&#62;</span>
   <span class="xml&#45;tag">&#60;/body&#62;</span>
<span class="xml&#45;tag">&#60;/html&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">GSP also supports JSP-style server-side comments (which are not rendered in the HTML response) as the following example demonstrates:</div>
次のようなJSPスタイルのサーバサイドコメント(HTMLに出力されない)もサポートされています。<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;html&#62;</span>
   <span class="xml&#45;tag">&#60;body&#62;</span>
     <span class="xml&#45;tag">&#60;%&#45;&#45; This is my comment &#45;&#45;%&#62;</span>
     <span class="xml&#45;tag">&#60;%=<span class="xml&#45;quote">"Hello GSP!"</span> %&#62;</span>
   <span class="xml&#45;tag">&#60;/body&#62;</span>
<span class="xml&#45;tag">&#60;/html&#62;</span></pre></div><p class="paragraph"/><blockquote class="warning">
Embedding data received from user input has the risk of making your application vulnerable to an Cross Site Scripting (XSS) attack. Please read the documentation on <a href="../guide/single.html#xssPrevention" class="guide">XSS prevention</a> for information on how to prevent XSS attacks.
</blockquote>

<a name="6.6.3 Variables and Scopes"><!-- Legacy link --></a>
<h2 id="variablesAndScopes">7.2.1.1 変数とスコープ</h2>
<div class="hidden-block">Within the <code>&#60;% %&#62;</code> brackets you can declare variables:</div>
<code>&#60;% %&#62;</code>で変数を宣言できます。<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;% now = new Date() %&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">and then access those variables later in the page:</div>
宣言した変数はページ内でアクセスすることができます。<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;%=now%&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Within the scope of a GSP there are a number of pre-defined variables, including:</div>
GSPには、初期定義されたスコープ変数がいくつか存在します。<p class="paragraph"/><div class="hidden-block">
<ul class="star">
<li><code>application</code> - The <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/ServletContext.html" class="api">javax.servlet.ServletContext</a> instance</li>
<li><code>applicationContext</code> The Spring <a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/context/ApplicationContext.html" class="api">ApplicationContext</a> instance</li>
<li><code>flash</code> - The <a href="../ref/Controllers/flash.html" class="controllers">flash</a> object</li>
<li><code>grailsApplication</code> - The <a href="http://grails.org/doc/latest/api/org/codehaus/groovy/grails/commons/GrailsApplication.html" class="api">GrailsApplication</a> instance</li>
<li><code>out</code> - The response writer for writing to the output stream</li>
<li><code>params</code> - The <a href="../ref/Controllers/params.html" class="controllers">params</a> object for retrieving request parameters</li>
<li><code>request</code> - The <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpServletRequest.html" class="api">HttpServletRequest</a> instance</li>
<li><code>response</code> - The <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpServletResponse.html" class="api">HttpServletResponse</a> instance</li>
<li><code>session</code> - The <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpSession.html" class="api">HttpSession</a> instance</li>
<li><code>webRequest</code> - The <a href="http://grails.org/doc/latest/api/org/codehaus/groovy/grails/web/servlet/mvc/GrailsWebRequest.html" class="api">GrailsWebRequest</a> instance</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li><code>application</code> - <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/ServletContext.html" class="api">javax.servlet.ServletContext</a>インスタンス</li>
<li><code>applicationContext</code> - Spring <a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/context/ApplicationContext.html" class="api">ApplicationContext</a>インスタンス</li>
<li><code>flash</code> - flash オブジェクト</li>
<li><code>grailsApplication</code> - <a href="http://grails.org/doc/latest/api/org/codehaus/groovy/grails/commons/GrailsApplication.html" class="api">GrailsApplication</a>インスタンス</li>
<li><code>out</code> - 出力ストリームを書き込むレスポンスライター</li>
<li><code>params</code> - <a href="../ref/Controllers/params.html" class="controllers">params</a>リクエストパラメータを取得するオブジェクト</li>
<li><code>request</code> - <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpServletRequest.html" class="api">HttpServletRequest</a>インスタンス</li>
<li><code>response</code> - <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpServletResponse.html" class="api">HttpServletResponse</a>インスタンス</li>
<li><code>session</code> - <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpSession.html" class="api">HttpSession</a>インスタンス</li>
<li><code>webRequest</code> - <a href="http://grails.org/doc/latest/api/org/codehaus/groovy/grails/web/servlet/mvc/GrailsWebRequest.html" class="api">GrailsWebRequest</a>インスタンス</li>
</ul><p class="paragraph"/>

<a name="7.2.2.2 Logic and Iteration"><!-- Legacy link --></a>
<h2 id="logicAndIteration">7.2.1.2 ロジックとイテレーション</h2>
<div class="hidden-block">Using the <code>&#60;% %&#62;</code> syntax you can embed loops and so on using this syntax:</div>
以下のように<code>&#60;% %&#62;</code>シンタックスを使ってループなどを記述できます。<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;html&#62;</span>
   <span class="xml&#45;tag">&#60;body&#62;</span>
      <span class="xml&#45;tag">&#60;% &#91;1,2,3,4&#93;.each &#123; num &#45;&#62;</span> %&#62;
         <span class="xml&#45;tag">&#60;p&#62;</span><span class="xml&#45;tag">&#60;%=<span class="xml&#45;quote">"Hello $&#123;num&#125;!"</span> %&#62;</span><span class="xml&#45;tag">&#60;/p&#62;</span>
      <span class="xml&#45;tag">&#60;%&#125;%&#62;</span>
   <span class="xml&#45;tag">&#60;/body&#62;</span>
<span class="xml&#45;tag">&#60;/html&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">As well as logical branching:</div>
また他に分岐も<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;html&#62;</span>
   <span class="xml&#45;tag">&#60;body&#62;</span>
      <span class="xml&#45;tag">&#60;% if (params.hello == 'true')%&#62;</span>
      <span class="xml&#45;tag">&#60;%=<span class="xml&#45;quote">"Hello!"</span>%&#62;</span>
      <span class="xml&#45;tag">&#60;% else %&#62;</span>
      <span class="xml&#45;tag">&#60;%=<span class="xml&#45;quote">"Goodbye!"</span>%&#62;</span>
   <span class="xml&#45;tag">&#60;/body&#62;</span>
<span class="xml&#45;tag">&#60;/html&#62;</span></pre></div>


<a name="7.2.1.3 Page Directives"><!-- Legacy link --></a>
<h2 id="pageDirectives">7.2.1.3 ページディレクティブ</h2>
<div class="hidden-block">GSP also supports a few JSP-style page directives.</div>
GSPはJSPのページディレクティブの一部をサポートしています。<p class="paragraph"/><div class="hidden-block">The import directive lets you import classes into the page. However, it is rarely needed due to Groovy's default imports and <a href="../guide/single.html#tags" class="guide">GSP Tags</a>:</div>
importディレクティブは、ページにクラスをインポートします。<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;%@ page import=<span class="xml&#45;quote">"java.awt.&#42;"</span> %&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">GSP also supports the contentType directive:</div>
contentTypeディレクティブもサポートしています。<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;%@ page contentType=<span class="xml&#45;quote">"text/json"</span> %&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">The contentType directive allows using GSP to render other formats.</div>
contentTypeディレクティブはGSPを別のフォーマットを可能にします。


<a name="7.2.1.4 Expressions"><!-- Legacy link --></a>
<h2 id="expressions">7.2.1.4 エクスプレッション</h2>
<div class="hidden-block">In GSP the <code>&#60;%= %&#62;</code> syntax introduced earlier is rarely used due to the support for GSP expressions. A GSP expression is similar to a JSP EL expression or a Groovy GString and takes the form <code>${expr}</code>:</div>
GSPでは、先に紹介した<code>&#60;%= %&#62;</code>シンタックスは滅多に使用しません。代わりに、JSPの式言語(JSP EL)と同じような機能をもつGSP(Groovy)表記または、<code>${expr}</code>のようなGroovyのGStringを使用します。<p class="paragraph"/>
<div class="code"><pre><span class="xml&#45;tag">&#60;html&#62;</span>
  <span class="xml&#45;tag">&#60;body&#62;</span>
    Hello $&#123;params.name&#125;
  <span class="xml&#45;tag">&#60;/body&#62;</span>
<span class="xml&#45;tag">&#60;/html&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">However, unlike JSP EL you can have any Groovy expression within the <code>${..}</code> block. </div>
JSP式言語(JSP EL)と違い、Groovy表記は、 <code>${…}</code> ブロックに記述します。<p class="paragraph"/><blockquote class="warning">
Embedding data received from user input has the risk of making your application vulnerable to an Cross Site Scripting (XSS) attack. Please read the documentation on <a href="../guide/single.html#xssPrevention" class="guide">XSS prevention</a> for information on how to prevent XSS attacks.
</blockquote><p class="paragraph"/>

<a name="7.2.2 GSP Tags"><!-- Legacy link --></a>
<h2 id="tags">7.2.2 GSPタグ</h2>
<div class="hidden-block">Now that the less attractive JSP heritage has been set aside, the following sections cover GSP's built-in tags, which are the preferred way to define GSP pages.</div>
魅力の低い遺産JSPはさておき、このセクションではGSPの組込タグを、GSPページでどのように活用すると良いか解説していきます。<p class="paragraph"/>
<blockquote class="note">
<div class="hidden-block">The section on <a href="../guide/single.html#taglibs" class="guide">Tag Libraries</a> covers how to add your own custom tag libraries.</div>
カスタムタグの追加などは、<a href="../guide/single.html#taglibs" class="guide">タグライブラリ</a>のセクションで解説します。
</blockquote><p class="paragraph"/><div class="hidden-block">All built-in GSP tags start with the prefix <code>g:</code>. Unlike JSP, you don't specify any tag library imports. If a tag starts with <code>g:</code> it is automatically assumed to be a GSP tag. An example GSP tag would look like:</div>
全ての組込GSPタグは接頭辞<code>g:</code>で始まるタグです。JSPと違いタグライブラリのインポートが必要有りません。<code>g:</code>接頭辞のタグは自動的にGSPタグとして用いられます。例としてGSPタグの見ためは次のようになります:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:example /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">GSP tags can also have a body such as:</div>
GSPタグの内容も記述できます:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:example&#62;</span>
   Hello world
<span class="xml&#45;tag">&#60;/g:example&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Expressions can be passed into GSP tag attributes, if an expression is not used it will be assumed to be a String value:</div>
GSPのタグ属性にエクスプレッションを記述できます。エクスプレッションを使用しない場合は文字列として値が用いられます。:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:example attr=<span class="xml&#45;quote">"$&#123;new Date()&#125;"</span>&#62;</span>
   Hello world
<span class="xml&#45;tag">&#60;/g:example&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Maps can also be passed into GSP tag attributes, which are often used for a named parameter style syntax:</div>
GSPのタグ属性に、ひんぱんに使用する名前付きパラメータ構文として、Map型を記述できます:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:example attr=<span class="xml&#45;quote">"$&#123;new Date()&#125;"</span> attr2=<span class="xml&#45;quote">"&#91;one:1, two:2, three:3&#93;"</span>&#62;</span>
   Hello world
<span class="xml&#45;tag">&#60;/g:example&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Note that within the values of attributes you must use single quotes for Strings:</div>
属性内での、Mapの文字列値はシングルクォートを使用してください:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:example attr=<span class="xml&#45;quote">"$&#123;new Date()&#125;"</span> attr2=<span class="xml&#45;quote">"&#91;one:'one', two:'two'&#93;"</span>&#62;</span>
   Hello world
<span class="xml&#45;tag">&#60;/g:example&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">With the basic syntax out the way, the next sections look at the tags that are built into Grails by default.</div>
ここまでで基本構文は全てです。次のセクションではどのようなタグがGrailsにデフォルトで組み込まれているか見ていきましょう。



<h2 id="tagVariablesAndScopes">7.2.2.1 変数とスコープ</h2>
<div class="hidden-block">Variables can be defined within a GSP using the <a href="../ref/Tags/set.html" class="tags">set</a> tag:</div>
GSPでは変数を<a href="../ref/Tags/set.html" class="tags">set</a>タグで定義することができます:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:set var=<span class="xml&#45;quote">"now"</span> value=<span class="xml&#45;quote">"$&#123;new Date()&#125;"</span> /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Here we assign a variable called <code>now</code> to the result of a GSP expression (which simply constructs a new <code>java.util.Date</code> instance). You can also use the body of the <code>&#60;g:set&#62;</code> tag to define a variable:</div>
この例では変数<code>now</code>にGSP表記の結果を割り当てています(単純に<code>java.util.Date</code>のインスタンスを生成しただけです)。<code>&#60;g:set&#62;</code>タグのタグ内容に記述して定義することもできます。:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:set var=<span class="xml&#45;quote">"myHTML"</span>&#62;</span>
   Some re&#45;usable code on: $&#123;new Date()&#125;
<span class="xml&#45;tag">&#60;/g:set&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">The assigned value can also be a bean from the applicationContext:</div>
applicationContextにあるビーンを変数定義することも可能です。
<div class="code"><pre><span class="xml&#45;tag">&#60;g:set var=<span class="xml&#45;quote">"bookService"</span> bean=<span class="xml&#45;quote">"bookService"</span> /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Variables can also be placed in one of the following scopes:</div>
変数は以下のいずれかのスコープに定義することができます:
<div class="hidden-block">
<ul class="star">
<li><code>page</code> - Scoped to the current page (default)</li>
<li><code>request</code> - Scoped to the current request</li>
<li><code>flash</code> - Placed within <a href="../ref/Controllers/flash.html" class="controllers">flash</a> scope and hence available for the next request</li>
<li><code>session</code> - Scoped for the user session</li>
<li><code>application</code> - Application-wide scope.</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li><code>page</code> - (デフォルト)現在のページ</li>
<li><code>request</code> - 現在のリクエスト</li>
<li><code>flash</code> - <a href="../ref/Controllers/flash.html" class="controllers">flash</a>スコープに配置され、次のリクエストまで。</li>
<li><code>session</code> - ユーザのセッション</li>
<li><code>application</code> - アプリケーション全体</li>
</ul><p class="paragraph"/><div class="hidden-block">To specify the scope, use the <code>scope</code> attribute:</div>
スコープの定義は、<code>scope</code>属性に指定します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:set var=<span class="xml&#45;quote">"now"</span> value=<span class="xml&#45;quote">"$&#123;new Date()&#125;"</span> scope=<span class="xml&#45;quote">"request"</span> /&#62;</span></pre></div>



<h2 id="tagLogicAndIteration">7.2.2.2 ロジックとイテレーション</h2>
<div class="hidden-block">GSP also supports logical and iterative tags out of the box. For logic there are <a href="../ref/Tags/if.html" class="tags">if</a>, <a href="../ref/Tags/else.html" class="tags">else</a> and <a href="../ref/Tags/elseif.html" class="tags">elseif</a> tags for use with branching:</div>
GSPにはすぐに活用できるロジックタグとイテレーションタグがあります。ロジックタグは分岐に使用する<a href="../ref/Tags/if.html" class="tags">if</a>, <a href="../ref/Tags/else.html" class="tags">else</a>, <a href="../ref/Tags/elseif.html" class="tags">elseif</a>です:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:if test=<span class="xml&#45;quote">"$&#123;session.role == 'admin'&#125;"</span>&#62;</span>
   <span class="xml&#45;tag">&#60;%&#45;&#45; show administrative functions &#45;&#45;%&#62;</span>
<span class="xml&#45;tag">&#60;/g:if&#62;</span>
<span class="xml&#45;tag">&#60;g:else&#62;</span>
   <span class="xml&#45;tag">&#60;%&#45;&#45; show basic functions &#45;&#45;%&#62;</span>
<span class="xml&#45;tag">&#60;/g:else&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Use the <a href="../ref/Tags/each.html" class="tags">each</a> and <a href="../ref/Tags/while.html" class="tags">while</a> tags for iteration:</div>
イテレーションには<a href="../ref/Tags/each.html" class="tags">each</a>タグと<a href="../ref/Tags/while.html" class="tags">while</a>タグを使用します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:each in=<span class="xml&#45;quote">"$&#123;&#91;1,2,3&#93;&#125;"</span> var=<span class="xml&#45;quote">"num"</span>&#62;</span>
   <span class="xml&#45;tag">&#60;p&#62;</span>Number $&#123;num&#125;<span class="xml&#45;tag">&#60;/p&#62;</span>
<span class="xml&#45;tag">&#60;/g:each&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;g:set var=<span class="xml&#45;quote">"num"</span> value=<span class="xml&#45;quote">"$&#123;1&#125;"</span> /&#62;</span>
<span class="xml&#45;tag">&#60;g:while test=<span class="xml&#45;quote">"$&#123;num &#60; 5 &#125;"</span>&#62;</span>
    <span class="xml&#45;tag">&#60;p&#62;</span>Number $&#123;num++&#125;<span class="xml&#45;tag">&#60;/p&#62;</span>
<span class="xml&#45;tag">&#60;/g:while&#62;</span></pre></div>


<a name="7.2.2.3 Search and Filtering"><!-- Legacy link --></a>
<h2 id="searchAndFiltering">7.2.2.3 検索とフィルタリング</h2>
<div class="hidden-block">If you have collections of objects you often need to sort and filter them. Use the <a href="../ref/Tags/findAll.html" class="tags">findAll</a> and <a href="../ref/Tags/grep.html" class="tags">grep</a> tags for these tasks:</div>
オブジェクトのコレクションを扱う場合はソート、フィルタリングが必要になります。その場合は <a href="../ref/Tags/findAll.html" class="tags">findAll</a>タグと<a href="../ref/Tags/grep.html" class="tags">grep</a>タグが活用できます:<p class="paragraph"/><div class="code"><pre>Stephen King's Books:
<span class="xml&#45;tag">&#60;g:findAll in=<span class="xml&#45;quote">"$&#123;books&#125;"</span> expr=<span class="xml&#45;quote">"it.author == 'Stephen King'"</span>&#62;</span>
     <span class="xml&#45;tag">&#60;p&#62;</span>Title: $&#123;it.title&#125;<span class="xml&#45;tag">&#60;/p&#62;</span>
<span class="xml&#45;tag">&#60;/g:findAll&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">The <code>expr</code> attribute contains a Groovy expression that can be used as a filter. The <a href="../ref/Tags/grep.html" class="tags">grep</a> tag does a similar job, for example filtering by class:</div>
フィルターとして使うGroovy式を<code>expr</code>属性に記述します。<a href="../ref/Tags/grep.html" class="tags">grep</a>タグも同じような動作をします。クラスでのフィルタリングを例とすると:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:grep in=<span class="xml&#45;quote">"$&#123;books&#125;"</span> filter=<span class="xml&#45;quote">"NonFictionBooks.class"</span>&#62;</span>
     <span class="xml&#45;tag">&#60;p&#62;</span>Title: $&#123;it.title&#125;<span class="xml&#45;tag">&#60;/p&#62;</span>
<span class="xml&#45;tag">&#60;/g:grep&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Or using a regular expression:</div>
正規表現を使用した例:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:grep in=<span class="xml&#45;quote">"$&#123;books.title&#125;"</span> filter=<span class="xml&#45;quote">"~/.&#42;?Groovy.&#42;?/"</span>&#62;</span>
     <span class="xml&#45;tag">&#60;p&#62;</span>Title: $&#123;it&#125;<span class="xml&#45;tag">&#60;/p&#62;</span>
<span class="xml&#45;tag">&#60;/g:grep&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">The above example is also interesting due to its usage of GPath. GPath is an XPath-like language in Groovy. The <code>books</code> variable is a collection of <code>Book</code> instances. Since each <code>Book</code> has a <code>title</code>, you can obtain a list of Book titles using the expression <code>books.title</code>. Groovy will auto-magically iterate the collection, obtain each title, and return a new list!</div>
上記の例ではGPathも使用方法も紹介されています。GPathはGroovyでのXpathのような言語です。変数<code>books</code>は<code>Book</code>インスタンスのコレクションです。全ての<code>Book</code>にプロパティ<code>title</code>が有る場合、<code>books.title</code>とすることで<code>Book</code>の<code>title</code>プロパティのリストを得られます。Groovyは自動的にコレクションを検索して全ての<code>title</code>を含んだリストを返してくれます。


<a name="7.2.2.4 Links and Resources"><!-- Legacy link --></a>
<h2 id="linksAndResources">7.2.2.4 リンクとリソース</h2>
<div class="hidden-block">GSP also features tags to help you manage linking to controllers and actions. The <a href="../ref/Tags/link.html" class="tags">link</a> tag lets you specify controller and action name pairing and it will automatically work out the link based on the <a href="../guide/single.html#urlmappings" class="guide">URL Mappings</a>, even if you change them! For example:</div>
コントローラとアクションでのリンクを操作するGSPタグがあります。<a href="../ref/Tags/link.html" class="tags">link</a>タグはコントローラとアクション名を指定するだけで<a href="../guide/single.html#urlmappings" class="guide">URLマッピング</a>をベースとしたリンクを自動的に生成します(<a href="../guide/single.html#urlmappings" class="guide">URLマッピング</a>で変更をしても)。:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:link action=<span class="xml&#45;quote">"show"</span> id=<span class="xml&#45;quote">"1"</span>&#62;</span>Book 1<span class="xml&#45;tag">&#60;/g:link&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;g:link action=<span class="xml&#45;quote">"show"</span> id=<span class="xml&#45;quote">"$&#123;currentBook.id&#125;"</span>&#62;</span>$&#123;currentBook.name&#125;<span class="xml&#45;tag">&#60;/g:link&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;g:link controller=<span class="xml&#45;quote">"book"</span>&#62;</span>Book Home<span class="xml&#45;tag">&#60;/g:link&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;g:link controller=<span class="xml&#45;quote">"book"</span> action=<span class="xml&#45;quote">"list"</span>&#62;</span>Book List<span class="xml&#45;tag">&#60;/g:link&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;g:link url=<span class="xml&#45;quote">"&#91;action: 'list', controller: 'book'&#93;"</span>&#62;</span>Book List<span class="xml&#45;tag">&#60;/g:link&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;g:link params=<span class="xml&#45;quote">"&#91;sort: 'title', order: 'asc', author: currentBook.author&#93;"</span>
        action=<span class="xml&#45;quote">"list"</span>&#62;</span>Book List<span class="xml&#45;tag">&#60;/g:link&#62;</span></pre></div>


<a name="7.2.2.5 Forms and Fields"><!-- Legacy link --></a>
<h2 id="formsAndFields">7.2.2.5 フォームとフィールド</h2>
<h4>フォームの基礎 <div class="hidden-block">Form Basics </div></h4><p class="paragraph"/><div class="hidden-block">GSP supports many different tags for working with HTML forms and fields, the most basic of which is the <a href="../ref/Tags/form.html" class="tags">form</a> tag. This is a controller/action aware version of the regular HTML form tag. The <code>url</code> attribute lets you specify which controller and action to map to:</div>
GSPではHTMLのフォームとフィールドに対応した様々なタグをサポートしています。フォーム・フィールドの基礎となるタグはformタグです。<a href="../ref/Tags/form.html" class="tags">form</a>タグは、通常のHTML formタグが、コントローラ・アクションを意識してる版みたいな物です。次のように、<code>url</code>属性にマップでコントローラアクションを指定します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:form name=<span class="xml&#45;quote">"myForm"</span> url=<span class="xml&#45;quote">"&#91;controller:'book',action:'list'&#93;"</span>&#62;</span>...<span class="xml&#45;tag">&#60;/g:form&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">In this case we create a form called <code>myForm</code> that submits to the <code>BookController</code>'s <code>list</code> action. Beyond that all of the usual HTML attributes apply.</div>
この例では、<code>myForm</code>という名称で、<code>BookController</code>の<code>list</code>アクションへ送信するフォームを生成します。通常のHTML属性はそのまま使用できます。<p class="paragraph"/><h4>フォームフィールド <div class="hidden-block">Form Fields </div></h4><p class="paragraph"/><div class="hidden-block">In addition to easy construction of forms, GSP supports custom tags for dealing with different types of fields, including:</div>
フォームを簡単に作成するために、GSPでは多数種類のフィールドタグをサポートしています:<p class="paragraph"/><div class="hidden-block">
<ul class="star">
<li><a href="../ref/Tags/textField.html" class="tags">textField</a> - For input fields of type 'text'</li>
<li><a href="../ref/Tags/passwordField.html" class="tags">passwordField</a> - For input fields of type 'password'</li>
<li><a href="../ref/Tags/checkBox.html" class="tags">checkBox</a> - For input fields of type 'checkbox'</li>
<li><a href="../ref/Tags/radio.html" class="tags">radio</a> - For input fields of type 'radio'</li>
<li><a href="../ref/Tags/hiddenField.html" class="tags">hiddenField</a> - For input fields of type 'hidden'</li>
<li><a href="../ref/Tags/select.html" class="tags">select</a> - For dealing with HTML select boxes</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li><a href="../ref/Tags/textField.html" class="tags">textField</a> - 属性typeが'text'のinputタグ用</li>
<li><a href="../ref/Tags/passwordField.html" class="tags">passwordField</a> -  属性typeが'password'のinputタグ用</li>
<li><a href="../ref/Tags/checkBox.html" class="tags">checkBox</a> -  属性typeが'checkbox'のinputタグ用</li>
<li><a href="../ref/Tags/radio.html" class="tags">radio</a> -  属性typeが'radio'のinputタグ用</li>
<li><a href="../ref/Tags/hiddenField.html" class="tags">hiddenField</a> -  属性typeが'hidden'のinputタグ用</li>
<li><a href="../ref/Tags/select.html" class="tags">select</a> - セレクトボックス用タグ</li>
</ul><p class="paragraph"/><div class="hidden-block">Each of these allows GSP expressions for the value:</div>
value属性の値にGSPエクスプレッションを使用できます:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:textField name=<span class="xml&#45;quote">"myField"</span> value=<span class="xml&#45;quote">"$&#123;myValue&#125;"</span> /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">GSP also contains extended helper versions of the above tags such as <a href="../ref/Tags/radioGroup.html" class="tags">radioGroup</a> (for creating groups of <a href="../ref/Tags/radio.html" class="tags">radio</a> tags), <a href="../ref/Tags/localeSelect.html" class="tags">localeSelect</a>, <a href="../ref/Tags/currencySelect.html" class="tags">currencySelect</a> and <a href="../ref/Tags/timeZoneSelect.html" class="tags">timeZoneSelect</a> (for selecting locales, currencies and time zones respectively).</div>
そのほかに、これらのタグを拡張した、<a href="../ref/Tags/radioGroup.html" class="tags">radioGroup</a>(<a href="../ref/Tags/radio.html" class="tags">radio</a>タグのセットを作成)タグや、<a href="../ref/Tags/localeSelect.html" class="tags">localeSelect</a>、<a href="../ref/Tags/currencySelect.html" class="tags">currencySelect</a>、<a href="../ref/Tags/timeZoneSelect.html" class="tags">timeZoneSelect</a>等、それぞれ、ロケール、通貨、タイムゾーンに対応したタグもあります。<p class="paragraph"/><h4>マルチ送信ボタン <div class="hidden-block">Multiple Submit Buttons </div></h4><p class="paragraph"/><div class="hidden-block">The age old problem of dealing with multiple submit buttons is also handled elegantly with Grails using the <a href="../ref/Tags/actionSubmit.html" class="tags">actionSubmit</a> tag. It is just like a regular submit, but lets you specify an alternative action to submit to:</div>
Grailsでは、<a href="../ref/Tags/actionSubmit.html" class="tags">actionSubmit</a>タグを使用することで、マルチ送信ボタン対応は、すっきりと実装できます。単純な送信ボタンのように見えますが、action属性にアクションを指定すると、指定したアクションへフォームが送信されるようになります。<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:actionSubmit value=<span class="xml&#45;quote">"Some update label"</span> action=<span class="xml&#45;quote">"update"</span> /&#62;</span></pre></div>


<a name="7.2.2.6 Tags as Method Calls"><!-- Legacy link --></a>
<h2 id="tagsAsMethodCalls">7.2.2.6 タグをメソッドとして使用</h2>
<div class="hidden-block">One major different between GSP tags and other tagging technologies is that GSP tags can be called as either regular tags or as method calls from <a href="../guide/single.html#controllers" class="guide">controllers</a>, <a href="../guide/single.html#taglibs" class="guide">tag libraries</a> or GSP views.</div>
GSPタグと他のタグ技術との大きな違いは、通常のタグとしての利用だけではなく、<a href="../guide/single.html#controllers" class="guide">コントローラ</a>、<a href="../guide/single.html#taglibs" class="guide">タグライブラリ</a>またはGSPビューから、メソッドとして呼び出せるという点です。<p class="paragraph"/><h4>GSPでタグをメソッドとして使用する <div class="hidden-block">Tags as method calls from GSPs </div></h4><p class="paragraph"/><div class="hidden-block">Tags return their results as a String-like object (a <code>StreamCharBuffer</code> which has all of the same methods as String) instead of writing directly to the response when called as methods. For example:</div>
タグをメソッドとして使用すると、結果をレスポンスへ出力する代わりに、文字列のようなオブジェクトで返します(Stringと同じメソッドを持つ<code>StreamCharBuffer</code>)。:<p class="paragraph"/><div class="code"><pre>Static Resource: $&#123;createLinkTo(dir: <span class="xml&#45;quote">"images"</span>, file: <span class="xml&#45;quote">"logo.jpg"</span>)&#125;</pre></div><p class="paragraph"/><div class="hidden-block">This is particularly useful for using a tag within an attribute:</div>
タグの属性内に使用する際などに特に便利です:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;img src=<span class="xml&#45;quote">"$&#123;createLinkTo(dir: 'images', file: 'logo.jpg')&#125;"</span> /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">In view technologies that don't support this feature you have to nest tags within tags, which becomes messy quickly and often has an adverse effect of WYSWIG tools such as Dreamweaver that attempt to render the mark-up as it is not well-formed:</div>
以下の例のように、このような機能をもたないタグ技術は、タグをネストしないといけません。これだとすぐにコードは乱雑になり、Dreamweaver等のツールでの表示が正常になりません:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;img src=<span class="xml&#45;quote">"&#60;g:createLinkTo dir="</span>images<span class="xml&#45;quote">" file="</span>logo.jpg<span class="xml&#45;quote">" /&#62;</span>"</span> /&#62;</pre></div><p class="paragraph"/><h4>コントローラとタグライブラリでタグをメソッドとして使用する <div class="hidden-block">Tags as method calls from Controllers and Tag Libraries </div></h4><p class="paragraph"/><div class="hidden-block">You can also invoke tags from controllers and tag libraries. Tags within the default <code>g:</code> <a href="../guide/single.html#namespaces" class="guide">namespace</a> can be invoked without the prefix and a <code>StreamCharBuffer</code> result is returned:</div>
コントローラとタブライブラリ(実装側)で、タグを呼び出す事が可能です。デフォルトの<a href="../guide/single.html#namespaces" class="guide">ネームスペース</a><code>g:</code>を持つタグは、接頭辞無しで呼び出す事で、結果に<code>StreamCharBuffer</code>を返します:<p class="paragraph"/><div class="code"><pre>def imageLocation = createLinkTo(dir:<span class="java&#45;quote">"images"</span>, file:<span class="java&#45;quote">"logo.jpg"</span>).toString()</pre></div><p class="paragraph"/><div class="hidden-block">Prefix the namespace to avoid naming conflicts:</div>
名前の衝突を避けるために、ネームスペースを接頭辞とする場合は:<p class="paragraph"/><div class="code"><pre>def imageLocation = g.createLinkTo(dir:<span class="java&#45;quote">"images"</span>, file:<span class="java&#45;quote">"logo.jpg"</span>).toString()</pre></div><p class="paragraph"/><div class="hidden-block">For tags that use a <a href="../guide/single.html#namespaces" class="guide">custom namespace</a>, use that prefix for the method call. For example (from the <a href="http://grails.org/plugin/fckeditor" target="blank">FCK Editor plugin</a>):</div>
カスタムネームスペースを使用しているタグの場合は、<a href="../guide/single.html#namespaces" class="guide">カスタムネームスペース</a>を接頭辞として使います。<a href="http://grails.org/plugin/fckeditor" target="blank">FCKエディタープラグイン</a>を例とすると:<p class="paragraph"/><div class="code"><pre>def editor = fckeditor.editor(name: <span class="java&#45;quote">"text"</span>, width: <span class="java&#45;quote">"100%"</span>, height: <span class="java&#45;quote">"400"</span>)</pre></div>


<a name="7.2.3 Views and Templates"><!-- Legacy link --></a>
<h2 id="viewsAndTemplates">7.2.3 ビューとテンプレート</h2>
<div class="hidden-block">Grails also has the concept of templates. These are useful for partitioning your views into maintainable chunks, and combined with <a href="../guide/single.html#layouts" class="guide">Layouts</a> provide a highly re-usable mechanism for structured views.</div>
Grailsもテンプレートの概念を持っています。ビューを管理しやすいかたまりに分類して<a href="../guide/single.html#layouts" class="guide">レイアウト</a>機能で結合する際に活用できます。<p class="paragraph"/><h4>テンプレートの基礎 <div class="hidden-block">Template Basics </div></h4><p class="paragraph"/><div class="hidden-block">Grails uses the convention of placing an underscore before the name of a view to identify it as a template. For example, you might have a template that renders Books located at <code>grails-app/views/book/_bookTemplate.gsp</code>:</div>
Grailsでは、アンダースコアがビュー名称の前にあるとテンプレートとして認識するルールがあります。例として、Bookコントローラからbookを描写するテンプレートは<code>grails-app/views/books/</code>に <code>_bookTemplate.gsp</code>として配置:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;div class=<span class="xml&#45;quote">"book"</span> id=<span class="xml&#45;quote">"$&#123;book?.id&#125;"</span>&#62;</span>
   <span class="xml&#45;tag">&#60;div&#62;</span>Title: $&#123;book?.title&#125;<span class="xml&#45;tag">&#60;/div&#62;</span>
   <span class="xml&#45;tag">&#60;div&#62;</span>Author: $&#123;book?.author?.name&#125;<span class="xml&#45;tag">&#60;/div&#62;</span>
<span class="xml&#45;tag">&#60;/div&#62;</span></pre></div><p class="paragraph"/>Use the <a href="../ref/Tags/render.html" class="tags">render</a> tag to render this template from one of the views in <code>grails-app/views/book</code>:
<code>grails-app/views/book</code>の配置したビューで、テンプレートを使用するには、<a href="../ref/Tags/render.html" class="tags">render</a>タグを使います:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:render template=<span class="xml&#45;quote">"bookTemplate"</span> model=<span class="xml&#45;quote">"&#91;book: myBook&#93;"</span> /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Notice how we pass into a model to use using the <code>model</code> attribute of the <code>render</code> tag. If you have multiple <code>Book</code> instances you can also render the template for each <code>Book</code> using the render tag with a <code>collection</code> attribute:</div>
この例のrenderタグのmodel属性を使用してモデルをテンプレートに渡している部分に注目してください。もし複数の<code>Book</code>インスタンスを使用して、それぞれの<code>Book</code>をテンプレートで描写する場合は、以下のように<code>render</code>タグの<code>collection</code>属性にコレクションを指定します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:render template=<span class="xml&#45;quote">"bookTemplate"</span> var=<span class="xml&#45;quote">"book"</span> collection=<span class="xml&#45;quote">"$&#123;bookList&#125;"</span> /&#62;</span></pre></div><p class="paragraph"/><h4>テンプレートの共有 <div class="hidden-block">Shared Templates </div></h4><p class="paragraph"/><div class="hidden-block">In the previous example we had a template that was specific to the <code>BookController</code> and its views at <code>grails-app/views/book</code>. However, you may want to share templates across your application.</div>
前の例では<code>BookController</code>と<code>grails-app/views/book</code>階層以下のビューを対象に説明しました。テンプレートはアプリケーション全体を通して使用したいと思います。<p class="paragraph"/><div class="hidden-block">In this case you can place them in the root views directory at grails-app/views or any subdirectory below that location, and then with the template attribute use an absolute location starting with <code>/</code> instead of a relative location. For example if you had a template called <code>grails-app/views/shared/_mySharedTemplate.gsp</code>, you would reference it as:</div>
このケースでは、ビューのルートディレクトリである grails-app/views、あるいはルートディレクトのサブディレクトリにテンプレートファイルを配置して、template属性には、<code>/(スラッシュ)</code>から始まる grails-app/viewsからの絶対パスで指定します。例として、テンプレートファイルが、<code>grails-app/views/shared/_mySharedTemplate.gsp</code>だとした場合は次のように指定します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:render template=<span class="xml&#45;quote">"/shared/mySharedTemplate"</span> /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">You can also use this technique to reference templates in any directory from any view or controller:</div>
この方法では、どこにテンプレートが配置されていても、どのビューまたはコントローラからでもテンプレートが使用できます:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:render template=<span class="xml&#45;quote">"/book/bookTemplate"</span> model=<span class="xml&#45;quote">"&#91;book: myBook&#93;"</span> /&#62;</span></pre></div><p class="paragraph"/><h4>テンプレートネームスペース <div class="hidden-block">The Template Namespace </div></h4><p class="paragraph"/><div class="hidden-block">Since templates are used so frequently there is template namespace, called <code>tmpl</code>, available that makes using templates easier. Consider for example the following usage pattern:</div>
テンプレートを多用する場合は、テンプレートを簡単に使用するための<code>tmpl</code>という名称の、テンプレートネームスペースが使用できます:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:render template=<span class="xml&#45;quote">"bookTemplate"</span> model=<span class="xml&#45;quote">"&#91;book:myBook&#93;"</span> /&#62;</span></pre></div><p class="paragraph"/>This can be expressed with the <code>tmpl</code> namespace as follows:
上記の例を<code>tmpl</code>ネームスペースで記述すると以下のようになります:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;tmpl:bookTemplate book=<span class="xml&#45;quote">"$&#123;myBook&#125;"</span> /&#62;</span></pre></div><p class="paragraph"/><h4>コントローラとタグライブラリでのテンプレート <div class="hidden-block">Templates in Controllers and Tag Libraries </div></h4><p class="paragraph"/><div class="hidden-block">You can also render templates from controllers using the <a href="../ref/Controllers/render.html" class="controllers">render</a> controller method. This is useful for <a href="../guide/single.html#ajax" class="guide">Ajax</a> applications where you generate small HTML or data responses to partially update the current page instead of performing new request:</div>
コントローラの<a href="../ref/Controllers/render.html" class="controllers">render</a>メソッドを使用してコントローラでテンプレートを描写することもできます。<a href="../guide/single.html#ajax" class="guide">Ajax</a>アプリケーションのように、ページ内の一部をHTMLのパーツやデータをレスポンスして更新する場合に有用です:<p class="paragraph"/><div class="code"><pre>def bookData() &#123;
    def b = Book.get(params.id)
    render(template:<span class="java&#45;quote">"bookTemplate"</span>, model:&#91;book:b&#93;)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">The <a href="../ref/Controllers/render.html" class="controllers">render</a> controller method writes directly to the response, which is the most common behaviour. To instead obtain the result of template as a String you can use the <a href="../ref/Tags/render.html" class="tags">render</a> tag:</div>
通常の振る舞いですが、コントローラの<a href="../ref/Controllers/render.html" class="controllers">render</a>メソッドは直接結果をレスポンス出力します。文字列としてテンプレートの結果を取得する場合は、<a href="../ref/Tags/render.html" class="tags">render</a>タグを使用できます。:<p class="paragraph"/><div class="code"><pre>def bookData() &#123;
    def b = Book.get(params.id)
    <span class="java&#45;object">String</span> content = g.render(template:<span class="java&#45;quote">"bookTemplate"</span>, model:&#91;book:b&#93;)
    render content
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Notice the usage of the <code>g</code> namespace which tells Grails we want to use the <a href="../guide/single.html#tagsAsMethodCalls" class="guide">tag as method call</a> instead of the <a href="../ref/Controllers/render.html" class="controllers">render</a> method.</div>
ネームスペース<code>g</code>を使用することで<a href="../guide/single.html#tagsAsMethodCalls" class="guide">タグをメソッドとして使用</a>するのか、コントローラの<a href="../ref/Controllers/render.html" class="controllers">render</a>メソッドなのかを区別しています。


<a name="7.2.4 Layouts with Sitemesh"><!-- Legacy link --></a>
<h2 id="layouts">7.2.4 Sitemeshでレイアウト</h2>
<h4>レイアウトを作成する <div class="hidden-block">Creating Layouts </div></h4><p class="paragraph"/><div class="hidden-block">Grails leverages <a href="http://www.opensymphony.com/sitemesh/" target="blank">Sitemesh</a>, a decorator engine, to support view layouts. Layouts are located in the <code>grails-app/views/layouts</code> directory. A typical layout can be seen below:</div>
Grailsはデコレータエンジン<a href="http://www.opensymphony.com/sitemesh/" target="blank">Sitemesh</a>の力を借りてビューレイアウトをサポートしています。レイアウトは<code>grails-app/views/layouts</code>ディレクトリに配置します。標準的なレイアウトは以下のようになります:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;html&#62;</span>
    <span class="xml&#45;tag">&#60;head&#62;</span>
        <span class="xml&#45;tag">&#60;title&#62;</span><span class="xml&#45;tag">&#60;g:layoutTitle default=<span class="xml&#45;quote">"An example decorator"</span> /&#62;</span><span class="xml&#45;tag">&#60;/title&#62;</span>
        <span class="xml&#45;tag">&#60;g:layoutHead /&#62;</span>
    <span class="xml&#45;tag">&#60;/head&#62;</span>
    <span class="xml&#45;tag">&#60;body onload=<span class="xml&#45;quote">"$&#123;pageProperty(name:'body.onload')&#125;"</span>&#62;</span>
        <span class="xml&#45;tag">&#60;div class=<span class="xml&#45;quote">"menu"</span>&#62;</span><span class="xml&#45;comment">&#60;!&#45;&#45;my common menu goes here&#45;&#45;&#62;</span><span class="xml&#45;tag">&#60;/menu&#62;</span>
            <span class="xml&#45;tag">&#60;div class=<span class="xml&#45;quote">"body"</span>&#62;</span>
                <span class="xml&#45;tag">&#60;g:layoutBody /&#62;</span>
            <span class="xml&#45;tag">&#60;/div&#62;</span>
        <span class="xml&#45;tag">&#60;/div&#62;</span>
    <span class="xml&#45;tag">&#60;/body&#62;</span>
<span class="xml&#45;tag">&#60;/html&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">The key elements are the <a href="../ref/Tags/layoutHead.html" class="tags">layoutHead</a>, <a href="../ref/Tags/layoutTitle.html" class="tags">layoutTitle</a> and <a href="../ref/Tags/layoutBody.html" class="tags">layoutBody</a> tag invocations:</div>
鍵となるエレメントは、 <a href="../ref/Tags/layoutHead.html" class="tags">layoutHead</a>、<a href="../ref/Tags/layoutTitle.html" class="tags">layoutTitle</a>、<a href="../ref/Tags/layoutBody.html" class="tags">layoutBody</a>タグです:<p class="paragraph"/><div class="hidden-block">
<ul class="star">
<li><code>layoutTitle</code> - outputs the target page's title</li>
<li><code>layoutHead</code> - outputs the target page's head tag contents</li>
<li><code>layoutBody</code> - outputs the target page's body tag contents</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li><code>layoutTitle</code> - ページのタイトルを出力</li>
<li><code>layoutHead</code> - ページのheadタグコンテントを出力</li>
<li><code>layoutBody</code> - ページのbodyタグコンテントを出力</li>
</ul><p class="paragraph"/><div class="hidden-block">The previous example also demonstrates the <a href="../ref/Tags/pageProperty.html" class="tags">pageProperty</a> tag which can be used to inspect and return aspects of the target page.</div>
さらに前述した例では、指定した内容をターゲットページから精査して内容を返す<a href="../ref/Tags/pageProperty.html" class="tags">pageProperty</a>タグの紹介しています。<p class="paragraph"/><h4>レイアウトを反映させる <div class="hidden-block">Triggering Layouts </div></h4><p class="paragraph"/><div class="hidden-block">There are a few ways to trigger a layout. The simplest is to add a meta tag to the view:</div>
レイアウトを反映させる幾つかの方法があります。簡単な方法は、ビューにmetaタグを追加するだけです:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;html&#62;</span>
    <span class="xml&#45;tag">&#60;head&#62;</span>
        <span class="xml&#45;tag">&#60;title&#62;</span>An Example Page<span class="xml&#45;tag">&#60;/title&#62;</span>
        <span class="xml&#45;tag">&#60;meta name=<span class="xml&#45;quote">"layout"</span> content=<span class="xml&#45;quote">"main"</span> /&#62;</span>
    <span class="xml&#45;tag">&#60;/head&#62;</span>
    <span class="xml&#45;tag">&#60;body&#62;</span>This is my content!<span class="xml&#45;tag">&#60;/body&#62;</span>
<span class="xml&#45;tag">&#60;/html&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">In this case a layout called <code>grails-app/views/layouts/main.gsp</code> will be used to layout the page. If we were to use the layout from the previous section the output would resemble this:</div>
この例では、レイアウトの<code>grails-app/views/layouts/main.gsp</code>が呼び出されてページのレイアウトに使用されます。内容が先ほどのレイアウトの内奥であれば、以下のような出力が得られます:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;html&#62;</span>
    <span class="xml&#45;tag">&#60;head&#62;</span>
        <span class="xml&#45;tag">&#60;title&#62;</span>An Example Page<span class="xml&#45;tag">&#60;/title&#62;</span>
    <span class="xml&#45;tag">&#60;/head&#62;</span>
    <span class="xml&#45;tag">&#60;body onload=<span class="xml&#45;quote">""</span>&#62;</span>
        <span class="xml&#45;tag">&#60;div class=<span class="xml&#45;quote">"menu"</span>&#62;</span><span class="xml&#45;comment">&#60;!&#45;&#45;my common menu goes here&#45;&#45;&#62;</span><span class="xml&#45;tag">&#60;/div&#62;</span>
        <span class="xml&#45;tag">&#60;div class=<span class="xml&#45;quote">"body"</span>&#62;</span>
            This is my content!
        <span class="xml&#45;tag">&#60;/div&#62;</span>
    <span class="xml&#45;tag">&#60;/body&#62;</span>
<span class="xml&#45;tag">&#60;/html&#62;</span></pre></div><p class="paragraph"/><h4>コントローラでレイアウトを指定 <div class="hidden-block">Specifying A Layout In A Controller </div></h4><p class="paragraph"/><div class="hidden-block">Another way to specify a layout is to specify the name of the layout by assigning a value to the "layout" property in a controller. For example, if you have a controller such as:</div>
別の方法として、コントローラに"layout"プロパティの値としてレイアウトする事ができます。例として以下のようなコントローラがあるとしたら:<p class="paragraph"/><div class="code"><pre>class BookController &#123;
    <span class="java&#45;keyword">static</span> layout = 'customer'<p class="paragraph"/>    def list() &#123; &#8230; &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">You can create a layout called <code>grails-app/views/layouts/customer.gsp</code> which will be applied to all views that the <code>BookController</code> delegates to.  The value of the "layout" property may contain a directory structure relative to the <code>grails-app/views/layouts/</code> directory.  For example:</div>
<code>grails-app/views/layouts/customer.gspと</code>いうレイアウトファイルを作成すると、<code>BookController</code>に連動する全てのビューに反映します。
"layout"プロパティの値は<code>grails-app/views/layouts/</code>ディレクトリが含まれます。例として:<p class="paragraph"/><div class="code"><pre>class BookController &#123;
    <span class="java&#45;keyword">static</span> layout = 'custom/customer'<p class="paragraph"/>    def list() &#123; &#8230; &#125;
&#125;</pre></div><p class="paragraph"/>Views rendered from that controller would be decorated with the <code>grails-app/views/layouts/custom/customer.gsp</code> template.
この例で、このコントローラのビューは、<code>grails-app/views/layouts/custom/customer.gsp</code>テンプレートでデコレートされます。<p class="paragraph"/><h4>慣習によるレイアウト <div class="hidden-block">Layout by Convention </div></h4><p class="paragraph"/><div class="hidden-block">Another way to associate layouts is to use "layout by convention". For example, if you have this controller:</div>
"慣習によるレイアウト"によってレイアウトと連動することが可能です。例として、次のようなコントローラがあるとします:<p class="paragraph"/><div class="code"><pre>class BookController &#123;
    def list() &#123; &#8230; &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">You can create a layout called <code>grails-app/views/layouts/book.gsp</code>, which will be applied to all views that the <code>BookController</code> delegates to.</div>
<code>BookController</code>のビューに反映されるレイアウト<code>grails-app/views/layouts/book.gsp</code>を作成できます。<p class="paragraph"/><div class="hidden-block">Alternatively, you can create a layout called <code>grails-app/views/layouts/book/list.gsp</code> which will only be applied to the <code>list</code> action within the <code>BookController</code>.</div>
あるいは、<code>BookController</code>のアクション<code>list</code>のみに反映するレイアウト<code>grails-app/views/layouts/book/list.gsp</code>を作成できます。<p class="paragraph"/><div class="hidden-block">If you have both the above mentioned layouts in place the layout specific to the action will take precedence when the list action is executed.</div>
両方のレイアウトが存在する場合は、アクションに指定したレイアウトが優先されます。<p class="paragraph"/><div class="hidden-block">If a layout may not be located using any of those conventions, the convention of last resort is to look for the application default layout which
is <code>grails-app/views/layouts/application.gsp</code>.  The name of the application default layout may be changed by defining a property
in <code>grails-app/conf/Config.groovy</code> as follows:</div>
もしこれらの慣習にあわせたレイアウトが存在しない場合は、最終的にデフォルトレイアウトの<code>grails-app/views/layouts/application.gsp</code>を探しに行きます。アプリケーションのデフォルトレイアウト名称は、次のプロパティを<code>grails-app/conf/Config.groovy</code>に定義することで変更が可能です。:<p class="paragraph"/><div class="code"><pre>grails.sitemesh.<span class="java&#45;keyword">default</span>.layout = 'myLayoutName'</pre></div><p class="paragraph"/><div class="hidden-block">With that property in place, the application default layout will be <code>grails-app/views/layouts/myLayoutName.gsp</code>.</div>
この例でのアプリケーションのデフォルトレイアウトは<code>grails-app/views/layouts/myLayoutName.gsp</code>になります。<p class="paragraph"/><h4>インラインレイアウト <div class="hidden-block">Inline Layouts </div></h4><p class="paragraph"/><div class="hidden-block">Grails' also supports Sitemesh's concept of inline layouts with the <a href="../ref/Tags/applyLayout.html" class="tags">applyLayout</a> tag. This can be used to apply a layout to a template, URL or arbitrary section of content. This lets you even further modularize your view structure by "decorating" your template includes.</div>
Grailsでは、<a href="../ref/Tags/applyLayout.html" class="tags">applyLayout</a>タグを使用することでSitemeshのインラインレイアウトをサポートしています。インラインレイアウトでは、テンプレート、URL、任意のコンテントにレイアウトを使用することができます。<p class="paragraph"/><div class="hidden-block">Some examples of usage can be seen below:</div>
例としては以下のようになります:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:applyLayout name=<span class="xml&#45;quote">"myLayout"</span> template=<span class="xml&#45;quote">"bookTemplate"</span> collection=<span class="xml&#45;quote">"$&#123;books&#125;"</span> /&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;g:applyLayout name=<span class="xml&#45;quote">"myLayout"</span> url=<span class="xml&#45;quote">"http://www.google.com"</span> /&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;g:applyLayout name=<span class="xml&#45;quote">"myLayout"</span>&#62;</span>
The content to apply a layout to
<span class="xml&#45;tag">&#60;/g:applyLayout&#62;</span></pre></div><p class="paragraph"/><h4>サーバーサイドインクルード <div class="hidden-block">Server-Side Includes </div></h4><p class="paragraph"/><div class="hidden-block">While the <a href="../ref/Tags/applyLayout.html" class="tags">applyLayout</a> tag is useful for applying layouts to external content, if you simply want to include external content in the current page you use the <a href="../ref/Tags/include.html" class="tags">include</a> tag:</div>
<a href="../ref/Tags/applyLayout.html" class="tags">applyLayout</a>タグは、外部コンテントに対してレイアウトを反映させるのに便利ですが、単純に外部コンテンツを現在のページに含みたい場合は<a href="../ref/Tags/include.html" class="tags">include</a>タグが使用できます。<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:include controller=<span class="xml&#45;quote">"book"</span> action=<span class="xml&#45;quote">"list"</span> /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">You can even combine the <a href="../ref/Tags/include.html" class="tags">include</a> tag and the <a href="../ref/Tags/applyLayout.html" class="tags">applyLayout</a> tag for added flexibility:</div>
柔軟な対応をするために、<a href="../ref/Tags/applyLayout.html" class="tags">applyLayout</a>タグと<a href="../ref/Tags/include.html" class="tags">include</a>タグを一緒に利用できます:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:applyLayout name=<span class="xml&#45;quote">"myLayout"</span>&#62;</span>
   <span class="xml&#45;tag">&#60;g:include controller=<span class="xml&#45;quote">"book"</span> action=<span class="xml&#45;quote">"list"</span> /&#62;</span>
<span class="xml&#45;tag">&#60;/g:applyLayout&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Finally, you can also call the <a href="../ref/Tags/include.html" class="tags">include</a> tag from a controller or tag library as a method:</div>
もちろん、<a href="../ref/Tags/include.html" class="tags">include</a>タグをメソッドとして、コントローラやタグライブラリで使用できます:<p class="paragraph"/><div class="code"><pre>def content = include(controller:<span class="java&#45;quote">"book"</span>, action:<span class="java&#45;quote">"list"</span>)</pre></div><p class="paragraph"/><div class="hidden-block">The resulting content will be provided via the return value of the <a href="../ref/Tags/include.html" class="tags">include</a> tag.</div>
コンテントの結果は、<a href="../ref/Tags/include.html" class="tags">include</a>タグの返値で提供されます。


<a name="7.2.5 Static Resources"><!-- Legacy link --></a>
<h2 id="resources">7.2.5 静的リソース</h2>
<div class="hidden-block">Grails 2.0 integrates with the <a href="http://grails.org/plugin/resources" target="blank">Resources plugin</a> to provide sophisticated static resource management. This plugin is installed by default in new Grails applications.</div>
 2.0から、洗練された静的リソース管理を提供する<a href="http://grails.org/plugin/resources" target="blank">Resourcesプラグイン</a>を統合しています。このプラグインはデフォルトで新規Grailsアプリケーションにインストールされます。<p class="paragraph"/><div class="hidden-block">The basic way to include a link to a static resource in your application is to use the <a href="../ref/Tags/resource.html" class="tags">resource</a> tag. This simple approach creates a URI pointing to the file.</div>
静的リソースのリンクを含む場合、通常<a href="../ref/Tags/resource.html" class="tags">resource</a>タグを使用します。これはURIでファイルを指定する簡単なアプローチになります。<p class="paragraph"/><div class="hidden-block">However modern applications with dependencies on multiple JavaScript and CSS libraries and frameworks (as well as dependencies on multiple Grails plugins) require something more powerful.</div>
しかし近頃のアプリケーションは、様々なJavaScriptやCSSライブラリやフレームワークに依存しており、もっとパワフルな方法が必要となります。<p class="paragraph"/>
<div class="hidden-block">The issues that the Resources framework tackles are:</div>
Resourceフレームワークの取り組んだ課題:
<div class="hidden-block">
<ul class="star">
<li>Web application performance tuning is difficult</li>
<li>Correct ordering of resources, and deferred inclusion of JavaScript</li>
<li>Resources that depend on others that must be loaded first</li>
<li>The need for a standard way to expose static resources in plugins and applications</li>
<li>The need for an extensible processing chain to optimize resources</li>
<li>Preventing multiple inclusion of the same resource</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li>Webアプリケーションのパフォーマンスチューニングが難しい</li>
<li>リソースの配置順と、JavaScriptの遅延包括</li>
<li>先に読み込む必要のある依存関係のあるリソース</li>
<li>プラグインやアプリケーションでの、静的リソースを表示する方法の標準化が必要</li>
<li>リソースの最適化を行うための拡張可能な連鎖行程が必要</li>
<li>同じリソースの多重配置を防ぐ</li>
</ul><p class="paragraph"/><div class="hidden-block">The plugin achieves this by introducing new artefacts and processing the resources using the server's local file system.</div>
プラグインでアーテファクトの提供と、サーバのローカルファイルシステムを使用して処理をすることで、これらを達成しています。<p class="paragraph"/><div class="hidden-block">It adds artefacts for declaring resources, for declaring "mappers" that can process resources, and a servlet filter to serve processed resources.</div>
プラグインは、リソースを宣言するためのアーテファクト、リソースを処理する"マッパー"、処理されたリソースを提供するサーブレットフィルタを追加します。<p class="paragraph"/><div class="hidden-block">What you get is an incredibly advanced resource system that enables you to easily create highly optimized web applications that run the same in development and in production.</div>
信じられないほど上級のリソースシステムが、簡単に高度に最適化されたWebアプリケーション作成をdevelpoment,productionモード共に可能とします。<p class="paragraph"/><div class="hidden-block">The Resources plugin documentation provides a more detailed overview of the <a href="http://grails-plugins.github.com/grails-resources/" target="blank">concepts</a> which will be beneficial when reading the following guide.</div>
リソースプラグインの<a href="http://grails-plugins.github.com/grails-resources/" target="blank">ドキュメント</a>では、さらに詳細な内容を提供しています。


<a name="7.2.5.1 Including resources using the resource tags"><!-- Legacy link --></a>
<h2 id="includingResourcesUsingTheResourceTags">7.2.5.1 リソースタグでのリソースの使用</h2>
<h4>r:requireでリソースを制御する <div class="hidden-block">Pulling in resources with r:require</div></h4><p class="paragraph"/><div class="hidden-block">To use resources, your GSP page must indicate which resource modules it requires. For example with the <a href="http://grails.org/plugin/jquery" target="blank">jQuery plugin</a>, which exposes a "jquery" resource module, to use jQuery in any page on your site you simply add:</div>
リソースを使用するにはどのリソースモジュールが必要がGSPページで示す必要があります。例として、"jquery"リソースモジュールを提供している<a href="http://grails.org/plugin/jquery" target="blank">jQueryプラグイン</a>を、サイトの全てのページで使用する場合は単に次のように追加するだけです:<p class="paragraph"/>
<div class="code"><pre><span class="xml&#45;tag">&#60;html&#62;</span>
   <span class="xml&#45;tag">&#60;head&#62;</span>
      <span class="xml&#45;tag">&#60;r:require module=<span class="xml&#45;quote">"jquery"</span>/&#62;</span>
      <span class="xml&#45;tag">&#60;r:layoutResources/&#62;</span>
   <span class="xml&#45;tag">&#60;/head&#62;</span>
   <span class="xml&#45;tag">&#60;body&#62;</span>
      &#8230;
      <span class="xml&#45;tag">&#60;r:layoutResources/&#62;</span>
   <span class="xml&#45;tag">&#60;/body&#62;</span>
<span class="xml&#45;tag">&#60;/html&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">This will automatically include all resources needed for jQuery, including them at the correct locations in the page. By default the plugin sets the disposition to be "head", so they load early in the page.</div>
これで自動的にjQueryで必要なリソースをページの正確な場所に配置します。デフォルトではプラグインが"head"に配置するので、ページの初めの方でロードされます。<p class="paragraph"/><div class="hidden-block">You can call <code>r:require</code> multiple times in a GSP page, and you use the "modules" attribute to provide a list of modules:</div>
GSPページで<code>r:require</code>を複数回呼んでも構いません。そして"modules"属性を使用してモジュールを列挙することもできます:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;html&#62;</span>
   <span class="xml&#45;tag">&#60;head&#62;</span>
      <span class="xml&#45;tag">&#60;r:require modules=<span class="xml&#45;quote">"jquery, main, blueprint, charting"</span>/&#62;</span>
      <span class="xml&#45;tag">&#60;r:layoutResources/&#62;</span>
   <span class="xml&#45;tag">&#60;/head&#62;</span>
   <span class="xml&#45;tag">&#60;body&#62;</span>
      &#8230;
      <span class="xml&#45;tag">&#60;r:layoutResources/&#62;</span>
   <span class="xml&#45;tag">&#60;/body&#62;</span>
<span class="xml&#45;tag">&#60;/html&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">The above may result in many JavaScript and CSS files being included, in the correct order, with some JavaScript files loading at the end of the body to improve the apparent page load time.</div>
上記の結果は、多くのJavaScriptとCSSファイルが正確な順番に、そして一部のJavaScriptはページ読み込み時間を向上させるために、ページボディの最後にロードされるようにページに含まれます。<p class="paragraph"/><div class="hidden-block">However you cannot use r:require in isolation - as per the examples you must have the &#60;r:layoutResources/&#62; tag to actually perform the render.</div>
r:requireは単体で使用することはできません。例にあるように実際に描写を行う<code>&#60;r:layoutResources/&#62;</code>タグが必要になります。<p class="paragraph"/><h4>r:layoutResourcesでリソースへのリンクを描写する <div class="hidden-block">Rendering the links to resources with r:layoutResources </div></h4><p class="paragraph"/><div class="hidden-block">When you have declared the resource modules that your GSP page requires, the framework needs to render the links to those resources at the correct time.</div>
GSPページに必要なリソースモジュールを宣言すると、フレームワークは正常なタイミングでリソースへのリンクを描写する必要があります。<p class="paragraph"/><div class="hidden-block">To achieve this correctly, you must include the r:layoutResources tag twice in your page, or more commonly, in your GSP layout:</div>
これを正常に行うには、r:layoutResourcesタグをページまたはGSPレイアウトの２ヶ所に配置します。:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;html&#62;</span>
   <span class="xml&#45;tag">&#60;head&#62;</span>
      <span class="xml&#45;tag">&#60;g:layoutTitle/&#62;</span>
      <span class="xml&#45;tag">&#60;r:layoutResources/&#62;</span>
   <span class="xml&#45;tag">&#60;/head&#62;</span>
   <span class="xml&#45;tag">&#60;body&#62;</span>
      <span class="xml&#45;tag">&#60;g:layoutBody/&#62;</span>
      <span class="xml&#45;tag">&#60;r:layoutResources/&#62;</span>
   <span class="xml&#45;tag">&#60;/body&#62;</span>
<span class="xml&#45;tag">&#60;/html&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">This represents the simplest Sitemesh layout you can have that supports Resources.</div>
これはリソースフレームワークに対応した、いちばん単純なSitemeshレイアウトの例です。<p class="paragraph"/><div class="hidden-block">The Resources framework has the concept of a "disposition" for every resource. This is an indication of where in the page the resource should be included.</div>
リソースフレームワークには全てのリソースに"配置"の概念を持っています。ページのどの部分にリソースを含めるべきかを指示する物です。<p class="paragraph"/><div class="hidden-block">The default disposition applied depends on the type of resource. All CSS must be rendered in &#60;head&#62; in HTML, so "head" is the default for all CSS, and will be rendered by the first r:layoutResources. Page load times are improved when JavaScript is loaded after the page content, so the default for JavaScript files is "defer", which means it is rendered when the second r:layoutResources is invoked.</div>
基本的な配置はリソースの種類によって適用されます。全てのCSSはHTMLの&#60;head&#62;に描写されるべきです。したがって全てのCSSは、デフォルトで最初のr:layoutResourcesによって"head"に描写されます。JavaScriptはページコンテンツの最後に読み込ませてJavaScriptファイルの実行を遅らせることで("defer")、ページのロード時間が向上されます。したがって２つ目のr:layoutResourcesが実行された時に描写されます。<p class="paragraph"/><div class="hidden-block">Note that both your GSP page and your Sitemesh layout (as well as any GSP template fragments) can call r:require to depend on resources. The only limitation is that you must call r:require before the r:layoutResources that should render it.</div>
GSPページとSItemeshレイアウト両方で(もちろんGSPテンプレートでも)、リソースに依存するr:requireを呼び出す事ができます。唯一の制約として、内容を描写するr:layoutResourcesの前に必ずr:requireを呼び出す必要があります。<p class="paragraph"/>
<h4>r:scriptでページ固有のJavaScriptコードを追加 <div class="hidden-block">Adding page-specific JavaScript code with r:script </div></h4><p class="paragraph"/><div class="hidden-block">Grails has the <a href="../ref/Tags/javascript.html" class="tags">javascript</a> tag which is adapted to defer to Resources plugin if installed, but it is recommended that you call <code>r:script</code> directly when you need to include fragments of JavaScript code.</div>
Grailsにはリソースプラグインがインストールされている場合には、リソースプラグインに従う<a href="../ref/Tags/javascript.html" class="tags">javascript</a>タグがありますが、JavaScriptコードを含みたい場合は、直接<code>r:script</code>を呼ぶことを推奨します。<p class="paragraph"/><div class="hidden-block">This lets you write some "inline" JavaScript which is actually <strong class="bold">not</strong> rendered inline, but either in the &#60;head&#62; or at the end of the body, based on the disposition.</div>
これはJavaScriptをインラインで記述できて描写はインラインでは無く、配置指定をした&#60;head&#62;またはボディの最後に描写されます。<p class="paragraph"/><div class="hidden-block">Given a Sitemesh layout like this:</div>
このようなSitemeshレイアウトがあるとします:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;html&#62;</span>
   <span class="xml&#45;tag">&#60;head&#62;</span>
      <span class="xml&#45;tag">&#60;g:layoutTitle/&#62;</span>
      <span class="xml&#45;tag">&#60;r:layoutResources/&#62;</span>
   <span class="xml&#45;tag">&#60;/head&#62;</span>
   <span class="xml&#45;tag">&#60;body&#62;</span>
      <span class="xml&#45;tag">&#60;g:layoutBody/&#62;</span>
      <span class="xml&#45;tag">&#60;r:layoutResources/&#62;</span>
   <span class="xml&#45;tag">&#60;/body&#62;</span>
<span class="xml&#45;tag">&#60;/html&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">...in your GSP you can inject some JavaScript code into the head or deferred regions of the page like this:</div>
GSPではJavaScriptコードをヘッドまたページの最後の方に以下のように記述します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;html&#62;</span>
   <span class="xml&#45;tag">&#60;head&#62;</span>
      <span class="xml&#45;tag">&#60;title&#62;</span>Testing r:script magic!<span class="xml&#45;tag">&#60;/title&#62;</span>
   <span class="xml&#45;tag">&#60;/head&#62;</span>
   <span class="xml&#45;tag">&#60;body&#62;</span>
      <span class="xml&#45;tag">&#60;r:script disposition=<span class="xml&#45;quote">"head"</span>&#62;</span>
         window.alert('This is at the end of <span class="xml&#45;tag">&#60;head&#62;</span>');
      <span class="xml&#45;tag">&#60;/r:script&#62;</span>
      <span class="xml&#45;tag">&#60;r:script disposition=<span class="xml&#45;quote">"defer"</span>&#62;</span>
         window.alert('This is at the end of the body, and the page has loaded.');
      <span class="xml&#45;tag">&#60;/r:script&#62;</span>
   <span class="xml&#45;tag">&#60;/body&#62;</span>
<span class="xml&#45;tag">&#60;/html&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">The default disposition is "defer", so the disposition in the latter r:script is purely included for demonstration.</div>
disposition属性のデフォルトは"defer"になります。従って後者のr:scriptはここでの説明として定義しているだけです。<p class="paragraph"/><div class="hidden-block">Note that such r:script code fragments <strong class="bold">always</strong> load after any modules that you have used, to ensure that any required libraries have loaded.</div>
 r:scripのコードブロックは、必要なライブラリがロードされているのを保証するために、常に指定したモジュールの後に読み込まれます。<p class="paragraph"/><h4>r:imgで画像へのリンク <div class="hidden-block">Linking to images with r:img </div></h4><p class="paragraph"/><div class="hidden-block">This tag is used to render <code>&#60;img&#62;</code> markup, using the Resources framework to process the resource on the fly (if configured to do so - e.g. make it eternally cacheable).</div>
このタグは、リソースフレームワークを使用してリソースを処理した、&#60;img&#62;タグを描写するのに使用します。(定義をした場合。e.g.画像キャッシュ等)<p class="paragraph"/><div class="hidden-block">This includes any extra attributes on the <code>&#60;img&#62;</code> tag if the resource has been previously declared in a module.</div>
あらかじめリソースモジュール宣言されたタグの属性も<code>&#60;img&#62;</code>タグの属性に追加します。<p class="paragraph"/><div class="hidden-block">With this mechanism you can specify the width, height and any other attributes in the resource declaration in the module, and they will be pulled in as necessary.</div>
この仕組みでは、モジュールに宣言した、width,heightまたその他の属性をタグに取り込みます。<p class="paragraph"/><div class="hidden-block">Example:</div>
例として:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;html&#62;</span>
   <span class="xml&#45;tag">&#60;head&#62;</span>
      <span class="xml&#45;tag">&#60;title&#62;</span>Testing r:img<span class="xml&#45;tag">&#60;/title&#62;</span>
   <span class="xml&#45;tag">&#60;/head&#62;</span>
   <span class="xml&#45;tag">&#60;body&#62;</span>
      <span class="xml&#45;tag">&#60;r:img uri=<span class="xml&#45;quote">"/images/logo.png"</span>/&#62;</span>
   <span class="xml&#45;tag">&#60;/body&#62;</span>
<span class="xml&#45;tag">&#60;/html&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Note that Grails has a built-in <code>g:img</code> tag as a shortcut for rendering <code>&#60;img&#62;</code> tags that refer to a static resource. The Grails <a href="../ref/Tags/img.html" class="tags">img</a> tag is Resources-aware and will delegate to <code>r:img</code> if found. However it is recommended that you use <code>r:img</code> directly if using the Resources plugin.</div>
Grailsには、<code>&#60;img&#62;</code>タグを描写する、リソース参照できる<code>g:img</code>タグが存在します。Grailsの<a href="../ref/Tags/img.html" class="tags">img</a>タグは、存在した場合リソースフレームワークが認識して<code>r:img</code>に委譲しますが、リソースプラグインを使用している場合は直接<code>r:img</code>を使用することを推奨します。<p class="paragraph"/><div class="hidden-block">Alongside the regular Grails <a href="../ref/Tags/resource.html" class="tags">resource</a> tag attributes, this also supports the "uri" attribute for increased brevity.</div>
通常のGrails <a href="../ref/Tags/img.html" class="tags">img</a>タグと一緒で、簡潔に記述できる"uri"属性にも対応しています。<p class="paragraph"/><div class="hidden-block">See <a href="http://grails-plugins.github.com/grails-resources" target="blank">r:resource documentation</a> for full details.</div>
詳細は<a href="http://grails-plugins.github.com/grails-resources" target="blank">Resources</a>プラグインのドキュメントを参照。

<a name="7.2.5.2 Other resource tags"><!-- Legacy link --></a>
<h2 id="otherResourceTags">7.2.5.2 他のリソースタグ</h2>
<h4>r:resource</h4><p class="paragraph"/><div class="hidden-block">This is equivalent to the Grails <a href="../ref/Tags/resource.html" class="Tags">resource</a> tag, returning a link to the processed static resource. Grails' own <code>g:resource</code> tag delegates to this implementation if found, but if your code requires the Resources plugin, you should use <code>r:resource</code> directly.</div>
これはGrails <a href="../ref/Tags/resource.html" class="Tags">resource</a>タグと同じで静的リソースへのリンクを処理して返します。Grailsの<code>g:resource</code>タグが有った場合はこのタグに委譲します。リソースプラグインを使用している場合は直接<code>r:resource</code>を使用しましょう。<p class="paragraph"/><div class="hidden-block">Alongside the regular Grails <a href="../ref/Tags/resource.html" class="Tags">resource</a> tag attributes, this also supports the "uri" attribute for increased brevity.</div>
通常のGrails <a href="../ref/Tags/resource.html" class="Tags">resource</a>タグと一緒で、簡潔に記述できる"uri"属性にも対応しています。<p class="paragraph"/>
<div class="hidden-block">See <a href="http://grails-plugins.github.com/grails-resources" target="blank">r:resource documentation</a> for full details.</div>
詳細は<a href="http://grails-plugins.github.com/grails-resources" target="blank">Resources</a>プラグインのドキュメントを参照。<p class="paragraph"/><h4>r:external</h4><p class="paragraph"/><div class="hidden-block">This is a resource-aware version of Grails <a href="../ref/Tags/external.html" class="Tags">external</a> tag which renders the HTML markup necessary to include an external file resource such as CSS, JS or a favicon.</div>
Grailsでの<a href="../ref/Tags/external.html" class="Tags">external</a>タグのリソースフレームワーク版です。CSS,JS,favicon等の外部リソースを含む為のHTMLマークアップを描写します。<p class="paragraph"/><div class="hidden-block">See <a href="http://grails-plugins.github.com/grails-resources" target="blank">r:resource documentation</a> for full details.</div>
詳細は<a href="http://grails-plugins.github.com/grails-resources" target="blank">Resources</a>プラグインのドキュメントを参照。

<a name="7.2.5.3 Declaring resources"><!-- Legacy link --></a>
<h2 id="declaringResources">7.2.5.3 リソースの宣言</h2>
<div class="hidden-block">A DSL is provided for declaring resources and modules. This can go either in your <code>Config.groovy</code> in the case of application-specific resources, or more commonly in a resources artefact in <code>grails-app/conf</code>.</div>
リソースとモジュールを宣言するためのDSLが提供されています。アプリケーション固有の場合は<code>Config.groovy</code>ファイルに記述、また通常はリソースアーテファクトとして<code>grails-app/conf</code>にファイルで配置します。<p class="paragraph"/><div class="hidden-block">Note that you do not need to declare all your static resources, especially images. However you must to establish dependencies or other resources-specific attributes. Any resource that is not declared is called "ad-hoc" and will still be processed using defaults for that resource type.</div>
特に画像に関しては、全ての静的リソースを宣言する必要はありませんが、依存関係またはリソース固有の属性を確立する必要があります。宣言されていないリソースは"ad-hoc"とよばれ、リソースの種類に対応した処理が行われます。<p class="paragraph"/><div class="hidden-block">Consider this example resource configuration file, <code>grails-app/conf/MyAppResources.groovy</code>:</div>
次のようなリソース定義が<code>grails-app/conf/MyAppResources.groovy</code>ファイルで例として有るとします:<p class="paragraph"/><div class="code"><pre>modules = &#123;
    core &#123;
        dependsOn 'jquery, utils'<p class="paragraph"/>        resource url: '/js/core.js', disposition: 'head'
        resource url: '/js/ui.js'
        resource url: '/css/main.css',
        resource url: '/css/branding.css'
        resource url: '/css/print.css', attrs: &#91;media: 'print'&#93;
    &#125;<p class="paragraph"/>    utils &#123;
        dependsOn 'jquery'<p class="paragraph"/>        resource url: '/js/utils.js'
    &#125;<p class="paragraph"/>    forms &#123;
        dependsOn 'core,utils'<p class="paragraph"/>        resource url: '/css/forms.css'
        resource url: '/js/forms.js'
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">This defines three resource modules; 'core', 'utils' and 'forms'. The resources in these modules will be automatically bundled out of the box according to the module name, resulting in fewer files. You can override this with <code>bundle:'someOtherName'</code> on each resource, or call <code>defaultBundle</code> on the module (see <a href="http://grails-plugins.github.com/grails-resources" target="blank">resources plugin documentation</a>).</div>
ここでは'core','utils','forms'の３つのリソースモジュールを定義しています。このモジュールのリソースは、モジュール名に応じて、すぐに使えるように、より少ないファイルに自動的にバンドルされます。それぞれのリソースは<code>bundle:'someOtherName'</code>またはモジュールで<code>defaultBundle</code>を呼ぶことででオーバーライドできます。(<a href="http://grails-plugins.github.com/grails-resources" target="blank">Resourcesプラグイン</a>ドキュメントを参照)<p class="paragraph"/><div class="hidden-block">It declares dependencies between them using <code>dependsOn</code>, which controls the load order of the resources.</div>
リソースの読み込み順を操作するために、それぞれの依存関係を<code>dependsOn</code>で宣言しています。<p class="paragraph"/><div class="hidden-block">When you include an <code>&#60;r:require module="forms"/&#62;</code> in your GSP, it will pull in all the resources from 'core' and 'utils' as well as 'jquery', all in the correct order.</div>
GSPに<code>&#60;r:require module="forms"/&#62;</code>を含んだ場合、この例では'core','util'そして'jquery'のリソースを正常な順番で引っ張ります。<p class="paragraph"/><div class="hidden-block">You'll also notice the <code>disposition:'head'</code> on the <code>core.js</code> file. This tells Resources that while it can defer all the other JS files to the end of the body, this one must go into the <code>&#60;head&#62;</code>.</div>
さらにcore.jsファイルの<code>disposition:'head'</code>に注目してください。その他全てのリソースはボディの最後に配置して、このファイルは必ず<code>&#60;head&#62;</code>に配置する指定をしています。<p class="paragraph"/><div class="hidden-block">The CSS file for print styling adds custom attributes using the <code>attrs</code> map option, and these are passed through to the <code>r:external</code> tag when the engine renders the link to the resource, so you can customize the HTML attributes of the generated link.</div>
プリント指定用のCSSでは、カスタム属性を<code>attrs</code>マップで追加しています。そしてこれらは<code>r:external</code>タグを通してリソースへのリンクを形成します。これによってリンクのHTML属性をカスタマイズすることができます。<p class="paragraph"/><div class="hidden-block">There is no limit to the number of modules or xxxResources.groovy artefacts you can provide, and plugins can supply them to expose modules to applications, which is exactly how the jQuery plugin works.</div>
モジュールやxxxResources.groovyアーテファクトには数量制限がありません。jQueryプラグインのようにプラグインでモジュールを提供することもできます。<p class="paragraph"/><div class="hidden-block">To define modules like this in your application's Config.groovy, you simply assign the DSL closure to the <code>grails.resources.modules</code> Config variable.</div>
アプリケーションのConfig.groovyでモジュールを宣言する場合は、モジュールのDSLクロージャを<code>grails.resources.modules</code>に定義します。<p class="paragraph"/><div class="hidden-block">For full details of the resource DSL please see the <a href="http://grails-plugins.github.com/grails-resources" target="blank">resources plugin documentation</a>.</div>
リソースDSLの詳細は<a href="http://grails-plugins.github.com/grails-resources" target="blank">Resourcesプラグイン</a>のドキュメントを参考にしてください。


<a name="7.2.5.4 Overriding plugin resources"><!-- Legacy link --></a>
<h2 id="overridingPluginResources">7.2.5.4 プラグインリソースのオーバーライド</h2>
<div class="hidden-block">Because a resource module can define the bundle groupings and other attributes of resources, you may find that the settings provided are not correct for your application.</div>
リソースモジュールにバンドルのグルーピングと他のリソース属性の宣言ができることで、提供されている設定が個々のアプリケーションで違う場合が有るのを認識します。<p class="paragraph"/><div class="hidden-block">For example, you may wish to bundle jQuery and some other libraries all together in one file. There is a load-time and caching trade-off here, but often it is the case that you'd like to override some of these settings.</div>
例として、jQueryと他のライブラリをまとめてバンドルするとします。これだとロード時間とキャッシングのトレードオフになりますが、しかし良くあるケースとしてこれらの設定をオーバーライドするとします。<p class="paragraph"/><div class="hidden-block">To do this, the DSL supports an "overrides" clause, within which you can change the <code>defaultBundle</code> setting for a module, or attributes of individual resources that have been declared with a unique id:</div>
これには、モジュールまたは固有のリソース属性で変更可能な<code>defaultBundle</code>設定で定義した名称を指定する、DSLの"overrides"で対応しています。<p class="paragraph"/><div class="code"><pre>modules = &#123;
    core &#123;
        dependsOn 'jquery, utils'
        defaultBundle 'monolith'<p class="paragraph"/>        resource url: '/js/core.js', disposition: 'head'
        resource url: '/js/ui.js'
        resource url: '/css/main.css',
        resource url: '/css/branding.css'
        resource url: '/css/print.css', attrs: &#91;media: 'print'&#93;
    &#125;<p class="paragraph"/>    utils &#123;
        dependsOn 'jquery'
        defaultBundle 'monolith'<p class="paragraph"/>        resource url: '/js/utils.js'
    &#125;<p class="paragraph"/>    forms &#123;
        dependsOn 'core,utils'
        defaultBundle 'monolith'<p class="paragraph"/>        resource url: '/css/forms.css'
        resource url: '/js/forms.js'
    &#125;<p class="paragraph"/>    overrides &#123;
        jquery &#123;
            defaultBundle 'monolith'
        &#125;
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">This will put all code into a single bundle named 'monolith'. Note that this can still result in multiple files, as separate bundles are required for head and defer dispositions, and JavaScript and CSS files are bundled separately.</div>
この設定で全てのコードが'monolith'という名称の一つのバンドルになります。この設定を行ってもそれぞれのバンドルとしてそれぞれのファイルで配置されます。<p class="paragraph"/><div class="hidden-block">Note that overriding individual resources requires the original declaration to have included a unique id for the resource.</div>
固有のリソースをオーバライドする場合は、もとの宣言がリソース毎にユニークIDで含まれている必要があります。<p class="paragraph"/>For full details of the resource DSL please see the <a href="http://grails-plugins.github.com/grails-resources" target="blank">resources plugin documentation</a>.
リソースDSLの詳細は<a href="http://grails-plugins.github.com/grails-resources" target="blank">リソースプラグイン</a>のドキュメントを参考にしてください。

<a name="7.2.5.5 Optimizing your resources"><!-- Legacy link --></a>
<h2 id="optimizingYourResources">7.2.5.5 リソースの最適化</h2>
<div class="hidden-block">The Resources framework uses "mappers" to mutate the resources into the final format served to the user.</div>
リソースフレームワークは"マッパー"を使用して、最終フォーマットへリソースを変化させてユーザへ配信します。<p class="paragraph"/><div class="hidden-block">The resource mappers are applied to each static resource once, in a specific order. You can create your own resource mappers, and several plugins provide some already for zipping, caching and minifying.</div>
リソースマッパーはそれぞれの静的リソースに一度だけ特定の順番で適用されます。幾つかのプラグインzipping, caching や minifyingのように独自のリソースマッパーを作成することが可能です。<p class="paragraph"/><div class="hidden-block">Out of the box, the Resources plugin provides bundling of resources into fewer files, which is achieved with a few mappers that also perform CSS re-writing to handle when your CSS files are moved into a bundle.</div>
すぐに使用できる仕組みとして、リソースをまとめて少なくするバンドルマッパーをResourcesプラグインで提供しています。<p class="paragraph"/><h4>複数のリソースを少ないファイルにまとめる <div class="hidden-block">Bundling multiple resources into fewer files </div></h4><p class="paragraph"/><div class="hidden-block">The 'bundle' mapper operates by default on any resource with a "bundle" defined - or inherited from a <code>defaultBundle</code> clause on the module. Modules have an implicit default bundle name the same as the name of the module.</div>
バンドルマッパーは、"bundle"が定義されたリソース、またはモジュールの<code>defaultBundle</code>に継承されたリソースに対してデフォルトで操作します。モジュールはモジュール名と同じ名称で、暗黙なデフォルトバンドル名を持っています。<p class="paragraph"/><div class="hidden-block">Files of the same kind will be aggregated into this bundle file. Bundles operate across module boundaries:</div>
同じ種類のファイルがこのバンドルに集計されます。バンドルはモジュールにわたって操作されます:<p class="paragraph"/><div class="code"><pre>modules = &#123;
    core &#123;
        dependsOn 'jquery, utils'
        defaultBundle 'common'<p class="paragraph"/>        resource url: '/js/core.js', disposition: 'head'
        resource url: '/js/ui.js', bundle: 'ui'
        resource url: '/css/main.css', bundle: 'theme'
        resource url: '/css/branding.css'
        resource url: '/css/print.css', attrs: &#91;media: 'print'&#93;
    &#125;<p class="paragraph"/>    utils &#123;
        dependsOn 'jquery'<p class="paragraph"/>        resource url: '/js/utils.js', bundle: 'common'
    &#125;<p class="paragraph"/>    forms &#123;
        dependsOn 'core,utils'<p class="paragraph"/>        resource url: '/css/forms.css', bundle: 'ui'
        resource url: '/js/forms.js', bundle: 'ui'
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Here you see that resources are grouped into bundles; 'common', 'ui' and 'theme' - across module boundaries.</div>
この例でモジュールにわたって、リソースは'common','ui','theme'のグループにまとめられます。<p class="paragraph"/><div class="hidden-block">Note that auto-bundling by module does <strong class="bold">not</strong> occur if there is only one resource in the module.</div>
もしモジュールにリソースが１つの場合は、自動バンドリング処理は行われません。<p class="paragraph"/><h4>クライアントのブラウザでリソースを"永久的に"キャッシュさせる <div class="hidden-block">Making resources cache "eternally" in the client browser </div></h4><p class="paragraph"/><div class="hidden-block">Caching resources "eternally" in the client is only viable if the resource has a unique name that changes whenever the contents change, and requires caching headers to be set on the response.</div>
リソースを"永久的に"キャッシュさせるには、コンテンツが変わらない限り唯一のリソース名を持ち、キャッシングヘッダーがレスポンスにセットされている時のみです。<p class="paragraph"/><div class="hidden-block">The <a href="http://grails.org/plugin/cached-resources" target="blank">cached-resources</a> plugin provides a mapper that achieves this by hashing your files and renaming them based on this hash. It also sets the caching headers on every response for those resources. To use, simply install the cached-resources plugin.</div>
<a href="http://grails.org/plugin/cached-resources" target="blank">cached-resources</a>プラグインでは、ファイルをハッシュ管理してハッシュ管理に基づいて名称を変更するマッパーを提供しています。さらにキャッシングヘッダーを全てのリソースのレスポンスにセットします。これを使用するには単にcached-resourcesをインストールするだけです。<p class="paragraph"/><div class="hidden-block">Note that the caching headers can only be set if your resources are being served by your application. If you have another server serving the static content from your app (e.g. Apache HTTPD), configure it to send caching headers. Alternatively you can configure it to request and proxy the resources from your container.</div>
キャッシングヘッダーはリソースがアプリケーションから配信されたときのみセットされます。もし別のサーバで静的コンテンツを配信している場合は(Apache HTTPD等で)、サーバでそれらのキャッシングヘッダーの定義を行ってください。あるいはリソースをアプリケーションコンテナーを介して配信するように設定も可能です。<p class="paragraph"/><h4>リソース(Zip)圧縮 <div class="hidden-block">Zipping resources </div></h4><p class="paragraph"/><div class="hidden-block">Returning gzipped resources is another way to reduce page load times and reduce bandwidth.</div>
ページロード時間と帯域を減らす別の方法として、gzipしたリソースを返すことができます。<p class="paragraph"/><div class="hidden-block">The <a href="http://grails.org/plugin/zipped-resources" target="blank">zipped-resources</a> plugin provides a mapper that automatically compresses your content, excluding by default already compressed formats such as gif, jpeg and png.</div>
<a href="http://grails.org/plugin/zipped-resources" target="blank">zipped-resources</a>プラグインは、デフォルトで圧縮されている画像等を除いたコンテンツを自動的に圧縮するマッパーを提供しています。<p class="paragraph"/><div class="hidden-block">Simply install the zipped-resources plugin and it works.</div>
単にzipped-resourcesプラグインをインストールするだけで使用できます。<p class="paragraph"/><h4>最小化(Minifying) <div class="hidden-block">Minifying </div></h4><p class="paragraph"/><div class="hidden-block">There are a number of CSS and JavaScript minifiers available to obfuscate and reduce the size of your code. At the time of writing none are publicly released but releases are imminent.</div>
最小化してコード内容をわかりにくくしたりサイズを縮小する幾つかのCSSとJavascript minifierが有ります。現段階ではプラグインの提供は無いですが近々リリースされると思います。


<a name="7.2.5.6 Debugging"><!-- Legacy link --></a>
<h2 id="debugging">7.2.5.6 デバッグ</h2>
<div class="hidden-block">When your resources are being moved around, renamed and otherwise mutated, it can be hard to debug client-side issues. Modern browsers, especially Safari, Chrome and Firefox have excellent tools that let you view all the resources requested by a page, including the headers and other information about them.</div>
リソースが、リソースフレームワークにより、動き回り、名称変更されたり、変更されるとクライアントサイドのデバッグが大変になります。最近のブラウザSafari,Chrome,Firefoxには、リクエストでのページの全てのリソースやヘッダーやその他の情報が閲覧できる優秀なツールがあります。<p class="paragraph"/><div class="hidden-block">There are several debugging features built in to the Resources framework.</div>
リソースフレームワークには、幾つかのデバッグ時に使用する機能を持ち合わせています。<p class="paragraph"/><h4>X-Grails-Resources-Original-Srcヘッダー <div class="hidden-block">X-Grails-Resources-Original-Src Header </div></h4><p class="paragraph"/><div class="hidden-block">Every resource served in development mode will have the X-Grails-Resources-Original-Src: header added, indicating the original source file(s) that make up the response.</div>
開発(development)モードでのリソースには、レスポンスを構成した元のリソースファイルを示す、X-Grails-Resources-Original-Src:ヘッダーが追加されています。<p class="paragraph"/><h4>デバッグフラグを追加 <div class="hidden-block">Adding the debug flag </div></h4><p class="paragraph"/><div class="hidden-block">If you add a query parameter <strong class="bold">_debugResources=y</strong> to your URL and request the page, Resources will bypass any processing so that you can see your original source files.</div>
クエリパラメータ <strong class="bold">_debugResources=y</strong> をURLに追加してページをリクエストすると、Resourcesプラグインはバイパスされて元のソースファイルを見ることができます。<p class="paragraph"/><div class="hidden-block">This also adds a unique timestamp to all your resource URLs, to defeat any caching that browsers may use. This means that you should always see your very latest code when you reload the page.</div>
さらにこの機能では、ユニークなタイムスタンプを全てのリソースに追加することでブラウザにキャッシュされるのを阻止します。したがってページをリロードするたびに最新のコードを参照することになります。<p class="paragraph"/><h4>常にデバッグを有効にする <div class="hidden-block">Turning on debug all the time </div></h4><p class="paragraph"/><div class="hidden-block">You can turn on the aforementioned debug mechanism without requiring a query parameter, but turning it on in Config.groovy:</div>
前途したデバッグ機能をクエリパラメータ無しで有効にするには、以下のようにConfig.groovyで設定します:<p class="paragraph"/><div class="code"><pre>grails.resources.debug = <span class="java&#45;keyword">true</span></pre></div><p class="paragraph"/><div class="hidden-block">You can of course set this per-environment.</div>
もちろんこの設定は環境ごとに定義できます。


<a name="7.2.5.7 Preventing processing of resources"><!-- Legacy link --></a>
<h2 id="preventingProcessingOfResources">7.2.5.7 リソース生成・変換処理を防ぐ</h2>
<div class="hidden-block">Sometimes you do not want a resource to be processed in a particular way, or even at all. Occasionally you may also want to disable all resource mapping.</div>
特定のリソースだけ変換処理を行わない事もあります。時折リソースマッピングを無効にしたいこともあります。<p class="paragraph"/><h4>個々のリソースの特定のマッパー処理を防ぐ <div class="hidden-block">Preventing the application of a specific mapper to an individual resource </div></h4><p class="paragraph"/><div class="hidden-block">All resource declarations support a convention of noXXXX:true where XXXX is a mapper name.</div>
全てのリソース宣言では、XXXXがマッパー名称とすると、noXXXX:trueのような規約に対応しています。<p class="paragraph"/><div class="hidden-block">So for example to prevent the "hashandcache" mapper from being applied to a resource (which renames and moves it, potentially breaking relative links written in JavaScript code), you would do this:</div>
例として、リソースに適用される"hashandcache"マッパーの処理を防ぐ場合は:<p class="paragraph"/><div class="code"><pre>modules = &#123;
    forms &#123;
        resource url: '/css/forms.css', nohashandcache: <span class="java&#45;keyword">true</span>
        resource url: '/js/forms.js', nohashandcache: <span class="java&#45;keyword">true</span>
    &#125;
&#125;</pre></div><p class="paragraph"/><h4>特定のマッパーでの、パス、ファイルタイプの除外と包含 <div class="hidden-block">Excluding/including paths and file types from specific mappers </div></h4><p class="paragraph"/><div class="hidden-block">Mappers have includes/excludes Ant patterns to control whether they apply to a given resource. Mappers set sensible defaults for these based on their activity, for example the zipped-resources plugin's "zip" mapper is set to exclude images by default.</div>
マッパーには、Antパターンで対象リソースを制御するincludes/excludes定義があります。各マッパーはそれぞれの動作に対応したふさわしいデフォルトをセットしています。例としてzipped-resourcesプラグインの"zip"マッパーはデフォルトで画像を除外する設定をしています。<p class="paragraph"/><div class="hidden-block">You can configure this in your <code>Config.groovy</code> using the mapper name e.g:</div>
<code>Config.groovy</code>にマッパー名で定義することができます:<p class="paragraph"/><div class="code"><pre>// We wouldn't link to .exe files using Resources but <span class="java&#45;keyword">for</span> the sake of example:
grails.resources.zip.excludes = &#91;'&#42;&#42;/&#42;.zip', '&#42;&#42;/&#42;.exe'&#93;<p class="paragraph"/>// Perhaps <span class="java&#45;keyword">for</span> some reason we want to prevent bundling on <span class="java&#45;quote">"less"</span> CSS files:
grails.resources.bundle.excludes = &#91;'&#42;&#42;/&#42;.less'&#93;</pre></div><p class="paragraph"/><div class="hidden-block">There is also an "includes" inverse. Note that settings these replaces the default includes/excludes for that mapper - it is not additive.</div>
逆の意味の"includes"も使用できます。設定をするとマッパーデフォルトのincludes/excludesを入れ換えるので注意が必要です。<p class="paragraph"/><h4>"ad-hoc"(レガシー)リソースとして扱う物の操作 <div class="hidden-block">Controlling what is treated as an "ad-hoc" (legacy) resource </div></h4><p class="paragraph"/><div class="hidden-block">Ad-hoc resources are those undeclared, but linked to directly in your application <strong class="bold">without</strong> using the Grails or Resources linking tags (resource, img or external).</div>
"ad-hoc"リソースは、宣言されずGrailsまたResourcesのリンク系タグを使用しないで、直接アプリケーションにリンクされているリソースです。<p class="paragraph"/><div class="hidden-block">These may occur with some legacy plugins or code with hardcoded paths in.</div>
古い方式のプラグインやパスがコードに埋め込まれている場合をさします。<p class="paragraph"/><div class="hidden-block">There is a Config.groovy setting <strong class="bold">grails.resources.adhoc.patterns</strong> which defines a list of Servlet API compliant filter URI mappings, which the Resources filter will use to detect such "ad-hoc resource" requests.</div>
サーブレットAPI準拠のフィルタURIマッピングのリストを定義して、どのリクエストを"ad-hoc"リソースとしてResourcesのフィルタが使用するか認識させるConfig.groovy用の設定 <strong class="bold">grails.resources.adhoc.patterns</strong> があります。<p class="paragraph"/><div class="hidden-block">By default this is set to:</div>
デフォルトでは次のようにセットされています:
<div class="code"><pre>grails.resources.adhoc.patterns = &#91;'images/&#42;', '&#42;.js', '&#42;.css'&#93;</pre></div>


<a name="7.2.5.8 Other Resources-aware plugins"><!-- Legacy link --></a>
<h2 id="otherResourcesPlugins">7.2.5.8 リソース関連のプラグイン</h2>
<div class="hidden-block">At the time of writing, the following plugins include support for the Resources framework:</div>
現時点でのリソースフレームワークに対応したプラグイン:
<ul class="star">
<li><a href="http://grails.org/plugin/jquery" target="blank">jquery</a></li>
<li><a href="http://grails.org/plugin/jquery-ui" target="blank">jquery-ui</a></li>
<li><a href="http://grails.org/plugin/blueprint" target="blank">blueprint</a></li>
<li><a href="http://grails.org/plugin/lesscss-resources" target="blank">lesscss-resources</a></li>
<li><a href="http://grails.org/plugin/zipped-resources" target="blank">zipped-resources</a></li>
<li><a href="http://grails.org/plugin/cached-resources" target="blank">cached-resources</a></li>
</ul><p class="paragraph"/>

<a name="7.2.6 Sitemesh Content Blocks"><!-- Legacy link --></a>
<h2 id="sitemeshContentBlocks">7.2.6 Sitemeshコンテントブロック</h2>
<div class="hidden-block">Although it is useful to decorate an entire page sometimes you may find the need to decorate independent sections of your site. To do this you can use content blocks. To get started, partition the page to be decorated using the <code>&#60;content&#62;</code> tag:</div>
サイト全体のページをデコレートするのに便利ですが、ページ内のブロック(パーツ)をデコレートする必要も有ると思います。この場合はコンテントブロックを使用します。コンテントブロックを使用するには<code>&#60;content&#62;</code>タグでページ内をブロック分割します。<p class="paragraph"/><div class="hidden-block">
&#8230; draw the navbar here&#8230;
&#8230; draw the header here&#8230;
&#8230; draw the footer here&#8230;
&#8230; draw the body here&#8230;
</div><p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;content tag=<span class="xml&#45;quote">"navbar"</span>&#62;</span>
&#8230; ここにナビゲーションバーコンテンツ&#8230;
<span class="xml&#45;tag">&#60;/content&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;content tag=<span class="xml&#45;quote">"header"</span>&#62;</span>
&#8230; ここにヘッダーコンテンツ&#8230;
<span class="xml&#45;tag">&#60;/content&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;content tag=<span class="xml&#45;quote">"footer"</span>&#62;</span>
&#8230; ここにフッターコンテンツ&#8230;
<span class="xml&#45;tag">&#60;/content&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;content tag=<span class="xml&#45;quote">"body"</span>&#62;</span>
&#8230; ここにボディコンテンツ&#8230;
<span class="xml&#45;tag">&#60;/content&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Then within the layout you can reference these components and apply individual layouts to each:</div>
そしてレイアウト側には、それぞれのコンポーネントの参照を配置します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;html&#62;</span>
    <span class="xml&#45;tag">&#60;body&#62;</span>
        <span class="xml&#45;tag">&#60;div id=<span class="xml&#45;quote">"header"</span>&#62;</span>
            <span class="xml&#45;tag">&#60;g:applyLayout name=<span class="xml&#45;quote">"headerLayout"</span>&#62;</span>
                <span class="xml&#45;tag">&#60;g:pageProperty name=<span class="xml&#45;quote">"page.header"</span> /&#62;</span>
            <span class="xml&#45;tag">&#60;/g:applyLayout&#62;</span>
        <span class="xml&#45;tag">&#60;/div&#62;</span>
        <span class="xml&#45;tag">&#60;div id=<span class="xml&#45;quote">"nav"</span>&#62;</span>
            <span class="xml&#45;tag">&#60;g:applyLayout name=<span class="xml&#45;quote">"navLayout"</span>&#62;</span>
                <span class="xml&#45;tag">&#60;g:pageProperty name=<span class="xml&#45;quote">"page.navbar"</span> /&#62;</span>
            <span class="xml&#45;tag">&#60;/g:applyLayout&#62;</span>
        <span class="xml&#45;tag">&#60;/div&#62;</span>
        <span class="xml&#45;tag">&#60;div id=<span class="xml&#45;quote">"body"</span>&#62;</span>
            <span class="xml&#45;tag">&#60;g:applyLayout name=<span class="xml&#45;quote">"bodyLayout"</span>&#62;</span>
                <span class="xml&#45;tag">&#60;g:pageProperty name=<span class="xml&#45;quote">"page.body"</span> /&#62;</span>
            <span class="xml&#45;tag">&#60;/g:applyLayout&#62;</span>
        <span class="xml&#45;tag">&#60;/div&#62;</span>
        <span class="xml&#45;tag">&#60;div id=<span class="xml&#45;quote">"footer"</span>&#62;</span>
            <span class="xml&#45;tag">&#60;g:applyLayout name=<span class="xml&#45;quote">"footerLayout"</span>&#62;</span>
                <span class="xml&#45;tag">&#60;g:pageProperty name=<span class="xml&#45;quote">"page.footer"</span> /&#62;</span>
            <span class="xml&#45;tag">&#60;/g:applyLayout&#62;</span>
        <span class="xml&#45;tag">&#60;/div&#62;</span>
    <span class="xml&#45;tag">&#60;/body&#62;</span>
<span class="xml&#45;tag">&#60;/html&#62;</span></pre></div>


<a name="7.2.7 Making Changes to a Deployed Application"><!-- Legacy link --></a>
<h2 id="makingChangesToADeployedApplication">7.2.7 デプロイされたアプリケーションへの変更</h2>
<div class="hidden-block">One of the main issues with deploying a Grails application (or typically any servlet-based one) is that any change to the views requires that you redeploy your whole application. If all you want to do is fix a typo on a page, or change an image link, it can seem like a lot of unnecessary work. For such simple requirements, Grails does have a solution: the  <code>grails.gsp.view.dir</code>  configuration setting.</div>
Grailsアプリケーションをデプロイする際に起きる大きな問題の一つに(または他のサーブレットベースのアプリケーションも含む)、ビューを変更するたびにアプリケーション全体を再デプロイする必要がある事です。もし誤植や画像リンクの修正など有る場合は無駄な作業が発生します。そのような事を発生させないために、Grailsには、<code>grails.gsp.view.dir</code>定義という解決方法が存在します。<p class="paragraph"/><div class="hidden-block">How does this work? The first step is to decide where the GSP files should go. Let's say we want to keep them unpacked in a  <code>/var/www/grails/my-app</code>  directory. We add these two lines to  <code>grails-app/conf/Config.groovy</code> :</div>
はじめに、何処にGSPを配置するかを決めましょう。<code>/var/www/grails/my-app</code>の階層はパックしないこととします。以下の2行を<code>grails-app/conf/Config.groovy</code>に追加します:<p class="paragraph"/><div class="code"><pre>grails.gsp.enable.reload = <span class="java&#45;keyword">true</span>
grails.gsp.view.dir = <span class="java&#45;quote">"/<span class="java&#45;keyword">var</span>/www/grails/my&#45;app/"</span></pre></div>
<div class="hidden-block">The first line tells Grails that modified GSP files should be reloaded at runtime. If you don't have this setting, you can make as many changes as you like but they won't be reflected in the running application until you restart. The second line tells Grails where to load the views and layouts from.</div>
最初の行は変更されたGSPファイルはリロードするという指定です。この指定をしないと、GSPが更新されても再起動するまで反映されません。2行目は何処にあるビューとレイアウトをロードするかの指定です。<p class="paragraph"/><blockquote class="note">
<div class="hidden-block">The trailing slash on the  <code>grails.gsp.view.dir</code>  value is important! Without it, Grails will look for views in the parent directory.</div>
<code>grails.gsp.view.dir</code>の最後に付いているスラッシュは重要です。これが無いとGrailsが親ディレクトリにビューを探しに行きます。
</blockquote><p class="paragraph"/><div class="hidden-block">Setting "grails.gsp.view.dir" is optional. If it's not specified, you can update files directly to the application server's deployed war directory. Depending on the application server, these files might get overwritten when the server is restarted. Most application servers support "exploded war deployment" which is recommended in this case.</div>
"grails.gsp.view.dir"の設定は省略可能です。省略した場合はwarがデプロイされたディレクトリのファイルを変更できます。アプリケーションサーバによりますが、サーバのリスタート時にこれらのファイルは上書きされてしまいます。ホット再デプロイメントをサポートしたアプリケーションサーバの場合にのみ推奨します。<p class="paragraph"/><div class="hidden-block">With those settings in place, all you need to do is copy the views from your web application to the external directory. On a Unix-like system, this would look something like this:</div>
この場合に、サーバ内で設定をするには、Webアプリケーションのディレクトリから別のディレクトリへ全てのビューをコピーします。Unix系のシステムでは以下のように作業します:<p class="paragraph"/><div class="code"><pre>mkdir &#45;p /<span class="java&#45;keyword">var</span>/www/grails/my&#45;app/grails&#45;app/views
cp &#45;R grails&#45;app/views/&#42; /<span class="java&#45;keyword">var</span>/www/grails/my&#45;app/grails&#45;app/views</pre></div>
<div class="hidden-block">The key point here is that you must retain the view directory structure, including the  <code>grails-app/views</code>  bit. So you end up with the path  <code>/var/www/grails/my-app/grails-app/views/...</code> .</div>
ポイントとなるのは、<code>grails-app/views</code>を含んだ全てのビューディレクトリ階層を持たなくてはならない所です。この場合だとパスは、<code>/var/www/grails/my-app/grails-app/views/...</code>となります。<p class="paragraph"/><div class="hidden-block">One thing to bear in mind with this technique is that every time you modify a GSP, it uses up permgen space. So at some point you will eventually hit "out of permgen space" errors unless you restart the server. So this technique is not recommended for frequent or large changes to the views.</div>
ひとつ気にかけてほしいのが、GSPを更新するたびに、permgenスペースを多く使用するという事です。それにより再起動するのと比べて、そのうち"out of permgen space"エラーが起こります。したがって、常に更新される物や、ビューへの大きな変更には推奨できません。<p class="paragraph"/><div class="hidden-block">There are also some System properties to control GSP reloading:</div>
GSPリロードをコントロールするシステムプロパティも提供しています:
<div class="hidden-block">
<table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th><strong class="bold">Name</strong></th><th><strong class="bold">Description</strong></th><th><strong class="bold">Default</strong></th></tr><tr class="table-odd"><td>grails.gsp.enable.reload</td><td>altervative system property for enabling the GSP reload mode without changing Config.groovy</td><td>&#160;</td></tr><tr class="table-even"><td>grails.gsp.reload.interval</td><td>interval between checking the lastmodified time of the gsp source file, unit is milliseconds</td><td>5000</td></tr><tr class="table-odd"><td>grails.gsp.reload.granularity</td><td>the number of milliseconds leeway to give before deciding a file is out of date. this is needed because different roundings usually cause a 1000ms difference in lastmodified times</td><td>1000</td></tr></table>
</div>
<table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th><strong class="bold">名称</strong></th><th><strong class="bold">説明</strong></th><th><strong class="bold">既存値</strong></th></tr><tr class="table-odd"><td>grails.gsp.enable.reload</td><td>Config.groovy変更せずにGSPリロードモードを許可にします。</td><td>&#160;</td></tr><tr class="table-even"><td>grails.gsp.reload.interval</td><td>gspソースファイルの更新を確認するインターバル。ミリ秒で指定。</td><td>5000</td></tr><tr class="table-odd"><td>grails.gsp.reload.granularity</td><td>ファイルが更新されたかを判断する時間のゆとり。ミリ秒で指定。</td><td>1000</td></tr></table><p class="paragraph"/><div class="hidden-block">GSP reloading is supported for precompiled GSPs since Grails 1.3.5 .</div>
プリコンパイルGSPに対してのGSPリロードはGrails 1.3.5からサポートされています。


<a name="7.2.8 GSP Debugging"><!-- Legacy link --></a>
<h2 id="GSPDebugging">7.2.8 GSPデバッグ</h2>
<h4>生成されたソースコードを表示する <div class="hidden-block">Viewing the generated source code </div></h4><p class="paragraph"/><div class="hidden-block">
<ul class="star">
<li>Adding "?showSource=true" or "&#38;showSource=true" to the url shows the generated Groovy source code for the view instead of rendering it. It won't show the source code of included templates. This only works in development mode</li>
<li>The saving of all generated source code can be activated by setting the property "grails.views.gsp.keepgenerateddir" (in Config.groovy) . It must point to a directory that exists and is writable.</li>
<li>During "grails war" gsp pre-compilation, the generated source code is stored in grails.project.work.dir/gspcompile (usually in ~/.grails/(grails_version)/projects/(project name)/gspcompile).</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li>URLに、 "?showSource=true" または、"&#38;showSource=true"を追加するとページ描写の代わりに、ビュー用に生成されたGroovyコードが参照できます。但し含んだテンプレートのコードは含まれません。開発モードのみで動作します。</li>
<li>Config.groovyにプロパティ"grails.views.gsp.keepgenerateddir"を指定すると生成ファイルが指定された場所に保存されます。</li>
<li>"grails war"でのgspプリコンパイル時に、生成されたソースコードがgrails.project.work.dir/gspcompileに保存されます。(通常は~/.grails/(grails_version)/projects/(project name)/gspcompileです。)</li>
</ul><p class="paragraph"/><h4>デバッガでGSPコードをデバッグ <div class="hidden-block">Debugging GSP code with a debugger </div></h4><p class="paragraph"/><div class="hidden-block">
<ul class="star">
<li>See <a href="http://contraptionsforprogramming.blogspot.com/2010/08/debuggable-gsps-in-springsource-tool.html" target="blank">Debugging GSP in STS</a></li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li><a href="http://contraptionsforprogramming.blogspot.com/2010/08/debuggable-gsps-in-springsource-tool.html" target="blank">Debugging GSP in STS</a> を参照</li>
</ul><p class="paragraph"/><h4>使用されたテンプレートの情報を参照 <div class="hidden-block">Viewing information about templates used to render a single url </div></h4><p class="paragraph"/><div class="hidden-block">GSP templates are reused in large web applications by using the <code>g:render</code> taglib. Several small templates can be used to render a single page.
It might be hard to find out what GSP template actually renders the html seen in the result.
The debug templates -feature adds html comments to the output. The comments contain debug information about gsp templates used to render the page.</div>
規模の大きいなWebアプリケーションでは、<code>g:render</code>タグを使用してGSPテンプレートは再利用されます。幾つかの小さなテンプレートが１つのページで使われる事もあります。どの部分でGSPテンプレートが実際にHTMLを描写したか探すのは大変だと思います。テンプレートデバッグ機能ではhtmlコメントでGSPテンプレートのデバッグ情報を提供します。<p class="paragraph"/>
<div class="hidden-block">Usage is simple: append "?debugTemplates" or "&#38;debugTemplates" to the url and view the source of the result in your browser.
"debugTemplates" is restricted to development mode. It won't work in production.</div>
使用方法は簡単、URLに"?debugTemplates" または "&#38;debugTemplates"を追加して表示されたページのソースを参照します。"debugTemplates"は開発モードのみで動作します。<p class="paragraph"/><div class="hidden-block">Here is an example of comments added by debugTemplates :</div>
debugTemplatesでは以下のようなコメントが追記されます:<p class="paragraph"/><div class="code"><pre>&#60;!&#45;&#45; GSP &#35;2 START template: /home/.../views/_carousel.gsp
     precompiled: <span class="java&#45;keyword">false</span> lastmodified: &#8230; &#45;&#45;&#62;
.
.
.
&#60;!&#45;&#45; GSP &#35;2 END template: /home/.../views/_carousel.gsp
     rendering time: 115 ms &#45;&#45;&#62;</pre></div><p class="paragraph"/><div class="hidden-block">Each comment block has a unique id so that you can find the start &#38; end of each template call.</div>
それぞれのコメントブロックには番号を持っていて、テンプレートの開始と終了を探し安くしてあります。


<a name="7.3 Tag Libraries"><!-- Legacy link --></a>
<h2 id="taglibs">7.3 タグライブラリ</h2>
<div class="hidden-block">Like <a href="http://www.oracle.com/technetwork/java/javaee/jsp/index.html" target="blank">Java Server Pages</a> (JSP), GSP supports the concept of custom tag libraries. Unlike JSP, Grails' tag library mechanism is simple, elegant and completely reloadable at runtime.</div>
<a href="http://www.oracle.com/technetwork/java/javaee/jsp/index.html" target="blank">Java Server Pages</a> (JSP)のように、GSPでもカスタムタグライブラリをサポートしています。JSPと違いGrailsでのタグライブラリは単純簡潔です。<p class="paragraph"/><div class="hidden-block">Quite simply, to create a tag library create a Groovy class that ends with the convention <code>TagLib</code> and place it within the <code>grails-app/taglib</code> directory:</div>
タグライブラリを作成するには、<code>grails-app/taglib</code>ディレクトリに、名称の最後が<code>TagLib</code>となるGroovyクラスを作成します:<p class="paragraph"/><div class="code"><pre>class SimpleTagLib &#123;<p class="paragraph"/>&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Now to create a tag create a Closure property that takes two arguments: the tag attributes and the body content:</div>
タグライブラリクラスを作成したら、２つの引数(属性とタグ内容)を受け取るクロージャを追加してタグを作成します:<p class="paragraph"/><div class="code"><pre>class SimpleTagLib &#123;
    def simple = &#123; attrs, body &#45;&#62;<p class="paragraph"/>    &#125;
&#125;</pre></div><p class="paragraph"/>The <code>attrs</code> argument is a Map of the attributes of the tag, whilst the <code>body</code> argument is a Closure that returns the body content when invoked:
引数<code>attrs</code>はタグ属性のMapです。引数<code>body</code>はタグ内容のコンテンツを呼び出すクロージャです:<p class="paragraph"/><div class="code"><pre>class SimpleTagLib &#123;
    def emoticon = &#123; attrs, body &#45;&#62;
       out &#60;&#60; body() &#60;&#60; (attrs.happy == '<span class="java&#45;keyword">true</span>' ? <span class="java&#45;quote">" :&#45;)"</span> : <span class="java&#45;quote">" :&#45;("</span>)
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">As demonstrated above there is an implicit <code>out</code> variable that refers to the output <code>Writer</code> which you can use to append content to the response. Then you can reference the tag inside your GSP; no imports are necessary:</div>
上記の例では、レスポンスを出力する<code>Writer</code>を参照する変数<code>out</code>に対してコンテンツを追加しています。ここまで作成したら、以下のように、GSPの中でタグをそのまま参照します。importは必要ありません。:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:emoticon happy=<span class="xml&#45;quote">"true"</span>&#62;</span>Hi John<span class="xml&#45;tag">&#60;/g:emoticon&#62;</span></pre></div><p class="paragraph"/><blockquote class="note">
<div class="hidden-block">To help IDEs like SpringSource Tool Suite (STS) and others autocomplete tag attributes, you should add Javadoc comments to your tag closures with <code>&#64;attr</code> descriptions. Since taglibs use Groovy code it can be difficult to reliably detect all usable attributes.</div>
タグリブはGroovyコードを使用しているため、タグで使用可能な属性全てを認識することは困難です。SpringSource Tool Suite (STS)等のIDEでの補完機能に対しての手助けとして、タグクロージャのJavadocコメント内に<code>&#64;attr</code>を含めましょう。<p class="paragraph"/><div class="hidden-block">For example:</div>
例として:<p class="paragraph"/><div class="code"><pre>class SimpleTagLib &#123;<p class="paragraph"/>    /&#42;&#42;
     &#42; Renders the body with an emoticon.
     &#42;
     &#42; @attr happy whether to show a happy emoticon ('<span class="java&#45;keyword">true</span>') or
     &#42; a sad emoticon ('<span class="java&#45;keyword">false</span>')
     &#42;/
    def emoticon = &#123; attrs, body &#45;&#62;
       out &#60;&#60; body() &#60;&#60; (attrs.happy == '<span class="java&#45;keyword">true</span>' ? <span class="java&#45;quote">" :&#45;)"</span> : <span class="java&#45;quote">" :&#45;("</span>)
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">and any mandatory attributes should include the REQUIRED keyword, e.g.</div>
必須条件の属性には、キーワードREQUIREDを指定します。<p class="paragraph"/><div class="code"><pre>class SimpleTagLib &#123;<p class="paragraph"/>    /&#42;&#42;
     &#42; Creates a <span class="java&#45;keyword">new</span> password field.
     &#42;
     &#42; @attr name REQUIRED the field name
     &#42; @attr value the field value
     &#42;/
    def passwordField = &#123; attrs &#45;&#62;
        attrs.type = <span class="java&#45;quote">"password"</span>
        attrs.tagName = <span class="java&#45;quote">"passwordField"</span>
        fieldImpl(out, attrs)
    &#125;
&#125;</pre></div>
</blockquote>



<h2 id="taglibVariablesAndScopes">7.3.1 変数とスコープ</h2>
<div class="hidden-block">Within the scope of a tag library there are a number of pre-defined variables including:</div>
タグライブラリのスコープには、多数の前定義された変数があります:<p class="paragraph"/><div class="hidden-block">
<ul class="star">
<li><code>actionName</code> - The currently executing action name</li>
<li><code>controllerName</code> - The currently executing controller name</li>
<li><code>flash</code> - The <a href="../ref/Controllers/flash.html" class="controllers">flash</a> object</li>
<li><code>grailsApplication</code> - The <a href="http://grails.org/doc/latest/api/org/codehaus/groovy/grails/commons/GrailsApplication.html" class="api">GrailsApplication</a> instance</li>
<li><code>out</code> - The response writer for writing to the output stream</li>
<li><code>pageScope</code> - A reference to the <a href="../ref/Tag Libraries/pageScope.html" class="tagLibraries">pageScope</a> object used for GSP rendering (i.e. the binding)</li>
<li><code>params</code> - The <a href="../ref/Controllers/params.html" class="controllers">params</a> object for retrieving request parameters</li>
<li><code>pluginContextPath</code> - The context path to the plugin that contains the tag library</li>
<li><code>request</code> - The <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpServletRequest.html" class="api">HttpServletRequest</a> instance</li>
<li><code>response</code> - The <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpServletResponse.html" class="api">HttpServletResponse</a> instance</li>
<li><code>servletContext</code> - The <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/ServletContext.html" class="api">javax.servlet.ServletContext</a> instance</li>
<li><code>session</code> - The <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpSession.html" class="api">HttpSession</a> instance</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li><code>actionName</code> - 現在実行中のアクション名</li>
<li><code>controllerName</code> - 現在実行中のコントローラ名</li>
<li><code>flash</code> - <a href="../ref/Controllers/flash.html" class="controllers">flash</a>オブジェクト</li>
<li><code>grailsApplication</code> - <a href="http://grails.org/doc/latest/api/org/codehaus/groovy/grails/commons/GrailsApplication.html" class="api">GrailsApplication</a>インスタンス</li>
<li><code>out</code> - 出力用のレスポンスライター</li>
<li><code>pageScope</code> - GSP描写で使用する<a href="../ref/Tag Libraries/pageScope.html" class="tagLibraries">pageScope</a>オブジェクトへの参照</li>
<li><code>params</code> - リクエストパラメータ取得用の<a href="../ref/Controllers/params.html" class="controllers">params</a>オブジェクト</li>
<li><code>pluginContextPath</code> - タグライブラリを含むプラグインへのコンテキストパス。</li>
<li><code>request</code> - <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpServletRequest.html" class="api">HttpServletRequest</a>インスタンス</li>
<li><code>response</code> - <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpServletResponse.html" class="api">HttpServletResponse</a>インスタンス</li>
<li><code>servletContext</code> - <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/ServletContext.html" class="api">javax.servlet.ServletContext</a> インスタンス</li>
<li><code>session</code> - <a href="http://download.oracle.com/javaee/1.4/api/javax/servlet/http/HttpSession.html" class="api">HttpSession</a>インスタンス</li>
</ul><p class="paragraph"/>

<a name="7.3.2 Simple Tags"><!-- Legacy link --></a>
<h2 id="simpleTags">7.3.2 簡単なタグ</h2>
<div class="hidden-block">As demonstrated in the previous example it is easy to write simple tags that have no body and just output content. Another example is a <code>dateFormat</code> style tag:</div>
前の説明で、簡単にコンテンツを出力するタグは簡単に記述できると説明しました。他の例として<code>dateFormat</code>タグを紹介します:<p class="paragraph"/><div class="code"><pre>def dateFormat = &#123; attrs, body &#45;&#62;
    out &#60;&#60; <span class="java&#45;keyword">new</span> java.text.SimpleDateFormat(attrs.format).format(attrs.date)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">The above uses Java's <code>SimpleDateFormat</code> class to format a date and then write it to the response. The tag can then be used within a GSP as follows:</div>
この例ではJavaの<code>SimpleDateFormat</code>クラスを使ってフォーマットした日付をレスポンスに出力します。このタグは、GSPで次のように使用します:<p class="paragraph"/>
<div class="code"><pre><span class="xml&#45;tag">&#60;g:dateFormat format=<span class="xml&#45;quote">"dd&#45;MM&#45;yyyy"</span> date=<span class="xml&#45;quote">"$&#123;new Date()&#125;"</span> /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">With simple tags sometimes you need to write HTML mark-up to the response. One approach would be to embed the content directly:</div>
単純なタグでHTMLマークアップをレスポンスすることもあるでしょう。一つのアプローチとして直接コンテンツを埋め込む事ができます:<p class="paragraph"/>
<div class="code"><pre>def formatBook = &#123; attrs, body &#45;&#62;
    out &#60;&#60; <span class="java&#45;quote">"&#60;div id=&#34;$&#123;attrs.book.id&#125;&#34;&#62;"</span>
    out &#60;&#60; <span class="java&#45;quote">"Title : $&#123;attrs.book.title&#125;"</span>
    out &#60;&#60; <span class="java&#45;quote">"&#60;/div&#62;"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Although this approach may be tempting it is not very clean. A better approach would be to reuse the <a href="../ref/Tags/render.html" class="tags">render</a> tag:</div>
上記の方法はあまりきれいでは無いので、実際には、<a href="../ref/Tags/render.html" class="tags">render</a>タグを使用すると良いでしょう:<p class="paragraph"/><div class="code"><pre>def formatBook = &#123; attrs, body &#45;&#62;
    out &#60;&#60; render(template: <span class="java&#45;quote">"bookTemplate"</span>, model: &#91;book: attrs.book&#93;)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">And then have a separate GSP template that does the actual rendering.</div>
このようにして、実際に描写されるGSPテンプレートと切り離せます.


<a name="7.3.3 Logical Tags"><!-- Legacy link --></a>
<h2 id="logicalTags">7.3.3 制御タグ</h2>
<div class="hidden-block">You can also create logical tags where the body of the tag is only output once a set of conditions have been met. An example of this may be a set of security tags:</div>
条件に合ったときのみにタグ内容を出力する制御タグを作成できます。セキュリティタグを例とします:<p class="paragraph"/><div class="code"><pre>def isAdmin = &#123; attrs, body &#45;&#62;
    def user = attrs.user
    <span class="java&#45;keyword">if</span> (user &#38;&#38; checkUserPrivs(user)) &#123;
        out &#60;&#60; body()
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">The tag above checks if the user is an administrator and only outputs the body content if he/she has the correct set of access privileges:</div>
この例ではアクセスしたユーザをチェックして、管理者であった場合のみ内容を出力します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:isAdmin user=<span class="xml&#45;quote">"$&#123;myUser&#125;"</span>&#62;</span>
    // some restricted content
<span class="xml&#45;tag">&#60;/g:isAdmin&#62;</span></pre></div>


<a name="7.3.4 Iterative Tags"><!-- Legacy link --></a>
<h2 id="iterativeTags">7.3.4 イテレートタグ</h2>
<div class="hidden-block">Iterative tags are easy too, since you can invoke the body multiple times:</div>
タグ内容を複数回実行するような、イテレートタグも簡単に作れます:<p class="paragraph"/><div class="code"><pre>def repeat = &#123; attrs, body &#45;&#62;
    attrs.times?.toInteger()?.times &#123; num &#45;&#62;
        out &#60;&#60; body(num)
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">In this example we check for a <code>times</code> attribute and if it exists convert it to a number, then use Groovy's <code>times</code> method to iterate the specified number of times:</div>
この例では、属性<code>times</code>を有無や数値なのかを確認し、その数値でGroovyの<code>times</code>メソッドを実行して、与えられた数値の回数、実行内容を繰り返します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:repeat times=<span class="xml&#45;quote">"3"</span>&#62;</span>
<span class="xml&#45;tag">&#60;p&#62;</span>Repeat this 3 times! Current repeat = $&#123;it&#125;<span class="xml&#45;tag">&#60;/p&#62;</span>
<span class="xml&#45;tag">&#60;/g:repeat&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Notice how in this example we use the implicit <code>it</code> variable to refer to the current number. This works because when we invoked the body we passed in the current value inside the iteration:</div>
ここでは、数値を参照した変数<code>it</code>の使い方を紹介しています。これはbody実行時にイテレーションの数値をbodyに渡すことで動作しています。:<p class="paragraph"/><div class="code"><pre>out &#60;&#60; body(num)</pre></div><p class="paragraph"/><div class="hidden-block">That value is then passed as the default variable <code>it</code> to the tag. However, if you have nested tags this can lead to conflicts, so you should should instead name the variables that the body uses:</div>
この値はタグ内の変数<code>it</code>に渡されます。ただしタグをネストした場合は名称の衝突が起きるため違う名称を指定できるようにする必要があります。:<p class="paragraph"/><div class="code"><pre>def repeat = &#123; attrs, body &#45;&#62;
    def <span class="java&#45;keyword">var</span> = attrs.<span class="java&#45;keyword">var</span> ?: <span class="java&#45;quote">"num"</span>
    attrs.times?.toInteger()?.times &#123; num &#45;&#62;
        out &#60;&#60; body((<span class="java&#45;keyword">var</span>):num)
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Here we check if there is a <code>var</code> attribute and if there is use that as the name to pass into the body invocation on this line:</div>
この例では、属性varが存在すれば、その値を名称として使用できるようにbodyに渡して実行します。<p class="paragraph"/><div class="code"><pre>out &#60;&#60; body((<span class="java&#45;keyword">var</span>):num)</pre></div><p class="paragraph"/><blockquote class="note">
<div class="hidden-block">Note the usage of the parenthesis around the variable name. If you omit these Groovy assumes you are using a String key and not referring to the variable itself.</div>
変数名パーレン使用時の注意点です。これを省略するとGroovyは文字列キーとして解釈してしまい変数として参照できません。
</blockquote><p class="paragraph"/><div class="hidden-block">Now we can change the usage of the tag as follows:</div>
これで、以下のようにタグで使用できます:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:repeat times=<span class="xml&#45;quote">"3"</span> var=<span class="xml&#45;quote">"j"</span>&#62;</span>
<span class="xml&#45;tag">&#60;p&#62;</span>Repeat this 3 times! Current repeat = $&#123;j&#125;<span class="xml&#45;tag">&#60;/p&#62;</span>
<span class="xml&#45;tag">&#60;/g:repeat&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Notice how we use the <code>var</code> attribute to define the name of the variable <code>j</code> and then we are able to reference that variable within the body of the tag.</div>
こうすることで、<code>var</code>属性に指定した変数名<code>j</code>をタグ内部で変数として参照することができます。


<a name="7.3.5 Tag Namespaces"><!-- Legacy link --></a>
<h2 id="namespaces">7.3.5 タグネームスペース</h2>
<div class="hidden-block">By default, tags are added to the default Grails namespace and are used with the <code>g:</code> prefix in GSP pages. However, you can specify a different namespace by adding a static property to your <code>TagLib</code> class:</div>
デフォルトでのタグは、Grailsのデフォルトネームスペースに追加され、GSPでは<code>g:</code>接頭辞が使用できます。ネームスペースはstaticプロパティ<code>namespace</code>を<code>TagLib</code>クラスに追加する事で、独自に定義することが可能です。:<p class="paragraph"/><div class="code"><pre>class SimpleTagLib &#123;
    <span class="java&#45;keyword">static</span> namespace = <span class="java&#45;quote">"my"</span><p class="paragraph"/>    def example = &#123; attrs &#45;&#62;
        &#8230;
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Here we have specified a <code>namespace</code> of <code>my</code> and hence the tags in this tag lib must then be referenced from GSP pages like this:</div>
この例では<code>namespace</code>を<code>my</code>と定義したので、このタグを参照するにはGSPページ内では以下のように参照できます:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;my:example name=<span class="xml&#45;quote">"..."</span> /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">where the prefix is the same as the value of the static <code>namespace</code> property. Namespaces are particularly useful for plugins.</div>
これ例で<code>namespace</code>プロパティに設定したものが接頭辞として使用しています。ネームスペースはプラグインでタグ提供を行う際に有用です。<p class="paragraph"/><div class="hidden-block">Tags within namespaces can be invoked as methods using the namespace as a prefix to the method call:</div>
ネームスペース付きタグのメソッドコール時はネームスペースを接頭辞として使用します:<p class="paragraph"/><div class="code"><pre>out &#60;&#60; my.example(name:<span class="java&#45;quote">"foo"</span>)</pre></div><p class="paragraph"/><div class="hidden-block">This works from GSP, controllers or tag libraries </div>
GSP、コントローラ、タグライブラリで使用できます。


<a name="7.3.6 Using JSP Tag Libraries"><!-- Legacy link --></a>
<h2 id="usingJSPTagLibraries">7.3.6 JSPタグライブラリの使用</h2>
<div class="hidden-block">In addition to the simplified tag library mechanism provided by GSP, you can also use JSP tags from GSP. To do so simply declare the JSP to use with the <code>taglib</code> directive:</div>
単純なタグライブラリ機能がGSPで提供されているのに加えて、GSPでは、JSPタグを使用することもできます。使用するには、<code>taglib</code>ディレクティブを定義します。<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;%@ taglib prefix=<span class="xml&#45;quote">"fmt"</span> uri=<span class="xml&#45;quote">"http://java.sun.com/jsp/jstl/fmt"</span> %&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Then you can use it like any other tag:</div>
他のタグと同じように使用できます:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;fmt:formatNumber value=<span class="xml&#45;quote">"$&#123;10&#125;"</span> pattern=<span class="xml&#45;quote">".00"</span>/&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">With the added bonus that you can invoke JSP tags like methods:</div>
さらに追加として、JSPタグをメソッドとして実行可能です:<p class="paragraph"/><div class="code"><pre>$&#123;fmt.formatNumber(value:10, pattern:<span class="java&#45;quote">".00"</span>)&#125;</pre></div>

<a name="7.3.7 Tag return value"><!-- Legacy link --></a>
<h2 id="tagReturnValue">7.3.7 タグの戻り値</h2>
<div class="hidden-block">Since Grails 1.2, a tag library call returns an instance of <code>org.codehaus.groovy.grails.web.util.StreamCharBuffer</code> class by default.
This change improves performance by reducing object creation and optimizing buffering during request processing.
In earlier Grails versions, a <code>java.lang.String</code> instance was returned.</div>
Grails 1.2以降、タグライブラリを呼び出すと、デフォルトでは<code>org.codehaus.groovy.grails.web.util.StreamCharBuffer</code> クラスのインスタンスを返します。
この実装でリクエスト処理時のバッファリング最適化や、オブジェクト生成の減少によりパフォーマンスの向上が行われました。
それ以前のGrailsでは<code>java.lang.String</code>インスタンスを返します。<p class="paragraph"/><div class="hidden-block">Tag libraries can also return direct object values to the caller since Grails 1.2..
Object returning tag names are listed in a static <code>returnObjectForTags</code> property in the tag library class.</div>
さらに、Grails 1.2からは、タグライブラリから直接オブジェクトを返す事が可能です。オブジェクトを返すタグを定義するにはstatic <code>returnObjectForTags</code>プロパティにタグ名称をリストします。<p class="paragraph"/><div class="hidden-block">Example:</div>
例:
<div class="code"><pre>class ObjectReturningTagLib &#123;
    <span class="java&#45;keyword">static</span> namespace = <span class="java&#45;quote">"cms"</span>
    <span class="java&#45;keyword">static</span> returnObjectForTags = &#91;'content'&#93;<p class="paragraph"/>    def content = &#123; attrs, body &#45;&#62;
        CmsContent.findByCode(attrs.code)?.content
    &#125;
&#125;</pre></div>

<a name="7.4 URL Mappings"><!-- Legacy link --></a>
<h2 id="urlmappings">7.4 URLマッピング</h2>
<div class="hidden-block">Throughout the documentation so far the convention used for URLs has been the default of <code>/controller/action/id</code>. However, this convention is not hard wired into Grails and is in fact controlled by a URL Mappings class located at <code>grails-app/conf/UrlMappings.groovy</code>.</div>
ここまでのドキュメント内容では、URLのルールはデフォルトの<code>/controller/action/id</code>を使用しています。このルールはGrailsで必須になっているわけでは無く、<code>grails-app/conf/UrlMappings.groovy</code>に配置されているURLマッピングクラスでコントロールされています。<p class="paragraph"/><div class="hidden-block">The <code>UrlMappings</code> class contains a single property called <code>mappings</code> that has been assigned a block of code:</div>
<code>URLMappings</code>クラスは、コードブロックが定義された<code>mappings</code>というプロパティを持っています。:<p class="paragraph"/><div class="code"><pre>class UrlMappings &#123;
    <span class="java&#45;keyword">static</span> mappings = &#123;
    &#125;
&#125;</pre></div><p class="paragraph"/>

<a name="7.4.1 Mapping to Controllers and Actions"><!-- Legacy link --></a>
<h2 id="mappingToControllersAndActions">7.4.1 コントローラとアクションにマッピング</h2>
<div class="hidden-block">To create a simple mapping simply use a relative URL as the method name and specify named parameters for the controller and action to map to:</div>
簡単なマッピングは、相対URLをメソッド名とするメソッドに、マップ対象のコントローラとアクション名称を、名前付きパラメータ引数として作成します:<p class="paragraph"/><div class="code"><pre><span class="java&#45;quote">"/product"</span>(controller: <span class="java&#45;quote">"product"</span>, action: <span class="java&#45;quote">"list"</span>)</pre></div><p class="paragraph"/><div class="hidden-block">In this case we've mapped the URL <code>/product</code> to the <code>list</code> action of the <code>ProductController</code>. Omit the action definition to map to the default action of the controller:</div>
この例ではURL <code>/product</code>は、<code>ProductController</code>の<code>list</code>アクションにマップ定義したことになります。アクションを省略すると、コントローラのデフォルトアクションにマップ定義できます:<p class="paragraph"/><div class="code"><pre><span class="java&#45;quote">"/product"</span>(controller: <span class="java&#45;quote">"product"</span>)</pre></div><p class="paragraph"/><div class="hidden-block">An alternative syntax is to assign the controller and action to use within a block passed to the method:</div>
他のシンタックスとして、コントローラとアクションを指定したコードブロックをメソッドに渡すこともできます:<p class="paragraph"/><div class="code"><pre><span class="java&#45;quote">"/product"</span> &#123;
    controller = <span class="java&#45;quote">"product"</span>
    action = <span class="java&#45;quote">"list"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Which syntax you use is largely dependent on personal preference. </div>
どちらのシンタックスを使用するかは個人の選択に依存します。<p class="paragraph"/>If you have mappings that all fall under a particular path you can group mappings with the <code>group</code> method:<p class="paragraph"/><div class="code"><pre>group <span class="java&#45;quote">"/product"</span>, &#123;
    <span class="java&#45;quote">"/apple"</span>(controller:<span class="java&#45;quote">"product"</span>, id:<span class="java&#45;quote">"apple"</span>)
    <span class="java&#45;quote">"/htc"</span>(controller:<span class="java&#45;quote">"product"</span>, id:<span class="java&#45;quote">"htc"</span>)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">To rewrite one URI onto another explicit URI (rather than a controller/action pair) do something like this:</div>
URIを明示的なURIへ(コントローラ・アクションを指定するのでは無く)書き換えする場合は:<p class="paragraph"/><div class="code"><pre><span class="java&#45;quote">"/hello"</span>(uri: <span class="java&#45;quote">"/hello.dispatch"</span>)</pre></div><p class="paragraph"/><div class="hidden-block">Rewriting specific URIs is often useful when integrating with other frameworks.</div>
特定のURIへの書き換えは、他のフレームワークと統合する場合に便利です。


<a name="7.4.2 Mapping to REST resources"><!-- Legacy link --></a>
<h2 id="restfulMappings">7.4.2 RESTリソースへのマッピング</h2>
Since Grails 2.3, it possible to create RESTful URL mappings that map onto controllers by convention. The syntax to do so is as follows:<p class="paragraph"/><div class="code"><pre><span class="java&#45;quote">"/books"</span>(resources:'book')</pre></div><p class="paragraph"/>You define a base URI and the name of the controller to map to using the <code>resources</code> parameter. The above mapping will result in the following URLs:<p class="paragraph"/>
<table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th>HTTP Method</th><th>URI</th><th>Grails Action</th></tr><tr class="table-odd"><td>GET</td><td>/books</td><td>index</td></tr><tr class="table-even"><td>GET</td><td>/books/create</td><td>create</td></tr><tr class="table-odd"><td>POST</td><td>/books</td><td>save</td></tr><tr class="table-even"><td>GET</td><td>/books/${id}</td><td>show</td></tr><tr class="table-odd"><td>GET</td><td>/books/${id}/edit</td><td>edit</td></tr><tr class="table-even"><td>PUT</td><td>/books/${id}</td><td>update</td></tr><tr class="table-odd"><td>DELETE</td><td>/books/${id}</td><td>delete</td></tr></table><p class="paragraph"/>If you wish to include or exclude any of the generated URL mappings you can do so with the <code>include</code> or <code>exclude</code> parameter, which accepts the name of the Grails action to include or exclude:<p class="paragraph"/><div class="code"><pre><span class="java&#45;quote">"/books"</span>(resources:'book', exclude:&#91;'delete', 'update'&#93;)<p class="paragraph"/>or<p class="paragraph"/><span class="java&#45;quote">"/books"</span>(resources:'book', include:&#91;'index', 'show'&#93;)</pre></div><p class="paragraph"/><h4>Single resources</h4><p class="paragraph"/>A single resource is a resource for which there is only one (possibly per user) in the system. You can create a single resource using the <code>resource</code> parameter (as oppose to <code>resources</code>):<p class="paragraph"/><div class="code"><pre><span class="java&#45;quote">"/book"</span>(resource:'book')</pre></div><p class="paragraph"/>This results in the following URL mappings:<p class="paragraph"/><table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th>HTTP Method</th><th>URI</th><th>Grails Action</th></tr><tr class="table-odd"><td>GET</td><td>/book</td><td>index</td></tr><tr class="table-even"><td>GET</td><td>/book/create</td><td>create</td></tr><tr class="table-odd"><td>POST</td><td>/book</td><td>save</td></tr><tr class="table-even"><td>GET</td><td>/book</td><td>show</td></tr><tr class="table-odd"><td>GET</td><td>/book/edit</td><td>edit</td></tr><tr class="table-even"><td>PUT</td><td>/book</td><td>update</td></tr><tr class="table-odd"><td>DELETE</td><td>/book</td><td>delete</td></tr></table><p class="paragraph"/>The main difference is that the id is not included in the URL mapping.<p class="paragraph"/><h4>Nested Resources</h4><p class="paragraph"/>You can nest resource mappings to generate child resources. For example:<p class="paragraph"/><div class="code"><pre><span class="java&#45;quote">"/books"</span>(resources:'book') &#123;
  <span class="java&#45;quote">"/authors"</span>(resources:<span class="java&#45;quote">"author"</span>)
&#125;</pre></div><p class="paragraph"/>The above will result in the following URL mappings:<p class="paragraph"/><table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th>HTTP Method</th><th>URL</th><th>Grails Action</th></tr><tr class="table-odd"><td>GET</td><td>/books/${bookId}/authors</td><td>index</td></tr><tr class="table-even"><td>GET</td><td>/books/${bookId}/authors/create</td><td>create</td></tr><tr class="table-odd"><td>POST</td><td>/books/${bookId}/authors</td><td>save</td></tr><tr class="table-even"><td>GET</td><td>/books/${bookId}/authors/${id}</td><td>show</td></tr><tr class="table-odd"><td>GET</td><td>/books/${bookId}/authors/edit/${id}</td><td>edit</td></tr><tr class="table-even"><td>PUT</td><td>/books/${bookId}/authors/${id}</td><td>update</td></tr><tr class="table-odd"><td>DELETE</td><td>/books/${bookId}/authors/${id}</td><td>delete</td></tr></table><p class="paragraph"/>You can also nest regular URL mappings within a resource mapping:<p class="paragraph"/><div class="code"><pre><span class="java&#45;quote">"/books"</span>(resources: <span class="java&#45;quote">"book"</span>) &#123;
    <span class="java&#45;quote">"/publisher"</span>(controller:<span class="java&#45;quote">"publisher"</span>)
&#125;</pre></div><p class="paragraph"/>This will result in the following URL being available:<p class="paragraph"/><table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th>HTTP Method</th><th>URL</th><th>Grails Action</th></tr><tr class="table-odd"><td>GET</td><td>/books/1/publisher</td><td>index</td></tr></table><p class="paragraph"/><h4>Linking to RESTful Mappings</h4><p class="paragraph"/>You can link to any URL mapping created with the <code>g:link</code> tag provided by Grails simply by referencing the controller and action to link to:<p class="paragraph"/><div class="code"><pre>&#60;g:link controller=<span class="java&#45;quote">"book"</span> action=<span class="java&#45;quote">"index"</span>&#62;My Link&#60;/g:link&#62;</pre></div><p class="paragraph"/>As a convenience you  can also pass a domain instance to the <code>resource</code> attribute of the <code>link</code> tag:<p class="paragraph"/><div class="code"><pre>&#60;g:link resource=<span class="java&#45;quote">"$&#123;book&#125;"</span>&#62;My Link&#60;/g:link&#62;</pre></div><p class="paragraph"/>This will automatically produce the correct link (in this case "/books/1" for an id of "1").<p class="paragraph"/>
The case of nested resources is a little different as they typically required two identifiers (the id of the resource and the one it is nested within). For example given the nested resources:<p class="paragraph"/><div class="code"><pre><span class="java&#45;quote">"/books"</span>(resources:'book') &#123;
  <span class="java&#45;quote">"/authors"</span>(resources:<span class="java&#45;quote">"author"</span>)
&#125;</pre></div><p class="paragraph"/>If you wished to link to the <code>show</code> action of the <code>author</code> controller, you would write:<p class="paragraph"/><div class="code"><pre>// Results in /books/1/authors/2
&#60;g:link controller=<span class="java&#45;quote">"author"</span> action=<span class="java&#45;quote">"show"</span> method=<span class="java&#45;quote">"GET"</span> params=<span class="java&#45;quote">"&#91;bookId:1&#93;"</span> id=<span class="java&#45;quote">"2"</span>&#62;The Author&#60;/g:link&#62;</pre></div><p class="paragraph"/>However, to make this more concise there is a <code>resource</code> attribute to the link tag which can be used instead:<p class="paragraph"/><div class="code"><pre>// Results in /books/1/authors/2
&#60;g:link resource=<span class="java&#45;quote">"book/author"</span> action=<span class="java&#45;quote">"show"</span> bookId=<span class="java&#45;quote">"1"</span> id=<span class="java&#45;quote">"2"</span>&#62;My Link&#60;/g:link&#62;</pre></div><p class="paragraph"/>The resource attribute accepts a path to the resource separated by a slash (in this case "book/author"). The attributes of the tag can be used to specify the necessary <code>bookId</code> parameter.

<a name="7.4.3 Embedded Variables"><!-- Legacy link --></a>
<h2 id="embeddedVariables">7.4.3 埋込変数</h2>
<h4>簡単な変数 <div class="hidden-block">Simple Variables </div></h4><p class="paragraph"/><div class="hidden-block">The previous section demonstrated how to map simple URLs with concrete "tokens". In URL mapping speak tokens are the sequence of characters between each slash, '/'. A concrete token is one which is well defined such as as <code>/product</code>. However, in many circumstances you don't know what the value of a particular token will be until runtime. In this case you can use variable placeholders within the URL for example:</div>
前セクションでは、具体トークンURLを簡単にマップする方法を紹介しました。URLマッピングでのトークンとは"/"スラッシュの間にある文字列の事を指します。具体トークンは<code>/product</code>のように適切に指定できますが、状況によっては、ランタイム時にしか一部のトークンが予測できない場合があります。その場合は以下の例のように変数を指定できます:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
  <span class="java&#45;quote">"/product/$id"</span>(controller: <span class="java&#45;quote">"product"</span>)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">In this case by embedding a $id variable as the second token Grails will automatically map the second token into a parameter (available via the <a href="../ref/Controllers/params.html" class="controllers">params</a> object) called <code>id</code>. For example given the URL <code>/product/MacBook</code>, the following code will render "MacBook" to the response:</div>
この例では、２つめのトークンとして変数$idを埋め込むことで、Grailsが自動的に２つめのトークンを名称が<code>id</code>のパラメータとしてマップします(このパラメータは<a href="../ref/Controllers/params.html" class="controllers">params</a>オブジェクトから取得できます)。例として、URL <code>/product/MacBook</code>へアクセスを行うと、次のコードでは、結果として"MacBook"をレスポンスします:<p class="paragraph"/><div class="code"><pre>class ProductController &#123;
     def index() &#123; render params.id &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">You can of course construct more complex examples of mappings. For example the traditional blog URL format could be mapped as follows:</div>
もっと複雑なマッピングも作成できます。例としてブログのようなURLフォーマットを次のようにしてマッピングできます:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
   <span class="java&#45;quote">"/$blog/$year/$month/$day/$id"</span>(controller: <span class="java&#45;quote">"blog"</span>, action: <span class="java&#45;quote">"show"</span>)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">The above mapping would let you do things like:</div>
このマッピングでは、以下のようなURLでアクセスを可能にします:<p class="paragraph"/><div class="code"><pre>/graemerocher/2007/01/10/my_funky_blog_entry</pre></div><p class="paragraph"/><div class="hidden-block">The individual tokens in the URL would again be mapped into the <a href="../ref/Controllers/params.html" class="controllers">params</a> object with values available for <code>year</code>, <code>month</code>, <code>day</code>, <code>id</code> and so on. </div>
URLの個々のトークンは<a href="../ref/Controllers/params.html" class="controllers">params</a>オブジェクトにマップされるため、変数<code>blog</code>, <code>year</code>, <code>month</code>, <code>day</code>, <code>id</code>として値を取得する事ができます。<p class="paragraph"/><h4>動的なコントローラ名とアクション名 <div class="hidden-block">Dynamic Controller and Action Names </div></h4><p class="paragraph"/><div class="hidden-block">Variables can also be used to dynamically construct the controller and action name. In fact the default Grails URL mappings use this technique:</div>
変数を使って動的にコントローラとアクション名を構成することができます。GrailsでのデフォルトURLマッピングはこの機能を使用しています:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
    <span class="java&#45;quote">"/$controller/$action?/$id?"</span>()
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Here the name of the controller, action and id are implicitly obtained from the variables <code>controller</code>, <code>action</code> and <code>id</code> embedded within the URL.</div>
URLに指定された内容から、変数<code>controller</code>,<code>action</code>,<code>id</code>を取得して、コントローラ、アクション、idを確定します。<p class="paragraph"/><div class="hidden-block">You can also resolve the controller name and action name to execute dynamically using a closure:</div>
コントローラ名の解決を変数で行い、クロージャを実行して動的にアクション名を解決することもできます:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
    <span class="java&#45;quote">"/$controller"</span> &#123;
        action = &#123; params.goHere &#125;
    &#125;
&#125;</pre></div><p class="paragraph"/><h4>省略可能な変数 <div class="hidden-block">Optional Variables </div></h4><p class="paragraph"/><div class="hidden-block">Another characteristic of the default mapping is the ability to append a ? at the end of a variable to make it an optional token. In a further example this technique could be applied to the blog URL mapping to have more flexible linking:</div>
変数の最後に ? を付加することで、変数を省略可能にすることが可能です。この仕組みを使用して、前述した例のブログURLマッピングをもっと柔軟にしてみましょう:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
    <span class="java&#45;quote">"/$blog/$year?/$month?/$day?/$id?"</span>(controller:<span class="java&#45;quote">"blog"</span>, action:<span class="java&#45;quote">"show"</span>)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">With this mapping all of these URLs would match with only the relevant parameters being populated in the <a href="../ref/Controllers/params.html" class="controllers">params</a> object:</div>
この設定で以下のURL全てマッチします、そしてそれぞれの関係のあるパラメータのみを<a href="../ref/Controllers/params.html" class="controllers">params</a>オブジェクトに追加します:<p class="paragraph"/><pre class="bq"><code>
/graemerocher/2007/01/10/my_funky_blog_entry
/graemerocher/2007/01/10
/graemerocher/2007/01
/graemerocher/2007
/graemerocher</code></pre><p class="paragraph"/><h4>Optional File Extensions</h4><p class="paragraph"/>If you wish to capture the extension of a particular path, then a special case mapping exists:<p class="paragraph"/><div class="code"><pre><span class="java&#45;quote">"/$controller/$action?/$id?(.$format)?"</span>()</pre></div><p class="paragraph"/>By adding the <code>(.$format)?</code> mapping you can access the file extension using the <code>response.format</code> property in a controller:<p class="paragraph"/><div class="code"><pre>def index() &#123;
    render <span class="java&#45;quote">"extension is $&#123;response.format&#125;"</span>
&#125;</pre></div><p class="paragraph"/><h4>任意変数 <div class="hidden-block">Arbitrary Variables </div></h4><p class="paragraph"/><div class="hidden-block">You can also pass arbitrary parameters from the URL mapping into the controller by just setting them in the block passed to the mapping:</div>
URLマッピングからコントローラへ、コードブロック内で設定した任意のパラメータを渡すことが可能です:<p class="paragraph"/><div class="code"><pre><span class="java&#45;quote">"/holiday/win"</span> &#123;
     id = <span class="java&#45;quote">"Marrakech"</span>
     year = 2007
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">This variables will be available within the <a href="../ref/Controllers/params.html" class="controllers">params</a> object passed to the controller.</div>
変数は<a href="../ref/Controllers/params.html" class="controllers">params</a>オブジェクトから参照可能になります。<p class="paragraph"/><h4>動的解決変数 <div class="hidden-block">Dynamically Resolved Variables </div></h4><p class="paragraph"/><div class="hidden-block">The hard coded arbitrary variables are useful, but sometimes you need to calculate the name of the variable based on runtime factors. This is also possible by assigning a block to the variable name:</div>
任意の変数をURLマッピングに埋め込むのは便利ですが、時折状況に応じて変数の内容を演算したい場合があると思います。この場合コードブロックを変数に割り当てます。:<p class="paragraph"/><div class="code"><pre><span class="java&#45;quote">"/holiday/win"</span> &#123;
     id = &#123; params.id &#125;
     isEligible = &#123; session.user != <span class="java&#45;keyword">null</span> &#125; // must be logged in
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">In the above case the code within the blocks is resolved when the URL is actually matched and hence can be used in combination with all sorts of logic.</div>
URLが実際にマッチした時にコードブロックのロジックが実行されて変数の内容が解決されます。


<a name="7.4.4 Mapping to Views"><!-- Legacy link --></a>
<h2 id="mappingToViews">7.4.4 ビューへマッピング</h2>
<div class="hidden-block">You can resolve a URL to a view without a controller or action involved. For example to map the root URL <code>/</code> to a GSP at the location <code>grails-app/views/index.gsp</code> you could use:</div>
コントローラまたはアクションを含まずにビューへURLをマップできます。例としてルートURL <code>/</code> を、<code>grails-app/views/index.gsp</code>にマッピングするには:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
    <span class="java&#45;quote">"/"</span>(view: <span class="java&#45;quote">"/index"</span>)  // map the root URL
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Alternatively if you need a view that is specific to a given controller you could use:</div>
あるいは、特定のコントローラにあるビューを指定する場合は:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
   <span class="java&#45;quote">"/help"</span>(controller: <span class="java&#45;quote">"site"</span>, view: <span class="java&#45;quote">"help"</span>) // to a view <span class="java&#45;keyword">for</span> a controller
&#125;</pre></div>


<a name="7.4.5 Mapping to Response Codes"><!-- Legacy link --></a>
<h2 id="mappingToResponseCodes">7.4.5 レスポンスコードへマッピング</h2>
<div class="hidden-block">Grails also lets you map HTTP response codes to controllers, actions or views. Just use a method name that matches the response code you are interested in:</div>
GrailsではHTTPレスポンスコードをコントローラ、アクション、ビューにマッピングすることができます。使用したいレスポンスコードをメソッド名に指定するだけです:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
   <span class="java&#45;quote">"403"</span>(controller: <span class="java&#45;quote">"errors"</span>, action: <span class="java&#45;quote">"forbidden"</span>)
   <span class="java&#45;quote">"404"</span>(controller: <span class="java&#45;quote">"errors"</span>, action: <span class="java&#45;quote">"notFound"</span>)
   <span class="java&#45;quote">"500"</span>(controller: <span class="java&#45;quote">"errors"</span>, action: <span class="java&#45;quote">"serverError"</span>)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Or you can specify custom error pages:</div>
カスタムエラーページを指定する場合は:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
   <span class="java&#45;quote">"403"</span>(view: <span class="java&#45;quote">"/errors/forbidden"</span>)
   <span class="java&#45;quote">"404"</span>(view: <span class="java&#45;quote">"/errors/notFound"</span>)
   <span class="java&#45;quote">"500"</span>(view: <span class="java&#45;quote">"/errors/serverError"</span>)
&#125;</pre></div><p class="paragraph"/><h4>エラーハンドリング宣言 <div class="hidden-block">Declarative Error Handling </div></h4><p class="paragraph"/><div class="hidden-block">In addition you can configure handlers for individual exceptions:</div>
特定の例外をのハンドラを定義することも可能です:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
   <span class="java&#45;quote">"403"</span>(view: <span class="java&#45;quote">"/errors/forbidden"</span>)
   <span class="java&#45;quote">"404"</span>(view: <span class="java&#45;quote">"/errors/notFound"</span>)
   <span class="java&#45;quote">"500"</span>(controller: <span class="java&#45;quote">"errors"</span>, action: <span class="java&#45;quote">"illegalArgument"</span>,
         exception: IllegalArgumentException)
   <span class="java&#45;quote">"500"</span>(controller: <span class="java&#45;quote">"errors"</span>, action: <span class="java&#45;quote">"nullPointer"</span>,
         exception: NullPointerException)
   <span class="java&#45;quote">"500"</span>(controller: <span class="java&#45;quote">"errors"</span>, action: <span class="java&#45;quote">"customException"</span>,
         exception: MyException)
   <span class="java&#45;quote">"500"</span>(view: <span class="java&#45;quote">"/errors/serverError"</span>)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">With this configuration, an <code>IllegalArgumentException</code> will be handled by the <code>illegalArgument</code> action in <code>ErrorsController</code>, a <code>NullPointerException</code> will be handled by the <code>nullPointer</code> action, and a <code>MyException</code> will be handled by the <code>customException</code> action. Other exceptions will be handled by the catch-all rule and use the <code>/errors/serverError</code> view.</div>
この設定では、<code>IllegalArgumentException</code>は<code>ErrorsControlle</code>rの<code>illegalArgument</code>、<code>NullPointerException</code>は<code>nullPointer</code>アクション、<code>MyException</code>は<code>customException</code>アクションでそれぞれ処理されます。その他の例外がcatch-allルールでハンドルされビューに<code>/errors/serverError</code>を使用します。<p class="paragraph"/><div class="hidden-block">You can access the exception from your custom error handing view or controller action using the request's <code>exception</code> attribute like so:</div>
カスタムエラーハンドリングで、ビューまたは、コントローラアクションから例外を参照するには、requestインスタンスの<code>exception</code>を使用します:<p class="paragraph"/><div class="code"><pre>class ErrorController &#123;
    def handleError() &#123;
        def exception = request.exception
        // perform desired processing to handle the exception
    &#125;
&#125;</pre></div><p class="paragraph"/><blockquote class="warning">
<div class="hidden-block">If your error-handling controller action throws an exception as well, you'll end up with a <code>StackOverflowException</code>.</div>
エラーハンドリング用のコントローラアクションが例外を出した場合は、最終的に<code>StackOverflowException</code>になります。
</blockquote>


<a name="7.4.6 Mapping to HTTP methods"><!-- Legacy link --></a>
<h2 id="mappingHTTP">7.4.6 HTTPメソッドへマッピング</h2>
<div class="hidden-block">URL mappings can also be configured to map based on the HTTP method (GET, POST, PUT or DELETE). This is very useful for RESTful APIs and for restricting mappings based on HTTP method.</div>
URLマッピングでは、HTTPメソッド(GET, POST, PUT, DELETE)へのマップを定義することができます。HTTPメソッドをベースに制限したり、RESTful API等に便利です。<p class="paragraph"/><div class="hidden-block">As an example the following mappings provide a RESTful API URL mappings for the <code>ProductController</code>:</div>
このマッピングの例では<code>ProductController</code>用にRESTful API URLマッピングを提供しています:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
   <span class="java&#45;quote">"/product/$id"</span>(controller:<span class="java&#45;quote">"product"</span>) &#123;
       action = &#91;GET:<span class="java&#45;quote">"show"</span>, PUT:<span class="java&#45;quote">"update"</span>, DELETE:<span class="java&#45;quote">"delete"</span>, POST:<span class="java&#45;quote">"save"</span>&#93;
   &#125;
&#125;</pre></div>

<a name="7.4.7 Mapping Wildcards"><!-- Legacy link --></a>
<h2 id="mappingWildcards">7.4.7 マッピングワイルドカード</h2>
<div class="hidden-block">Grails' URL mappings mechanism also supports wildcard mappings. For example consider the following mapping:</div>
GrailsのURLマッピング機能ではワイルドカードもサポートしています。例として次ぎのマッピングに注目してください:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
    <span class="java&#45;quote">"/images/&#42;.jpg"</span>(controller: <span class="java&#45;quote">"image"</span>)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">This mapping will match all paths to images such as <code>/image/logo.jpg</code>. Of course you can achieve the same effect with a variable:</div>
このマッピングが<code>/image/logo.jpg</code>のような画像パスにマッチします。変数も使用可能です:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
    <span class="java&#45;quote">"/images/$name.jpg"</span>(controller: <span class="java&#45;quote">"image"</span>)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">However, you can also use double wildcards to match more than one level below:</div>
ダブルワイルドカード使用すると1レベル下の階層までマッチします:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
    <span class="java&#45;quote">"/images/&#42;&#42;.jpg"</span>(controller: <span class="java&#45;quote">"image"</span>)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">In this cases the mapping will match <code>/image/logo.jpg</code> as well as <code>/image/other/logo.jpg</code>. Even better you can use a double wildcard variable:</div>
このマッピング例では、<code>/image/logo.jpg</code>や、<code>/image/other/logo.jpg</code>にマッチします。ダブルワイルドカード変数も使用できます:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
    // will match /image/logo.jpg and /image/other/logo.jpg
    <span class="java&#45;quote">"/images/$name&#42;&#42;.jpg"</span>(controller: <span class="java&#45;quote">"image"</span>)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">In this case it will store the path matched by the wildcard inside a <code>name</code> parameter obtainable from the <a href="../ref/Controllers/params.html" class="controllers">params</a> object:</div>
この例では、<code>name</code>パラメータにマッチしたパスを<a href="../ref/Controllers/params.html" class="controllers">params</a>オブジェクトから取得できます:<p class="paragraph"/><div class="code"><pre>def name = params.name
println name // prints <span class="java&#45;quote">"logo"</span> or <span class="java&#45;quote">"other/logo"</span></pre></div><p class="paragraph"/><div class="hidden-block">If you use wildcard URL mappings then you may want to exclude certain URIs from Grails' URL mapping process. To do this you can provide an <code>excludes</code> setting inside the <code>UrlMappings.groovy</code> class:</div>
ワイルドカードURLマッピングを使用すると、一定のURIをURLマッピングでの除外も必要となります。<code>UrlMappings.groovy</code>クラスで、<code>excludes</code>を指定することで可能です:<p class="paragraph"/><div class="code"><pre>class UrlMappings &#123;
    <span class="java&#45;keyword">static</span> excludes = &#91;<span class="java&#45;quote">"/images/&#42;"</span>, <span class="java&#45;quote">"/css/&#42;"</span>&#93;
    <span class="java&#45;keyword">static</span> mappings = &#123;
        &#8230;
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">In this case Grails won't attempt to match any URIs that start with <code>/images</code> or <code>/css</code>.</div>
この例では、 <code>/images</code>また<code>/css</code>で始まるURIはURLマッピングから除外されます.


<a name="7.4.8 Automatic Link Re-Writing"><!-- Legacy link --></a>
<h2 id="automaticLinkRewriting">7.4.8 自動リンクリライト</h2>
<div class="hidden-block">Another great feature of URL mappings is that they automatically customize the behaviour of the <a href="../ref/Tags/link.html" class="tags">link</a> tag so that changing the mappings don't require you to go and change all of your links.</div>
URLマッピングには、<a href="../ref/Tags/link.html" class="tags">link</a>タグの振る舞いを自動的にカスタマイズ するという優れた機能が存在します。その機能のおかげでURLマッピングを変更しても、その都度リンクを変更しなくても良くなります。<p class="paragraph"/><div class="hidden-block">This is done through a URL re-writing technique that reverse engineers the links from the URL mappings. So given a mapping such as the blog one from an earlier section:</div>
URLマッピングからリバースエンジニアリングによってURLをリライトするという仕組みで実装されています。前のセクションからのブログマッピングを例があるとします:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
   <span class="java&#45;quote">"/$blog/$year?/$month?/$day?/$id?"</span>(controller:<span class="java&#45;quote">"blog"</span>, action:<span class="java&#45;quote">"show"</span>)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">If you use the link tag as follows:</div>
以下のようにlinkタグを使用します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:link controller=<span class="xml&#45;quote">"blog"</span> action=<span class="xml&#45;quote">"show"</span>
        params=<span class="xml&#45;quote">"&#91;blog:'fred', year:2007&#93;"</span>&#62;</span>
    My Blog
<span class="xml&#45;tag">&#60;/g:link&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;g:link controller=<span class="xml&#45;quote">"blog"</span> action=<span class="xml&#45;quote">"show"</span>
        params=<span class="xml&#45;quote">"&#91;blog:'fred', year:2007, month:10&#93;"</span>&#62;</span>
    My Blog &#45; October 2007 Posts
<span class="xml&#45;tag">&#60;/g:link&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Grails will automatically re-write the URL in the correct format:</div>
GrailsがURLを自動的にリライトします:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;a href=<span class="xml&#45;quote">"/fred/2007"</span>&#62;</span>My Blog<span class="xml&#45;tag">&#60;/a&#62;</span>
<span class="xml&#45;tag">&#60;a href=<span class="xml&#45;quote">"/fred/2007/10"</span>&#62;</span>My Blog &#45; October 2007 Posts<span class="xml&#45;tag">&#60;/a&#62;</span></pre></div>


<a name="7.4.9 Applying Constraints"><!-- Legacy link --></a>
<h2 id="applyingConstraints">7.4.9 制約の適用</h2>
<div class="hidden-block">URL Mappings also support Grails' unified <a href="../guide/single.html#constraints" class="guide">validation constraints</a> mechanism, which lets you further "constrain" how a URL is matched. For example, if we revisit the blog sample code from earlier, the mapping currently looks like this:</div>
URLマッピングでは、URLがマッチしてるか確認するために、<a href="../guide/single.html#constraints" class="guide">バリデーション制約</a>が使用できます。例として、前と同じブログのサンプルを使用します:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
   <span class="java&#45;quote">"/$blog/$year?/$month?/$day?/$id?"</span>(controller:<span class="java&#45;quote">"blog"</span>, action:<span class="java&#45;quote">"show"</span>)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">This allows URLs such as:</div>
以下のURLを許可します:<p class="paragraph"/><div class="code"><pre>/graemerocher/2007/01/10/my_funky_blog_entry</pre></div><p class="paragraph"/><div class="hidden-block">However, it would also allow:</div>
もちろんこのままでは、以下のようなURLも許可します:<p class="paragraph"/><div class="code"><pre>/graemerocher/not_a_year/not_a_month/not_a_day/my_funky_blog_entry</pre></div><p class="paragraph"/><div class="hidden-block">This is problematic as it forces you to do some clever parsing in the controller code. Luckily, URL Mappings can be constrained to further validate the URL tokens:</div>
これが許可されるといたずらされる危険性があります。ここで！URLマッピングに制約を定義してURLトークンをバリデートします:<p class="paragraph"/><div class="code"><pre><span class="java&#45;quote">"/$blog/$year?/$month?/$day?/$id?"</span> &#123;
     controller = <span class="java&#45;quote">"blog"</span>
     action = <span class="java&#45;quote">"show"</span>
     constraints &#123;
          year(matches:/&#92;d&#123;4&#125;/)
          month(matches:/&#92;d&#123;2&#125;/)
          day(matches:/&#92;d&#123;2&#125;/)
     &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">In this case the constraints ensure that the <code>year</code>, <code>month</code> and <code>day</code> parameters match a particular valid pattern thus relieving you of that burden later on.</div>
この例では、<code>year</code>,<code>month</code>,<code>day</code>パラメータが特定のパターンにマッチするように制約を定義しています。


<a name="7.4.10 Named URL Mappings"><!-- Legacy link --></a>
<h2 id="namedMappings">7.4.10 名前付きURLマッピング</h2>
<div class="hidden-block">URL Mappings also support named mappings, that is mappings which have a name associated with them. The name may be used to refer to a specific mapping when links are generated.</div>
URLマッピングでは、名前で連携ができるように、名前付きマッピングに対応しています。<p class="paragraph"/><div class="hidden-block">The syntax for defining a named mapping is as follows:</div>
名前付きマッピングの定義は以下のようになります:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
   name &#60;mapping name&#62;: &#60;url pattern&#62; &#123;
      // &#8230;
   &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">For example:</div>
例として:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
    name personList: <span class="java&#45;quote">"/showPeople"</span> &#123;
        controller = 'person'
        action = 'list'
    &#125;
    name accountDetails: <span class="java&#45;quote">"/details/$acctNumber"</span> &#123;
        controller = 'product'
        action = 'accountDetails'
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">The mapping may be referenced in a link tag in a GSP.</div>
次のように、GSPでlinkタグからマッピングを参照します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:link mapping=<span class="xml&#45;quote">"personList"</span>&#62;</span>List People<span class="xml&#45;tag">&#60;/g:link&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">That would result in:</div>
この結果は以下のようになります:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;a href=<span class="xml&#45;quote">"/showPeople"</span>&#62;</span>List People<span class="xml&#45;tag">&#60;/a&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Parameters may be specified using the params attribute.</div>
params属性でパラメータを定義することができます.<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:link mapping=<span class="xml&#45;quote">"accountDetails"</span> params=<span class="xml&#45;quote">"&#91;acctNumber:'8675309'&#93;"</span>&#62;</span>
    Show Account
<span class="xml&#45;tag">&#60;/g:link&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">That would result in:</div>
この例の結果は:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;a href=<span class="xml&#45;quote">"/details/8675309"</span>&#62;</span>Show Account<span class="xml&#45;tag">&#60;/a&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Alternatively you may reference a named mapping using the link namespace.</div>
名前付きマッピングでは、linkタグの代わりに、linkネームスペースのタグが使用できます。<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;link:personList&#62;</span>List People<span class="xml&#45;tag">&#60;/link:personList&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">That would result in:</div>
この例の結果は:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;a href=<span class="xml&#45;quote">"/showPeople"</span>&#62;</span>List People<span class="xml&#45;tag">&#60;/a&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">The link namespace approach allows parameters to be specified as attributes.</div>
linkネームスペースタグでは、パラメータを属性で指定できます。<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;link:accountDetails acctNumber=<span class="xml&#45;quote">"8675309"</span>&#62;</span>Show Account<span class="xml&#45;tag">&#60;/link:accountDetails&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">That would result in:</div>
この例の結果は:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;a href=<span class="xml&#45;quote">"/details/8675309"</span>&#62;</span>Show Account<span class="xml&#45;tag">&#60;/a&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">To specify attributes that should be applied to the generated <code>href</code>, specify a <code>Map</code> value to the <code>attrs</code> attribute.  These attributes will be applied directly to the href, not passed through to be used as request parameters.</div>
属性に指定した全ての内容は生成された<code>href</code>に適用されてしまうので、他の属性は、<code>attrs</code>属性に<code>Map</code>で指定します。<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;link:accountDetails attrs=<span class="xml&#45;quote">"&#91;class: 'fancy'&#93;"</span> acctNumber=<span class="xml&#45;quote">"8675309"</span>&#62;</span>
    Show Account
<span class="xml&#45;tag">&#60;/link:accountDetails&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">That would result in:</div>
この例の結果は:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;a href=<span class="xml&#45;quote">"/details/8675309"</span> class=<span class="xml&#45;quote">"fancy"</span>&#62;</span>Show Account<span class="xml&#45;tag">&#60;/a&#62;</span></pre></div>



<h2 id="customizingUrlFormat">7.4.11 URLフォーマットのカスタマイズ</h2>
<div class="hidden-block">The default URL Mapping mechanism supports camel case names in the URLs.  The default URL for accessing an action named <code>addNumbers</code> in a controller named <code>MathHelperController</code> would be something like <code>/mathHelper/addNumbers</code>.  Grails allows for the customization of this pattern and provides an implementation which replaces the camel case convention with a hyphenated convention that would support URLs like <code>/math-helper/add-numbers</code>.  To enable hyphenated URLs assign a value of "hyphenated" to the <code>grails.web.url.converter</code> property in <code>grails-app/conf/Config.groovy</code>.
</div>
URLでの
URLマッピングは、デフォルトでキャメルケースのURLになります。例えばコントローラ<code>MathHelperController</code>のアクション<code>addNumbers</code>の場合、デフォルトURLでのURLは、<code>/mathHelper/addNumbers</code>のようになります。Grailsでは、このパターンをカスタマイズして、<code>/math-helper/add-numbers</code>のようなハイフン形式にキャメルケース形式を入れ換える実装が可能です。ハイフンURLを可能にするには、<code>grails-app/conf/Config.groovy</code>の<code>grails.web.url.converter</code>を"hyphenated"にします。<p class="paragraph"/><div class="code"><pre>// grails&#45;app/conf/Config.groovy<p class="paragraph"/>grails.web.url.converter = 'hyphenated'</pre></div><p class="paragraph"/><div class="hidden-block">
Arbitrary strategies may be plugged in by providing a class which implements the <a href="http://grails.org/doc/latest/api/grails/web/UrlConverter.html" class="api">UrlConverter</a> interface and adding an instance of that class to the Spring application context with the bean name of <code>grails.web.UrlConverter.BEAN_NAME</code>.  If Grails finds a bean in the context with that name, it will be used as the default converter and there is no need to assign a value to the <code>grails.web.url.converter</code> config property.
</div>
任意の方法追加するには、インターフェイス<a href="http://grails.org/doc/latest/api/grails/web/UrlConverter.html" class="api">UrlConverter</a>を実装したクラスを、ビーン名称<code>grails.web.UrlConverter.BEAN_NAME</code>で追加します。Grailsがそのビーン名称をコンテキストに有ることを認識した場合、指定したクラスの実装がデフォルトとなります。この場合は、<code>grails.web.url.converter</code>プロパティは必要有りません。
<div class="hidden-block">
<div class="code"><pre>// src/groovy/com/myapplication/MyUrlConverterImpl.groovy<p class="paragraph"/><span class="java&#45;keyword">package</span> com.myapplication<p class="paragraph"/>class MyUrlConverterImpl <span class="java&#45;keyword">implements</span> grails.web.UrlConverter &#123;<p class="paragraph"/>    <span class="java&#45;object">String</span> toUrlElement(<span class="java&#45;object">String</span> propertyOrClassName) &#123;
        // <span class="java&#45;keyword">return</span> some representation of a property or class name that should be used in URLs&#8230;
    &#125;
&#125;</pre></div>
</div>
<div class="code"><pre>// src/groovy/com/myapplication/MyUrlConverterImpl.groovy<p class="paragraph"/><span class="java&#45;keyword">package</span> com.myapplication<p class="paragraph"/>class MyUrlConverterImpl <span class="java&#45;keyword">implements</span> grails.web.UrlConverter &#123;<p class="paragraph"/>    <span class="java&#45;object">String</span> toUrlElement(<span class="java&#45;object">String</span> propertyOrClassName) &#123;
        // URLで描写するプロパティ名またはクラス名を返す
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="code"><pre>// grails&#45;app/conf/spring/resources.groovy<p class="paragraph"/>beans = &#123;
    <span class="java&#45;quote">"$&#123;grails.web.UrlConverter.BEAN_NAME&#125;"</span>(com.myapplication.MyUrlConverterImpl)
&#125;</pre></div>



<h2 id="namespacedControllers">7.4.12 コントローラネームスペース</h2>
If an application defines multiple controllers with the same name
in different packages, the controllers must be defined in a
namespace.  The way to define a namespace for a controller is to 
define a static property named <code>namespace</code> in the controller and 
assign a String to the property that represents the namespace.<p class="paragraph"/><div class="code"><pre>// grails&#45;app/controllers/com/app/reporting/AdminController.groovy
<span class="java&#45;keyword">package</span> com.app.reporting<p class="paragraph"/>class AdminController &#123;<p class="paragraph"/>    <span class="java&#45;keyword">static</span> namespace = 'reports'<p class="paragraph"/>    // &#8230;
&#125;</pre></div><p class="paragraph"/><div class="code"><pre>// grails&#45;app/controllers/com/app/security/AdminController.groovy
<span class="java&#45;keyword">package</span> com.app.security<p class="paragraph"/>class AdminController &#123;<p class="paragraph"/>    <span class="java&#45;keyword">static</span> namespace = 'users'<p class="paragraph"/>    // &#8230;
&#125;</pre></div><p class="paragraph"/>When defining url mappings which should be associated with a namespaced
controller, the <code>namespace</code> variable needs to be part of the URL mapping.<p class="paragraph"/><div class="code"><pre>// grails&#45;app/conf/UrlMappings.groovy
class UrlMappings &#123;<p class="paragraph"/>    <span class="java&#45;keyword">static</span> mappings = &#123;
        '/userAdmin' &#123;
            controller = 'admin'
            namespace = 'users'
        &#125;<p class="paragraph"/>        '/reportAdmin' &#123;
            controller = 'admin'
            namespace = 'reports'
        &#125;<p class="paragraph"/>        <span class="java&#45;quote">"/$namespace/$controller/$action?"</span>()
    &#125;
&#125;</pre></div><p class="paragraph"/>Reverse URL mappings also require that the <code>namespace</code> be specified.<p class="paragraph"/><div class="code"><pre>&#60;g:link controller=<span class="java&#45;quote">"admin"</span> namespace=<span class="java&#45;quote">"reports"</span>&#62;Click For Report Admin&#60;/g:link&#62;
&#60;g:link controller=<span class="java&#45;quote">"admin"</span> namespace=<span class="java&#45;quote">"users"</span>&#62;Click For User Admin&#60;/g:link&#62;</pre></div><p class="paragraph"/>When resolving a URL mapping (forward or reverse) to a namespaced controller,
a mapping will only match if the <code>namespace</code> has been provided.  If
the application provides several controllers with the same name in different
packages, at most 1 of them may be defined without a <code>namespace</code> property.  If
there are multiple controllers with the same name that do not define a
<code>namespace</code> property, the framework will not know how to distinguish between
them for forward or reverse mapping resolutions.<p class="paragraph"/>It is allowed for an application to use a plugin which provides a controller
with the same name as a controller provided by the application and for neither
of the controllers to define a <code>namespace</code> property as long as the
controllers are in separate packages.  For example, an application
may include a controller named <code>com.accounting.ReportingController</code>
and the application may use a plugin which provides a controller
named <code>com.humanresources.ReportingController</code>.  The only issue
with that is the URL mapping for the controller provided by the
plugin needs to be explicit in specifying that the mapping applies
to the <code>ReportingController</code> which is provided by the plugin.<p class="paragraph"/>See the following example.<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
    <span class="java&#45;quote">"/accountingReports"</span> &#123;
        controller = <span class="java&#45;quote">"reporting"</span>
    &#125;
    <span class="java&#45;quote">"/humanResourceReports"</span> &#123;
        controller = <span class="java&#45;quote">"reporting"</span>
        plugin = <span class="java&#45;quote">"humanResources"</span>
    &#125;
&#125;</pre></div><p class="paragraph"/>With that mapping in place, a request to <code>/accountingReports</code> will
be handled by the <code>ReportingController</code> which is defined in the
application.  A request to <code>/humanResourceReports</code> will be handled
by the <code>ReportingController</code> which is provided by the <code>humanResources</code>
plugin.<p class="paragraph"/>There could be any number of <code>ReportingController</code> controllers provided
by any number of plugins but no plugin may provide more than one
<code>ReportingController</code> even if they are defined in separate packages.<p class="paragraph"/>Assigning a value to the <code>plugin</code> variable in the mapping is only
required if there are multiple controllers with the same name
available at runtime provided by the application and/or plugins.
If the <code>humanResources</code> plugin provides a <code>ReportingController</code> and
there is no other <code>ReportingController</code> available at runtime, the
following mapping would work.<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">static</span> mappings = &#123;
    <span class="java&#45;quote">"/humanResourceReports"</span> &#123;
        controller = <span class="java&#45;quote">"reporting"</span>
    &#125;
&#125;</pre></div><p class="paragraph"/>It is best practice to be explicit about the fact that the controller
is being provided by a plugin.<p class="paragraph"/>


<a name="7.5 Web Flow"><!-- Legacy link --></a>
<h2 id="webflow">7.5 Webフロー</h2>
<h4>概要 <div class="hidden-block">Overview</div></h4><p class="paragraph"/><div class="hidden-block">Grails supports the creation of web flows built on the <a href="http://www.springsource.org/webflow" target="blank">Spring Web Flow</a> project. A web flow is a conversation that spans multiple requests and retains state for the scope of the flow. A web flow also has a defined start and end state.</div>
Grailsでは、<a href="http://www.springsource.org/webflow" target="blank">Spring Web Flow</a> をベースにしたWebフローをサポートしています。Webフローとは、処理範囲での複数のリクエストと保有するステート間の対話です。Webフローでは明示された開始と終了ステートも持っています。<p class="paragraph"/><div class="hidden-block">Web flows don't require an HTTP session, but instead store their state in a serialized form, which is then restored using a flow execution key that Grails passes around as a request parameter. This makes flows far more scalable than other forms of stateful application that use the HttpSession and its inherit memory and clustering concerns.</div>
WebフローにはHTTP sessionは必要有りません。代わりに、リクエストパラメータでGrailsが持ち回る、フローエクスキュージョンキーを使用した連載形式でステートを保持しています。この方式はメモリ継承やクラスタリング問題のあるHttpSessionを使用したステートフルアプリケーションの形式よりもフローをスケーラブルにします。<p class="paragraph"/><div class="hidden-block">Web flow is essentially an advanced state machine that manages the "flow" of execution from one state to the next. Since the state is managed for you, you don't have to be concerned with ensuring that users enter an action in the middle of some multi step flow, as web flow manages that for you. This makes web flow perfect for use cases such as shopping carts, hotel booking and any application that has multi page work flows.</div>
Webフローは本質的には、"フロー"の実行のステートの流れを管理する上級ステートマシーンです。
ステートが管理されると、Webフローが管理してくれるので、ユーザがフロー途中のアクションから入ってくる場合どうするか等を気にしなくても良くなります。これによりショッピングカート、ホテル予約などの複数ページにまたがるワークフローを持つアプリケーションにWebフローがよく合うと言う事です。<p class="paragraph"/>
<blockquote class="note">
<div class="hidden-block">From Grails 1.2 onwards Webflow is no longer in Grails core, so you must install the Webflow plugin to use this feature.</div>
Grails 1.2からWebフローはGrailsのコア機能では無くなりました。この機能を使用するには、Webフロープラグインをインストールする必要があります. 
</blockquote><p class="paragraph"/><h4>フローの作成 <div class="hidden-block">Creating a Flow</div></h4><p class="paragraph"/><div class="hidden-block">To create a flow create a regular Grails controller and add an action that ends with the convention <code>Flow</code>. For example:</div>
フローを作成するには、名称が<code>Flow</code>で終わるアクションをGrailsの通常にコントローラに作成します。例として:<p class="paragraph"/><div class="code"><pre>class BookController &#123;<p class="paragraph"/>   def index() &#123;
      redirect(action: <span class="java&#45;quote">"shoppingCart"</span>)
   &#125;<p class="paragraph"/>   def shoppingCartFlow = &#123;
        &#8230;
   &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Notice when redirecting or referring to the flow as an action we omit the <code>Flow</code> suffix. In other words the name of the action of the above flow is <code>shoppingCart</code>. </div>
フローをアクションとしてリダイレクトまたは参照をするには、接尾辞の<code>Flow</code>を省略します。言い換えれば上記のフローのアクション名は<code>shoppingCart</code>となります。


<a name="7.5.1 Start and End States"><!-- Legacy link --></a>
<h2 id="startAndEndStates">7.5.1 開始と終了のステート</h2>
<div class="hidden-block">As mentioned before a flow has a defined start and end state. A start state is the state which is entered when a user first initiates a conversation (or flow). The start state of a Grails flow is the first method call that takes a block. For example: </div>
前述したように、Webフローでは明示された開始と終了ステートも持っています。開始ステートは、ユーザが最初に対話(またはフロー)を開始するステートです。最初のブロックのメソッドコールがGrailsフローの開始ステートです:<p class="paragraph"/><div class="code"><pre>class BookController &#123;
   &#8230;
   def shoppingCartFlow =&#123;
       showCart &#123;
           on(<span class="java&#45;quote">"checkout"</span>).to <span class="java&#45;quote">"enterPersonalDetails"</span>
           on(<span class="java&#45;quote">"continueShopping"</span>).to <span class="java&#45;quote">"displayCatalogue"</span>
       &#125;
       &#8230;
       displayCatalogue &#123;
           redirect(controller: <span class="java&#45;quote">"catalogue"</span>, action: <span class="java&#45;quote">"show"</span>)
       &#125;
       displayInvoice()
   &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Here the <code>showCart</code> node is the start state of the flow. Since the showCart state doesn't define an action or redirect it is assumed be a <a href="../guide/single.html#actionStatesAndViewStates" class="guide">view state</a> that, by convention, refers to the view  <code>grails-app/views/book/shoppingCart/showCart.gsp</code>.</div>
この例でのフローの開始ステートは<code>showCart</code>ノードになります。showCartがアクションまたリダイレクトを定義していない場合は、慣習により<code>grails-app/views/book/shoppingCart/showCart.gsp</code>を参照して表示する<a href="../guide/single.html#actionStatesAndViewStates" class="guide">ビューステート</a>として見なされます。<p class="paragraph"/>
<div class="hidden-block">Notice that unlike regular controller actions, the views are stored within a directory that matches the name of the flow: <code>grails-app/views/book/shoppingCart</code>.</div>
通常のコントローラアクションと違い、ビューファイルはフロー名称のディレクトリに配置された物にマッチします:<code>grails-app/views/book/shoppingCart</code><p class="paragraph"/><div class="hidden-block">The <code>shoppingCart</code> flow also has two possible end states. The first is <code>displayCatalogue</code> which performs an external redirect to another controller and action, thus exiting the flow. The second is <code>displayInvoice</code> which is an end state as it has no events at all and will simply render a view called <code>grails-app/views/book/shoppingCart/displayInvoice.gsp</code> whilst ending the flow at the same time. </div>
この<code>shoppingCart</code>フローには、２つの終了ステートがあります。一つ目のステートは、外部のコントローラアクションにリダイレクトしてフローから出る<code>displayCatalogue</code>。二つ目のステートは、何もイベント処理が無く単純に、ビューの<code>grails-app/views/book/shoppingCart/displayInvoice.gsp</code>を描写して同時にフローを終了する、<code>displayInvoice</code>です。<p class="paragraph"/><div class="hidden-block">Once a flow has ended it can only be resumed from the start state, in this case <code>showCart</code>, and not from any other state.</div>
フローが終了したら、開始フローのみから再開できます。この例では<code>showCart</code>になります。


<a name="7.5.2 Action States and View States"><!-- Legacy link --></a>
<h2 id="actionStatesAndViewStates">7.5.2 アクションステートとビューステート</h2>
<h4>ビューステート <div class="hidden-block">View states</div></h4><p class="paragraph"/><div class="hidden-block">A view state is a one that doesn't define an <code>action</code> or a <code>redirect</code>. So for example this is a view state:</div>
<code>action</code>また<code>ridairect</code>を定義していないものがビューステートです。この例がビューステートになります:<p class="paragraph"/><div class="code"><pre>enterPersonalDetails &#123;
   on(<span class="java&#45;quote">"submit"</span>).to <span class="java&#45;quote">"enterShipping"</span>
   on(<span class="java&#45;quote">"<span class="java&#45;keyword">return</span>"</span>).to <span class="java&#45;quote">"showCart"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">It will look for a view called <code>grails-app/views/book/shoppingCart/enterPersonalDetails.gsp</code> by default. Note that the <code>enterPersonalDetails</code> state defines two events: <code>submit</code> and <code>return</code>. The view is responsible for <a href="../guide/single.html#flowExecutionEvents" class="guide">triggering</a> these events. Use the <code>render</code> method to change the view to be rendered:
</div>
デフォルトでは、ビューファイル<code>grails-app/views/book/shoppingCart/enterPersonalDetails.gsp</code>を使用します。<code>enterPersonalDetails</code>ステートは、<code>submit</code>と<code>return</code>という２つのイベントを定義しています。これらのイベントはビューで<a href="../guide/single.html#flowExecutionEvents" class="guide">トリガー</a>する必要があります。<code>render</code>メソッドを使用して描写するビューを変更することが可能です:<p class="paragraph"/><div class="code"><pre>enterPersonalDetails &#123;
   render(view: <span class="java&#45;quote">"enterDetailsView"</span>)
   on(<span class="java&#45;quote">"submit"</span>).to <span class="java&#45;quote">"enterShipping"</span>
   on(<span class="java&#45;quote">"<span class="java&#45;keyword">return</span>"</span>).to <span class="java&#45;quote">"showCart"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Now it will look for <code>grails-app/views/book/shoppingCart/enterDetailsView.gsp</code>. Start the <code>view</code> parameter with a / to use a shared view:</div>
この例で<code>grails-app/views/book/shoppingCart/enterDetailsView.gsp</code>を参照するようになります。<code>view</code>のパラメータに / を使用して共有ビューを使用できます:<p class="paragraph"/><div class="code"><pre>enterPersonalDetails &#123;
   render(view: <span class="java&#45;quote">"/shared/enterDetailsView"</span>)
   on(<span class="java&#45;quote">"submit"</span>).to <span class="java&#45;quote">"enterShipping"</span>
   on(<span class="java&#45;quote">"<span class="java&#45;keyword">return</span>"</span>).to <span class="java&#45;quote">"showCart"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Now it will look for <code>grails-app/views/shared/enterDetailsView.gsp</code> </div>
この例で<code>grails-app/views/shared/enterDetailsView.gsp</code>を参照するようになります。<p class="paragraph"/><h4>アクションステート <div class="hidden-block">Action States</div></h4><p class="paragraph"/><div class="hidden-block">An action state is a state that executes code but does not render a view. The result of the action is used to dictate flow transition. To create an action state you define an action to to be executed. This is done by calling the <code>action</code> method and passing it a block of code to be executed:</div>
アクションステートはコードを実行してビューを描写しないステートです。アクションの結果は指示されたフロートランジションで使用されます。<code>action</code>メソッドに実行したいコードブロックを渡してアクションステートを実装します:<p class="paragraph"/><div class="code"><pre>listBooks &#123;
   action &#123;
      &#91;bookList: Book.list()&#93;
   &#125;
   on(<span class="java&#45;quote">"success"</span>).to <span class="java&#45;quote">"showCatalogue"</span>
   on(Exception).to <span class="java&#45;quote">"handleError"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">As you can see an action looks very similar to a controller action and in fact you can reuse controller actions if you want. If the action successfully returns with no errors the <code>success</code> event will be triggered. In this case since we return a Map, which is regarded as the "model" and is automatically placed in <a href="../guide/single.html#flowScopes" class="guide">flow scope</a>.</div>
ご覧の通りアクションはコントローラアクションに似ています。もちろん必要であればコントローラアクションを再利用することもできます。アクションが正常に終了したら<code>success</code>イベントがトリガーされます。この例では、モデルと見なしたMapを返して自動的に<a href="../guide/single.html#flowScopes" class="guide">flowスコープ</a>に配置されます。<p class="paragraph"/><div class="hidden-block">In addition, in the above example we also use an exception handler to deal with errors on the line:</div>
加えて、上記の例では、エラーを取り扱う例外ハンドラも使用しています:<p class="paragraph"/><div class="code"><pre>on(Exception).to <span class="java&#45;quote">"handleError"</span></pre></div><p class="paragraph"/><div class="hidden-block">This makes the flow transition to a state called <code>handleError</code> in the case of an exception.</div>
例外時に<code>handleError</code>というステートにフローが移行します。<p class="paragraph"/><div class="hidden-block">You can write more complex actions that interact with the flow request context:</div>
フローリクエストコンテキストとやりとりをする複雑なアクションを記述できます:<p class="paragraph"/><div class="code"><pre>processPurchaseOrder &#123;
    action &#123;
        def a =  flow.address
        def p = flow.person
        def pd = flow.paymentDetails
        def cartItems = flow.cartItems
        flow.clear()<p class="paragraph"/>        def o = <span class="java&#45;keyword">new</span> Order(person: p, shippingAddress: a, paymentDetails: pd)
        o.invoiceNumber = <span class="java&#45;keyword">new</span> Random().nextInt(9999999)
        <span class="java&#45;keyword">for</span> (item in cartItems) &#123; o.addToItems item &#125;
        o.save()
        &#91;order: o&#93;
    &#125;
    on(<span class="java&#45;quote">"error"</span>).to <span class="java&#45;quote">"confirmPurchase"</span>
    on(Exception).to <span class="java&#45;quote">"confirmPurchase"</span>
    on(<span class="java&#45;quote">"success"</span>).to <span class="java&#45;quote">"displayInvoice"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Here is a more complex action that gathers all the information accumulated from the flow scope and creates an <code>Order</code> object. It then returns the order as the model. The important thing to note here is the interaction with the request context and "flow scope".</div>
この例では、アクションで、flowスコープから収集した情報から<code>Order</code>オブジェクトを生成しています。そして生成後オーダーをモデルで返しています。ここで重要なのはリクエストコンテキストと"flowスコープ"のやりとりです。<p class="paragraph"/><h4>アクションのトランジション <div class="hidden-block">Transition Actions</div></h4><p class="paragraph"/><div class="hidden-block">Another form of action is what is known as a  <em class="italic">transition</em>  action. A transition action is executed directly prior to state transition once an <a href="../guide/single.html#flowExecutionEvents" class="guide">event</a> has been triggered. A simple example of a transition action can be seen below:</div>
他の形式のアクションとしてトランジションアクションがあります。トランジションアクションは、<a href="../guide/single.html#flowExecutionEvents" class="guide">イベント</a>がトリガーされたら、トランジションステートで直接優先的に実行されます:<p class="paragraph"/><div class="code"><pre>enterPersonalDetails &#123;
   on(<span class="java&#45;quote">"submit"</span>) &#123;
       log.trace <span class="java&#45;quote">"Going to enter shipping"</span>
   &#125;.to <span class="java&#45;quote">"enterShipping"</span>
   on(<span class="java&#45;quote">"<span class="java&#45;keyword">return</span>"</span>).to <span class="java&#45;quote">"showCart"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Notice how we pass a block of the code to <code>submit</code> event that simply logs the transition. Transition states are very useful for <a href="../guide/single.html#dataBindingAndValidation" class="guide">data binding and validation</a>, which is covered in a later section.</div>
この例では、<code>submit</code>イベントにコードブロックを渡してトランジションのログを実行しています。この後に解説をする、<a href="../guide/single.html#dataBindingAndValidation" class="guide">データバインディングとバリデーション</a>で、このトランジションステートが便利に活用できます。


<a name="7.5.3 Flow Execution Events"><!-- Legacy link --></a>
<h2 id="flowExecutionEvents">7.5.3 フロー実行イベント</h2>
<div class="hidden-block">In order to  <em class="italic">transition</em>  execution of a flow from one state to the next you need some way of trigger an  <em class="italic">event</em>  that indicates what the flow should do next. Events can be triggered from either view states or action states.</div>
ステートから次のステートへのフローでの  <em class="italic">トランジション</em>  実行ができると、次のフローの  <em class="italic">イベントトリガー</em>  を指定する方法が必要になります。ビューステートまたはアクションステートからイベントをトリガーできます。<p class="paragraph"/><h4>ビューステートからのイベントトリガー <div class="hidden-block">Triggering Events from a View State</div></h4><p class="paragraph"/><div class="hidden-block">As discussed previously the start state of the flow in a previous code listing deals with two possible events. A <code>checkout</code> event and a <code>continueShopping</code> event:</div>
前のコードの例と同じく、フローの開始ステートには２つのイベントを与えます。<code>checkout</code>イベントと<code>continueShopping</code>イベントです:<p class="paragraph"/><div class="code"><pre>def shoppingCartFlow = &#123;
    showCart &#123;
        on(<span class="java&#45;quote">"checkout"</span>).to <span class="java&#45;quote">"enterPersonalDetails"</span>
        on(<span class="java&#45;quote">"continueShopping"</span>).to <span class="java&#45;quote">"displayCatalogue"</span>
    &#125;
    &#8230;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Since the <code>showCart</code> event is a view state it will render the view <code>grails-app/book/shoppingCart/showCart.gsp</code>. Within this view you need to have components that trigger flow execution. On a form this can be done use the <a href="../ref/Tags/submitButton.html" class="tags">submitButton</a> tag:</div>
<code>shopCart</code>イベントはビューステートなので、<code>grails-app/book/shoppingCart/showCart.gsp</code>を描写します。このビューの中に、フロートリガーを実行するコンポーネントを持つ必要があります。 <a href="../ref/Tags/submitButton.html" class="tags">submitButton</a>タグを使用したフォームを使います:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:form&#62;</span>
    <span class="xml&#45;tag">&#60;g:submitButton name=<span class="xml&#45;quote">"continueShopping"</span> value=<span class="xml&#45;quote">"Continue Shopping"</span> /&#62;</span>
    <span class="xml&#45;tag">&#60;g:submitButton name=<span class="xml&#45;quote">"checkout"</span> value=<span class="xml&#45;quote">"Checkout"</span> /&#62;</span>
<span class="xml&#45;tag">&#60;/g:form&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">The form automatically submits back to the <code>shoppingCart</code> flow. The name attribute of each <a href="../ref/Tags/submitButton.html" class="tags">submitButton</a> tag signals which event will be triggered. If you don't have a form you can also trigger an event with the <a href="../ref/Tags/link.html" class="tags">link</a> tag as follows:</div>
フォームは自動的に<code>shoppingCart</code>フローへ送信します。それぞれの<a href="../ref/Tags/submitButton.html" class="tags">submitButton</a>タグのname属性にトリガーするイベントを指定します。フォームを使用しない場合は、次のように<a href="../ref/Tags/link.html" class="tags">link</a>タグをイベントトリガーに使用できます:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:link event=<span class="xml&#45;quote">"checkout"</span> /&#62;</span></pre></div><p class="paragraph"/><blockquote class="note">
Prior to 2.0.0, it was required to specify the controller and/or action in forms and links, which caused the url to change when entering a subflow state. When the controller and action are not specified,
all url's are relative to the main flow execution url, which makes your flows reusable as subflows and prevents issues with the browser's back button.
</blockquote><p class="paragraph"/><h4>アクションからのイベントトリガー <div class="hidden-block">Triggering Events from an Action</div></h4><p class="paragraph"/><div class="hidden-block">To trigger an event from an <code>action</code> you invoke a method. For example there is the built in <code>error()</code> and <code>success()</code> methods. The example below triggers the <code>error()</code> event on validation failure in a transition action:</div>
アクションからイベントをトリガーするには、メソッドを実行します。組込の<code>error()</code>と<code>success()</code>メソッド(トランジションアクション)が有るのでそれを例に使用します。次の例では、トランジションアクションでバリデーションが失敗したら<code>error()</code>イベントをトリガーしています:<p class="paragraph"/><div class="code"><pre>enterPersonalDetails &#123;
   on(<span class="java&#45;quote">"submit"</span>) &#123;
         def p = <span class="java&#45;keyword">new</span> Person(params)
         flow.person = p
         <span class="java&#45;keyword">if</span> (!p.validate()) <span class="java&#45;keyword">return</span> error()
   &#125;.to <span class="java&#45;quote">"enterShipping"</span>
   on(<span class="java&#45;quote">"<span class="java&#45;keyword">return</span>"</span>).to <span class="java&#45;quote">"showCart"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">In this case because of the error the transition action will make the flow go back to the <code>enterPersonalDetails</code> state.</div>
このケースでは、errorトランジションアクションにより、フローは<code>enterPersonalDetails</code>ステートに戻ります。<p class="paragraph"/><div class="hidden-block">With an action state you can also trigger events to redirect flow:</div>
アクションステートでは、リダイレクトフローへイベントをトリガーできます:<p class="paragraph"/><div class="code"><pre>shippingNeeded &#123;
   action &#123;
       <span class="java&#45;keyword">if</span> (params.shippingRequired) yes()
       <span class="java&#45;keyword">else</span> no()
   &#125;
   on(<span class="java&#45;quote">"yes"</span>).to <span class="java&#45;quote">"enterShipping"</span>
   on(<span class="java&#45;quote">"no"</span>).to <span class="java&#45;quote">"enterPayment"</span>
&#125;</pre></div><p class="paragraph"/>

<a name="7.5.4 Flow Scopes"><!-- Legacy link --></a>
<h2 id="flowScopes">7.5.4 フローのスコープ</h2>
<h4>スコープの基礎 <div class="hidden-block">Scope Basics</div></h4><p class="paragraph"/><div class="hidden-block">You'll notice from previous examples that we used a special object called <code>flow</code> to store objects within "flow scope". Grails flows have five different scopes you can utilize:</div>
先ほどの例で、"フロー範囲で有効な"オブジェクトを蓄積する、<code>flow</code>という特殊なオブジェクトを使用しました。Grailsフローでは５つのスコープが利用できます:<p class="paragraph"/><div class="hidden-block">
<ul class="star">
<li><code>request</code> - Stores an object for the scope of the current request</li>
<li><code>flash</code> - Stores the object for the current and next request only</li>
<li><code>flow</code> - Stores objects for the scope of the flow, removing them when the flow reaches an end state</li>
<li><code>conversation</code> - Stores objects for the scope of the conversation including the root flow and nested subflows</li>
<li><code>session</code> - Stores objects in the user's session</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li>request - 現在のリクエスト範囲のオブジェクトを蓄積</li>
<li>flash - 現在と次までが有効範囲のオブジェクトを蓄積</li>
<li>flow - フロー範囲で有効なオブジェクトを蓄積。フローが終了ステートに到達したら削除されます。</li>
<li>conversation - ルートフローやサブフローを含む範囲での対話でのオブジェクトを蓄積</li>
<li>session - ユーザのセッションへオブジェクトを蓄積</li>
</ul><p class="paragraph"/><blockquote class="note">
<div class="hidden-block">Grails service classes can be automatically scoped to a web flow scope. See the documentation on <a href="../guide/single.html#services" class="guide">Services</a> for more information.</div>
Grailsサービスクラスは自動的にflowスコープになります。詳しくは<a href="../guide/single.html#services" class="guide">サービス</a>を参照してください。
</blockquote><p class="paragraph"/><div class="hidden-block">Returning a model Map from an action will automatically result in the model being placed in flow scope. For example, using a transition action, you can place objects within <code>flow</code> scope as follows:</div>
アクションからモデルMapを返すと自動的に結果にあるモデルがflowスコープに配置されます。例としてトランジションアクションで次のように<code>flow</code>スコープにオブジェクトを配置できます:<p class="paragraph"/><div class="code"><pre>enterPersonalDetails &#123;
    on(<span class="java&#45;quote">"submit"</span>) &#123;
        &#91;person: <span class="java&#45;keyword">new</span> Person(params)&#93;
    &#125;.to <span class="java&#45;quote">"enterShipping"</span>
   on(<span class="java&#45;quote">"<span class="java&#45;keyword">return</span>"</span>).to <span class="java&#45;quote">"showCart"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Be aware that a new request is always created for each state, so an object placed in request scope in an action state (for example) will not be available in a subsequent view state. Use one of the other scopes to pass objects from one state to another. Also note that Web Flow:</div>
それぞれのステートごとに新しいrequestスコープができます、(例えば)アクションステートのrequestスコープに配置したオブジェクトは次のビューステートでは使用できません。他のステートにオブジェクトを渡す場合は別のスコープを使いましょう。さらにWebフローでは:<p class="paragraph"/><div class="hidden-block">
<ol>
<li>Moves objects from flash scope to request scope upon transition between states;</li>
<li>Merges objects from the flow and conversation scopes into the view model before rendering (so you shouldn't include a scope prefix when referencing these objects within a view, e.g. GSP pages).</li>
</ol><p class="paragraph"/></div>
<ol>
<li>ステート間のトランジションでオブジェクトをflashスコープからrequestスコープへ移動します。</li>
<li>描写する前に、flowとconversationスコープのオブジェクトをビューモデルにマージします。(GSPページ等のビューでオブジェクトを参照する際はスコープ接頭辞を含まないでください)</li>
</ol><p class="paragraph"/><h4>フロースコープとシリアライズ <div class="hidden-block">Flow Scopes and Serialization</div></h4><p class="paragraph"/><div class="hidden-block">When placing objects in <code>flash</code>, <code>flow</code> or <code>conversation</code> scope they must implement <code>java.io.Serializable</code> or an exception will be thrown. This has an impact on <a href="../guide/single.html#GORM" class="guide">domain classes</a> in that domain classes are typically placed within a scope so that they can be rendered in a view. For example consider the following domain class:</div>
<code>flash</code>、<code>flow</code>また<code>conversation</code>スコープに配置するオブジェクトは、必ず<code>java.io.Serializable</code>を継承してください。継承しない場合は例外を投げます。<a href="../guide/single.html#GORM" class="guide">ドメインクラス</a>は通常スコープに配置されビューの描写に使用するので影響を受けます。例として次のようなドメインクラスがあるとします:<p class="paragraph"/><div class="code"><pre>class Book &#123;
    <span class="java&#45;object">String</span> title
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">To place an instance of the <code>Book</code> class in a flow scope you will need to modify it as follows:</div>
<code>Book</code>のインスタンスをflowスコープで使用する場合は次のようにします:<p class="paragraph"/><div class="code"><pre>class Book <span class="java&#45;keyword">implements</span> Serializable &#123;
    <span class="java&#45;object">String</span> title
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">This also impacts associations and closures you declare within a domain class. For example consider this:</div>
ドメインクラスに関連するクラスやクロージャにも影響があります。次のようになっていたとします:<p class="paragraph"/><div class="code"><pre>class Book <span class="java&#45;keyword">implements</span> Serializable &#123;
    <span class="java&#45;object">String</span> title
    Author author
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Here if the <code>Author</code> association is not <code>Serializable</code> you will also get an error. This also impacts closures used in <a href="../guide/single.html#eventsAutoTimestamping" class="guide">GORM events</a> such as <code>onLoad</code>, <code>onSave</code> and so on. The following domain class will cause an error if an instance is placed in a flow scope:</div>
関連する<code>Author</code>が<code>Serializable</code>では無い場合はエラーとなります。<code>onLoad</code>や<code>onSave</code>等の<a href="../guide/single.html#eventsAutoTimestamping" class="guide">GORMイベント</a>のクロージャにも影響があります。次のドメインクラスをflowスコープに配置するとエラーとなります:<p class="paragraph"/><div class="code"><pre>class Book <span class="java&#45;keyword">implements</span> Serializable &#123;<p class="paragraph"/>    <span class="java&#45;object">String</span> title<p class="paragraph"/>    def onLoad = &#123;
        println <span class="java&#45;quote">"I'm loading"</span>
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">The reason is that the assigned block on the <code>onLoad</code> event cannot be serialized. To get around this you should declare all events as <code>transient</code>:</div>
理由はアサインされた<code>onLoad</code>イベントのブロックがシリアライズされないからです。これを対応させるにはイベントに<code>transient</code>を指定します:<p class="paragraph"/><div class="code"><pre>class Book <span class="java&#45;keyword">implements</span> Serializable &#123;<p class="paragraph"/>    <span class="java&#45;object">String</span> title<p class="paragraph"/>    <span class="java&#45;keyword">transient</span> onLoad = &#123;
        println <span class="java&#45;quote">"I'm loading"</span>
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">or as methods:</div>
またはメソッドにします:<p class="paragraph"/><div class="code"><pre>class Book <span class="java&#45;keyword">implements</span> Serializable &#123;<p class="paragraph"/>    <span class="java&#45;object">String</span> title<p class="paragraph"/>    def onLoad() &#123;
        println <span class="java&#45;quote">"I'm loading"</span>
    &#125;
&#125;</pre></div><p class="paragraph"/><blockquote class="note">
The flow scope contains a reference to the Hibernate session. As a result, any object loaded into the session through a GORM query will also be in the flow and will need to implement Serializable.<p class="paragraph"/>If you don't want your domain class to be Serializable or stored in the flow, then you will need to evict the entity manually before the end of the state:<p class="paragraph"/><div class="code"><pre>flow.persistenceContext.evict(it)</pre></div>
</blockquote>


<a name="7.5.5 Data Binding and Validation"><!-- Legacy link --></a>
<h2 id="dataBindingAndValidation">7.5.5 データバインディングとバリデーション</h2>
<div class="hidden-block">In the section on <a href="../guide/single.html#startAndEndStates" class="guide">start and end states</a>, the start state in the first example triggered a transition to the <code>enterPersonalDetails</code> state. This state renders a view and waits for the user to enter the required information:</div>
<a href="../guide/single.html#startAndEndStates" class="guide">開始と終了ステート</a>のセクションの中で、最初の例の開始ステートは<code>enterPersonalDetails</code>ステートへトリガーしています。このステートはビューを描写して、ユーザが必要な情報をエントリーするのを待ちます:<p class="paragraph"/><div class="code"><pre>enterPersonalDetails &#123;
   on(<span class="java&#45;quote">"submit"</span>).to <span class="java&#45;quote">"enterShipping"</span>
   on(<span class="java&#45;quote">"<span class="java&#45;keyword">return</span>"</span>).to <span class="java&#45;quote">"showCart"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">The view contains a form with two submit buttons that either trigger the submit event or the return event:</div>
ビューは、submitイベントまたはreturnイベントをトリガーする、２つの送信ボタンを持つフォームを持っています:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:form&#62;</span>
    <span class="xml&#45;comment">&#60;!&#45;&#45; Other fields &#45;&#45;&#62;</span>
    <span class="xml&#45;tag">&#60;g:submitButton name=<span class="xml&#45;quote">"submit"</span> value=<span class="xml&#45;quote">"Continue"</span>&#62;</span><span class="xml&#45;tag">&#60;/g:submitButton&#62;</span>
    <span class="xml&#45;tag">&#60;g:submitButton name=<span class="xml&#45;quote">"return"</span> value=<span class="xml&#45;quote">"Back"</span>&#62;</span><span class="xml&#45;tag">&#60;/g:submitButton&#62;</span>
<span class="xml&#45;tag">&#60;/g:form&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">However, what about the capturing the information submitted by the form? To capture the form info we can use a flow transition action:</div>
フォームから送信された情報を取り込むには、トランジションアクションを使用します:<p class="paragraph"/><div class="code"><pre>enterPersonalDetails &#123;
   on(<span class="java&#45;quote">"submit"</span>) &#123;
      flow.person = <span class="java&#45;keyword">new</span> Person(params)
      !flow.person.validate() ? error() : success()
   &#125;.to <span class="java&#45;quote">"enterShipping"</span>
   on(<span class="java&#45;quote">"<span class="java&#45;keyword">return</span>"</span>).to <span class="java&#45;quote">"showCart"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Notice how we perform data binding from request parameters and place the <code>Person</code> instance within <code>flow</code> scope. Also interesting is that we perform <a href="../guide/single.html#validation" class="guide">validation</a> and invoke the <code>error()</code> method if validation fails. This signals to the flow that the transition should halt and return to the <code>enterPersonalDetails</code> view so valid entries can be entered by the user, otherwise the transition should continue and go to the <code>enterShipping</code> state.</div>
リクエストパラメータからデータバインディングを実行して、<code>flow</code>スコープの<code>Person</code>インスタンスに渡している部分を注目してください。さらに興味深い部分は、<a href="../guide/single.html#validation" class="guide">バリデーション</a>を実行して、失敗したら<code>error()</code>メソッドを実行している部分です。この結果を受け取るとトランジションは停止され<code>enterPersonalDetails</code>ビューへ戻りユーザが正当な内容をエントリできるようになります。あるいは内容が問題無ければ、トランジションが続行されて<code>enterShipping</code>ステートへ移動します。<p class="paragraph"/><div class="hidden-block">Like regular actions, flow actions also support the notion of <a href="../guide/single.html#commandObjects" class="guide">Command Objects</a> by defining the first argument of the closure:</div>
通常のアクションと同じく、フローアクションでは、クロージャの最初の引数を定義することで、<a href="../guide/single.html#commandObjects" class="guide">コマンドオブジェクト</a>にも対応できます:<p class="paragraph"/><div class="code"><pre>enterPersonalDetails &#123;
   on(<span class="java&#45;quote">"submit"</span>) &#123; PersonDetailsCommand cmd &#45;&#62;
       flow.personDetails = cmd
      !flow.personDetails.validate() ? error() : success()
   &#125;.to <span class="java&#45;quote">"enterShipping"</span>
   on(<span class="java&#45;quote">"<span class="java&#45;keyword">return</span>"</span>).to <span class="java&#45;quote">"showCart"</span>
&#125;</pre></div>


<a name="7.5.6 Subflows and Conversations"><!-- Legacy link --></a>
<h2 id="subflowsAndConversations">7.5.6 サブフローとの対話</h2>
<div class="hidden-block">Grails' Web Flow integration also supports subflows. A subflow is like a flow within a flow. For example take this search flow:</div>
GrailsのWebフローはサブフローにも対応しています。サブフローはフォローの中にあるフローです。この検索フローを例とします:<p class="paragraph"/><div class="code"><pre>def searchFlow = &#123;
    displaySearchForm &#123;
        on(<span class="java&#45;quote">"submit"</span>).to <span class="java&#45;quote">"executeSearch"</span>
    &#125;
    executeSearch &#123;
        action &#123;
            &#91;results:searchService.executeSearch(params.q)&#93;
        &#125;
        on(<span class="java&#45;quote">"success"</span>).to <span class="java&#45;quote">"displayResults"</span>
        on(<span class="java&#45;quote">"error"</span>).to <span class="java&#45;quote">"displaySearchForm"</span>
    &#125;
    displayResults &#123;
        on(<span class="java&#45;quote">"searchDeeper"</span>).to <span class="java&#45;quote">"extendedSearch"</span>
        on(<span class="java&#45;quote">"searchAgain"</span>).to <span class="java&#45;quote">"displaySearchForm"</span>
    &#125;
    extendedSearch &#123;
        // Extended search subflow
        subflow(controller: <span class="java&#45;quote">"searchExtensions"</span>, action: <span class="java&#45;quote">"extendedSearch"</span>)
        on(<span class="java&#45;quote">"moreResults"</span>).to <span class="java&#45;quote">"displayMoreResults"</span>
        on(<span class="java&#45;quote">"noResults"</span>).to <span class="java&#45;quote">"displayNoMoreResults"</span>
    &#125;
    displayMoreResults()
    displayNoMoreResults()
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">It references a subflow in the <code>extendedSearch</code> state. The controller parameter is optional if the subflow is defined in the same controller as the calling flow.</div>
この例では<code>extendedSearch</code>ステートで中にサブフローを参照しています。サブフローが同じコントローラで呼ばれる場合は、コントローラを指定するパラメータは省略可能です。<p class="paragraph"/><blockquote class="note">
<div class="hidden-block">Prior to 1.3.5, the previous subflow call would look like <code>subflow(new SearchExtensionsController().extendedSearchFlow)</code>, with the requirement that the name of the subflow state be the same as the called subflow (minus <code>Flow</code>). This way of calling a subflow is deprecated and only supported for backward compatibility.</div>
1.3.5以前、サブフローは、<code>subflow(new SearchExtensionsController().extendedSearchFlow)</code>のように呼び出しました。この方法は非推奨となっており、下位互換のために対応はしています。
</blockquote><p class="paragraph"/><div class="hidden-block">The subflow is another flow entirely:</div>
サブフローは完全に別のフローです:<p class="paragraph"/><div class="code"><pre>def extendedSearchFlow = &#123;
    startExtendedSearch &#123;
        on(<span class="java&#45;quote">"findMore"</span>).to <span class="java&#45;quote">"searchMore"</span>
        on(<span class="java&#45;quote">"searchAgain"</span>).to <span class="java&#45;quote">"noResults"</span>
    &#125;
    searchMore &#123;
        action &#123;
           def results = searchService.deepSearch(ctx.conversation.query)
           <span class="java&#45;keyword">if</span> (!results) <span class="java&#45;keyword">return</span> error()
           conversation.extendedResults = results
        &#125;
        on(<span class="java&#45;quote">"success"</span>).to <span class="java&#45;quote">"moreResults"</span>
        on(<span class="java&#45;quote">"error"</span>).to <span class="java&#45;quote">"noResults"</span>
    &#125;
    moreResults()
    noResults()
&#125;</pre></div><p class="paragraph"/>Notice how it places the <code>extendedResults</code> in conversation scope. This scope differs to flow scope as it lets you share state that spans the whole conversation, i.e. a flow execution including all subflows, not just the flow itself. Also notice that the end state (either <code>moreResults</code> or <code>noResults</code> of the subflow triggers the events in the main flow:<p class="paragraph"/><div class="code"><pre>extendedSearch &#123;
    // Extended search subflow
    subflow(controller: <span class="java&#45;quote">"searchExtensions"</span>, action: <span class="java&#45;quote">"extendedSearch"</span>)
    on(<span class="java&#45;quote">"moreResults"</span>).to <span class="java&#45;quote">"displayMoreResults"</span>
    on(<span class="java&#45;quote">"noResults"</span>).to <span class="java&#45;quote">"displayNoMoreResults"</span>
&#125;</pre></div><p class="paragraph"/><h4>Subflow input and output</h4>
Using conversation scope for passing input and output between flows can be compared with using global variables to pass information between methods.
While this is OK in certain situations, it is usually better to use method arguments and return values. In webflow speak, this means defining input and output arguments for flows.<p class="paragraph"/>Consider following flow for searching a person with a certain expertise:<p class="paragraph"/><div class="code"><pre>def searchFlow = &#123;
        input &#123;
            expertise(required: <span class="java&#45;keyword">true</span>)
            title(<span class="java&#45;quote">"Search person"</span>)
        &#125;<p class="paragraph"/>        search &#123;
            onEntry &#123;
                &#91;personInstanceList: Person.findAllByExpertise(flow.expertise)&#93;
            &#125;
            on(<span class="java&#45;quote">"select"</span>) &#123;
                flow.person = Person.get(params.id)
            &#125;.to(<span class="java&#45;quote">"selected"</span>)
            on(<span class="java&#45;quote">"cancel"</span>).to(<span class="java&#45;quote">"cancel"</span>)
        &#125;<p class="paragraph"/>        selected &#123;
            output &#123;
                person &#123;flow.person&#125;
            &#125;
        &#125;
        cancel()
    &#125;<p class="paragraph"/>&#125;</pre></div><p class="paragraph"/>This flow accepts two input parameters:
<ul class="star">
<li>a required expertise argument</li>
<li>an optional title argument with a default value</li>
</ul><p class="paragraph"/>All input arguments are stored in flow scope and are, just like local variables, only visible within this flow.<p class="paragraph"/>A flow that contains required input will throw an exception when an execution is started without providing the input. The consequence is that these flows can only be started as subflows.<p class="paragraph"/>Notice how an end state can define one or more named output values. If the value is a closure, this closure will be evaluated at the end of each flow execution.
If the value is not a closure, the value will be a constant that is only calculated once at flow definition time.<p class="paragraph"/>When a subflow is called, we can provide it a map with input values:<p class="paragraph"/><div class="code"><pre>def newProjectWizardFlow = &#123;
    ...<p class="paragraph"/>    managerSearch &#123;
        subflow(controller: <span class="java&#45;quote">"person"</span>, action: <span class="java&#45;quote">"search"</span>,
                input: &#91;expertise : <span class="java&#45;quote">"management"</span>, title: <span class="java&#45;quote">"Search project manager"</span>&#93;)
        on(<span class="java&#45;quote">"selected"</span>) &#123;
            flow.projectInstance.manager = currentEvent.attributes.person
        &#125;.to <span class="java&#45;quote">"techleadSearch"</span>
    &#125;<p class="paragraph"/>    techleadSearch &#123;
        subflow(controller: <span class="java&#45;quote">"person"</span>, action: <span class="java&#45;quote">"search"</span>,
                input: &#91;expertise : &#123; flow.technology &#125;, title: <span class="java&#45;quote">"Search technical lead"</span>&#93;)
        on(<span class="java&#45;quote">"selected"</span>) &#123;
            flow.projectInstance.techlead = currentEvent.attributes.person
        &#125;.to <span class="java&#45;quote">"projectDetails"</span>
    &#125;<p class="paragraph"/>    ...<p class="paragraph"/>&#125;</pre></div><p class="paragraph"/>Notice again the difference between constant values like <code>expertise : "management"</code> and dynamic values like <code>expertise : { flow.technology }</code><p class="paragraph"/>The subflow output is available via <code>currentEvent.attributes</code>


<a name="7.6 Filters"><!-- Legacy link --></a>
<h2 id="filters">7.6 フィルタ</h2>
<div class="hidden-block">
Although Grails <a href="../guide/single.html#controllers" class="guide">controllers</a> support fine grained interceptors, these are only really useful when applied to a few controllers and become difficult to manage with larger applications. Filters on the other hand can be applied across a whole group of controllers, a URI space or to a specific action. Filters are far easier to plugin and maintain completely separately to your main controller logic and are useful for all sorts of cross cutting concerns such as security, logging, and so on.
</div>
Grailsの<a href="../guide/single.html#controllers" class="guide">コントローラ</a>にはインターセプター機能に対応しています。これらは、少ないコントローラに対しては有用ですが、大きなアプリケーションだと管理が大変になります。その一方フィルタを使用すると、多くのコントローラ、URIスペースや指定したアクションに対して適用できます。フィルタはプラグインにすることも簡単で、コントローラロジックとも切り離されており、セキュリティ、ロギングなどの全体にわたる物として便利です。


<a name="6.6.1 Applying Filters"><!-- Legacy link --></a>
<h2 id="applyingFilters">7.6.1 フィルタの適用</h2>
<div class="hidden-block">To create a filter create a class that ends with the convention <code>Filters</code> in the <code>grails-app/conf</code> directory. Within this class define a code block called <code>filters</code> that contains the filter definitions:</div>
フィルタを作成するには、<code>grails-app/conf</code>ディレクトリに、名称が<code>Filters</code>で終わるクラスを作成します。このクラスにはフィルタを記述する、<code>filters</code>というコードブロックを定義します:<p class="paragraph"/><div class="code"><pre>class ExampleFilters &#123;
   def filters = &#123;
        // your filters here
   &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Each filter you define within the <code>filters</code> block has a name and a scope. The name is the method name and the scope is defined using named arguments. For example to define a filter that applies to all controllers and all actions you can use wildcards:</div>
<code>filters</code>ブロックに定義する各フィルタには、範囲と名称を持たせます。名称はメソッド名で、範囲は引数で定義します。例として、ワイルドカードを使用した全コントローラ・アクションに適用されるフィルタを定義します:<p class="paragraph"/><div class="code"><pre>sampleFilter(controller:'&#42;', action:'&#42;') &#123;
  // interceptor definitions
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">The scope of the filter can be one of the following things:</div>
フィルタの範囲は次のように指定できます:<p class="paragraph"/><div class="hidden-block">
<ul class="star">
<li>A controller and/or action name pairing with optional wildcards</li>
<li>A URI, with Ant path matching syntax</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li>省略可能なワイルドカードを使用した、コントローラ名と(または)アクション名の組み合わせ。</li>
<li>Antパスマッチング書式のURI指定。</li>
</ul><p class="paragraph"/><div class="hidden-block">Filter rule attributes:</div>
フィルタルール属性:
<div class="hidden-block">
<ul class="star">
<li><code>controller</code> - controller matching pattern, by default &#42; is replaced with .&#42; and a regex is compiled</li>
<li><code>controllerExclude</code> - controller exclusion pattern, by default &#42; is replaced with .&#42; and a regex is compiled</li>
<li><code>action</code> - action matching pattern, by default &#42; is replaced with .&#42; and a regex is compiled</li>
<li><code>actionExclude</code> - action exclusion pattern, by default &#42; is replaced with .&#42; and a regex is compiled</li>
<li><code>regex</code> (<code>true</code>/<code>false</code>) - use regex syntax (don't replace '&#42;' with '.&#42;')</li>
<li><code>uri</code> - a uri to match, expressed with as Ant style path (e.g. /book/&#42;&#42;)</li>
<li><code>uriExclude</code> - a uri pattern to exclude, expressed with as Ant style path (e.g. /book/&#42;&#42;)</li>
<li><code>find</code> (<code>true</code>/<code>false</code>) - rule matches with partial match (see <code>java.util.regex.Matcher.find()</code>)</li>
<li><code>invert</code> (<code>true</code>/<code>false</code>) - invert the rule (NOT rule)</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li><code>controller</code> - コントローラ対象のパターンマッチング, 既存値 &#42; で正規表現コンパイル時には .&#42;に置換されます。</li>
<li><code>controllerExclude</code> - 除外するコントローラのパターン, 既存値 &#42; で正規表現コンパイル時には .&#42;に置換されます。</li>
<li><code>action</code> - アクション対象のパターンマッチング, 既存値 &#42; で正規表現コンパイル時には .&#42;に置換されます。</li>
<li><code>actionExclude</code> - 除外するアクションのパターン, 既存値 &#42; で正規表現コンパイル時には .&#42;に置換されます。</li>
<li><code>regex (true/false)</code> - 正規表現の使用 ('&#42;' を '.&#42;'に置換しない指定)</li>
<li><code>uri</code> - URIマッチ, Antスタイルパス (e.g. /book/&#42;&#42;)</li>
<li><code>uriExclude</code> - 除外するURIパターン, Antスタイルパス (e.g. /book/&#42;&#42;)</li>
<li><code>find (true/false)</code> - 部分マッチ (<code>java.util.regex.Matcher.find()</code>を参照)</li>
<li><code>invert (true/false)</code> - ルールを逆にする</li>
</ul><p class="paragraph"/><div class="hidden-block">Some examples of filters include:</div>
フィルタの例:
<div class="hidden-block">
<ul class="star">
<li>All controllers and actions</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li>全てのコントローラとアクション</li>
</ul><p class="paragraph"/><div class="code"><pre>all(controller: '&#42;', action: '&#42;') &#123;<p class="paragraph"/>&#125;</pre></div>
<div class="hidden-block">
<ul class="star">
<li>Only for the <code>BookController</code></li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li><code>BookController</code>のみ</li>
</ul><p class="paragraph"/><div class="code"><pre>justBook(controller: 'book', action: '&#42;') &#123;<p class="paragraph"/>&#125;</pre></div>
<div class="hidden-block">
<ul class="star">
<li>All controllers except the <code>BookController</code></li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li><code>BookController</code>以外の全て</li>
</ul><p class="paragraph"/><div class="code"><pre>notBook(controller: 'book', invert: <span class="java&#45;keyword">true</span>) &#123;<p class="paragraph"/>&#125;</pre></div>
<div class="hidden-block">
<ul class="star">
<li>All actions containing 'save' in the action name</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li>'save'を名称に含めたアクション全て</li>
</ul><p class="paragraph"/><div class="code"><pre>saveInActionName(action: '&#42;save&#42;', find: <span class="java&#45;keyword">true</span>) &#123;<p class="paragraph"/>&#125;</pre></div>
<div class="hidden-block">
<ul class="star">
<li>All actions starting with the letter 'b' except for actions beginning with the phrase 'bad*'</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li>"bad&#42;"を除外した、'b'で始まるアクション全て</li>
</ul><p class="paragraph"/><div class="code"><pre>actionBeginningWithBButNotBad(action: 'b&#42;', actionExclude: 'bad&#42;', find: <span class="java&#45;keyword">true</span>) &#123;<p class="paragraph"/>&#125;</pre></div>
<div class="hidden-block">
<ul class="star">
<li>Applied to a URI space</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li>URIへ適用</li>
</ul><p class="paragraph"/><div class="code"><pre>someURIs(uri: '/book/&#42;&#42;') &#123;<p class="paragraph"/>&#125;</pre></div>
<div class="hidden-block">
<ul class="star">
<li>Applied to all URIs</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li>全てのURIに適用</li>
</ul><p class="paragraph"/><div class="code"><pre>allURIs(uri: '/&#42;&#42;') &#123;<p class="paragraph"/>&#125;</pre></div><p class="paragraph"/><div class="hidden-block">In addition, the order in which you define the filters within the <code>filters</code> code block dictates the order in which they are executed.  To control the order of execution between <code>Filters</code> classes, you can use the <code>dependsOn</code> property discussed in <a href="../guide/single.html#filterDependencies" class="guide">filter dependencies</a> section.</div>
<code>filters</code>コードブロックに定義した順序でフィルタは実行されます。<code>Filters</code>クラス間での実行を制御するには、<a href="../guide/single.html#filterDependencies" class="guide">フィルタ依存</a>セクションで記載されている<code>dependsOn</code>プロパティが使用できます。<p class="paragraph"/><blockquote class="note">
<div class="hidden-block">
Note: When exclude patterns are used they take precedence over the matching patterns.  For example, if action is 'b&#42;' and actionExclude is 'bad&#42;' then actions like 'best' and 'bien' will have that filter applied but actions like 'bad' and 'badlands' will not.
</div>
注意:除外パターンが使用された場合は除外マッチングパターンが優先されます。例として、アクションが'b&#42;' で、actionExcludeが'bad&#42;'の場合、'best','bien'等のアクションは適用されますが、'bad','badland'は適用されません。
</blockquote>


<a name="6.6.2 Filter Types"><!-- Legacy link --></a>
<h2 id="filterTypes">7.6.2 フィルタの種類</h2>
<div class="hidden-block">Within the body of the filter you can then define one or several of the following interceptor types for the filter:</div>
フィルタの中に、幾つかのインターセプタを定義することができます。<p class="paragraph"/><div class="hidden-block">
<ul class="star">
<li><code>before</code> - Executed before the action. Return <code>false</code> to indicate that the response has been handled that that all future filters and the action should not execute</li>
<li><code>after</code> - Executed after an action. Takes a first argument as the view model to allow modification of the model before rendering the view</li>
<li><code>afterView</code> - Executed after view rendering.  Takes an Exception as an argument which will be non-<code>null</code> if an exception occurs during processing. Note: this Closure is called before the layout is applied.</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li><code>before</code> - アクションの前に実行されます。<code>false</code>を返す事で、その後に実行されるフィルタとアクションは実行されません。</li>
<li><code>after</code> - アクションの後に実行されます。最初の引数に、ビュー描写前に変更可能なビューモデルが渡されます。</li>
<li><code>afterView</code> - ビュー描写後に実行されます。実行時に例外が発生した場合は<code>non-null</code>なExceptionが引数として渡されます。このクロージャはレイアウトが適用される前に実行されます。</li>
</ul><p class="paragraph"/><div class="hidden-block">For example to fulfill the common simplistic authentication use case you could define a filter as follows:</div>
シンプルな認証の仕組みとしてフィルタを定義する例です:
<div class="code"><pre>class SecurityFilters &#123;
   def filters = &#123;
       loginCheck(controller: '&#42;', action: '&#42;') &#123;
           before = &#123;
              <span class="java&#45;keyword">if</span> (!session.user &#38;&#38; !actionName.equals('login')) &#123;
                  redirect(action: 'login')
                  <span class="java&#45;keyword">return</span> <span class="java&#45;keyword">false</span>
               &#125;
           &#125;
       &#125;
   &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Here the <code>loginCheck</code> filter uses a <code>before</code> interceptor to execute a block of code that checks if a user is in the session and if not redirects to the login action. Note how returning false ensure that the action itself is not executed.</div>
この<code>loginCheck</code>フィルタは、<code>before</code>インターセプタのコードブロックを実行することで、ユーザがセッションに無い場合はloginアクションへリダイレクトしています。falseを返す事で対象のアクション自身が実行されないようにします。<p class="paragraph"/>
Here's a more involved example that demonstrates all three filter types:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> java.util.concurrent.atomic.AtomicLong<p class="paragraph"/>class LoggingFilters &#123;<p class="paragraph"/>   <span class="java&#45;keyword">private</span> <span class="java&#45;keyword">static</span> <span class="java&#45;keyword">final</span> AtomicLong REQUEST_NUMBER_COUNTER = <span class="java&#45;keyword">new</span> AtomicLong()
   <span class="java&#45;keyword">private</span> <span class="java&#45;keyword">static</span> <span class="java&#45;keyword">final</span> <span class="java&#45;object">String</span> START_TIME_ATTRIBUTE = 'Controller__START_TIME__'
   <span class="java&#45;keyword">private</span> <span class="java&#45;keyword">static</span> <span class="java&#45;keyword">final</span> <span class="java&#45;object">String</span> REQUEST_NUMBER_ATTRIBUTE = 'Controller__REQUEST_NUMBER__'<p class="paragraph"/>   def filters = &#123;<p class="paragraph"/>      logFilter(controller: '&#42;', action: '&#42;') &#123;<p class="paragraph"/>         before = &#123;
            <span class="java&#45;keyword">if</span> (!log.debugEnabled) <span class="java&#45;keyword">return</span> <span class="java&#45;keyword">true</span><p class="paragraph"/>            <span class="java&#45;object">long</span> start = <span class="java&#45;object">System</span>.currentTimeMillis()
            <span class="java&#45;object">long</span> currentRequestNumber = REQUEST_NUMBER_COUNTER.incrementAndGet()<p class="paragraph"/>            request&#91;START_TIME_ATTRIBUTE&#93; = start
            request&#91;REQUEST_NUMBER_ATTRIBUTE&#93; = currentRequestNumber<p class="paragraph"/>            log.debug <span class="java&#45;quote">"preHandle request &#35;&#36;currentRequestNumber : "</span> +
               <span class="java&#45;quote">"'&#36;request.servletPath'/'&#36;request.forwardURI', "</span> +
               <span class="java&#45;quote">"from &#36;request.remoteHost (&#36;request.remoteAddr) "</span> +
               <span class="java&#45;quote">" at &#36;&#123;<span class="java&#45;keyword">new</span> Date()&#125;, Ajax: &#36;request.xhr, controller: &#36;controllerName, "</span> +
               <span class="java&#45;quote">"action: &#36;actionName, params: &#36;&#123;<span class="java&#45;keyword">new</span> TreeMap(params)&#125;"</span><p class="paragraph"/>            <span class="java&#45;keyword">return</span> <span class="java&#45;keyword">true</span>
         &#125;<p class="paragraph"/>         after = &#123; Map model &#45;&#62;<p class="paragraph"/>            <span class="java&#45;keyword">if</span> (!log.debugEnabled) <span class="java&#45;keyword">return</span> <span class="java&#45;keyword">true</span><p class="paragraph"/>            <span class="java&#45;object">long</span> start = request&#91;START_TIME_ATTRIBUTE&#93;
            <span class="java&#45;object">long</span> end = <span class="java&#45;object">System</span>.currentTimeMillis()
            <span class="java&#45;object">long</span> requestNumber = request&#91;REQUEST_NUMBER_ATTRIBUTE&#93;<p class="paragraph"/>            def msg = <span class="java&#45;quote">"postHandle request &#35;&#36;requestNumber: end &#36;&#123;<span class="java&#45;keyword">new</span> Date()&#125;, "</span> +
                      <span class="java&#45;quote">"controller total time &#36;&#123;end &#45; start&#125;ms"</span>
            <span class="java&#45;keyword">if</span> (log.traceEnabled) &#123;
            	log.trace msg + <span class="java&#45;quote">"; model: &#36;model"</span>
            &#125;
            <span class="java&#45;keyword">else</span> &#123;
            	log.debug msg
            &#125;
         &#125;<p class="paragraph"/>         afterView = &#123; Exception e &#45;&#62;<p class="paragraph"/>            <span class="java&#45;keyword">if</span> (!log.debugEnabled) <span class="java&#45;keyword">return</span> <span class="java&#45;keyword">true</span><p class="paragraph"/>            <span class="java&#45;object">long</span> start = request&#91;START_TIME_ATTRIBUTE&#93;
            <span class="java&#45;object">long</span> end = <span class="java&#45;object">System</span>.currentTimeMillis()
            <span class="java&#45;object">long</span> requestNumber = request&#91;REQUEST_NUMBER_ATTRIBUTE&#93;<p class="paragraph"/>            def msg = <span class="java&#45;quote">"afterCompletion request &#35;&#36;requestNumber: "</span> +
                      <span class="java&#45;quote">"end &#36;&#123;<span class="java&#45;keyword">new</span> Date()&#125;, total time &#36;&#123;end &#45; start&#125;ms"</span>
            <span class="java&#45;keyword">if</span> (e) &#123;
               log.debug <span class="java&#45;quote">"&#36;msg &#92;n&#92;texception: &#36;e.message"</span>, e
            &#125;
            <span class="java&#45;keyword">else</span> &#123;
               log.debug msg
            &#125;
         &#125;
      &#125;
   &#125;
&#125;</pre></div><p class="paragraph"/>In this logging example we just log various request information, but note that the <code>model</code> map in the <code>after</code> filter is mutable. If you need to add or remove items from the model map you can do that in the <code>after</code> filter.



<h2 id="filterVariablesAndScopes">7.6.3 変数とスコープ</h2>
<div class="hidden-block">Filters support all the common properties available to <a href="../guide/single.html#controllers" class="guide">controllers</a> and <a href="../guide/single.html#taglibs" class="guide">tag libraries</a>, plus the application context:</div>
フィルタでは、<a href="../guide/single.html#controllers" class="guide">コントローラ</a>や<a href="../guide/single.html#taglibs" class="guide">タグライブラリ</a>で利用できる共通のプロパティとアプリケーションコンテキストを参照できます:<p class="paragraph"/><div class="hidden-block">
<ul class="star">
<li><a href="../ref/Controllers/request.html" class="controllers">request</a> - The HttpServletRequest object</li>
<li><a href="../ref/Controllers/response.html" class="controllers">response</a> - The HttpServletResponse object</li>
<li><a href="../ref/Controllers/session.html" class="controllers">session</a> - The HttpSession object</li>
<li><a href="../ref/Controllers/servletContext.html" class="controllers">servletContext</a> - The ServletContext object</li>
<li><a href="../ref/Controllers/flash.html" class="controllers">flash</a> - The flash object</li>
<li><a href="../ref/Controllers/params.html" class="controllers">params</a> - The request parameters object</li>
<li><a href="../ref/Controllers/actionName.html" class="controllers">actionName</a> - The action name that is being dispatched to</li>
<li><a href="../ref/Controllers/controllerName.html" class="controllers">controllerName</a> - The controller name that is being dispatched to</li>
<li><a href="../ref/Controllers/grailsApplication.html" class="controllers">grailsApplication</a> - The Grails application currently running</li>
<li><a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/context/ApplicationContext.html" class="api">applicationContext</a> - The ApplicationContext object</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li><a href="../ref/Controllers/request.html" class="controllers">request</a> - HttpServletRequestオブジェクト</li>
<li><a href="../ref/Controllers/response.html" class="controllers">response</a> - HttpServletResponseオブジェクト</li>
<li><a href="../ref/Controllers/session.html" class="controllers">session</a> - HttpSessionオブジェクト</li>
<li><a href="../ref/Controllers/servletContext.html" class="controllers">servletContext</a> - ServletContextオブジェクト</li>
<li><a href="../ref/Controllers/flash.html" class="controllers">flash</a> - flashオブジェクト</li>
<li><a href="../ref/Controllers/params.html" class="controllers">params</a> - リクエストパラメータオブジェクト</li>
<li><a href="../ref/Controllers/actionName.html" class="controllers">actionName</a> - ディスパッチ対象のアクション名</li>
<li><a href="../ref/Controllers/controllerName.html" class="controllers">controllerName</a> - ディスパッチ対象のコントローラ名</li>
<li><a href="../ref/Controllers/grailsApplication.html" class="controllers">grailsApplication</a> - 起動中のGrailsアプリケーション</li>
<li><a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/context/ApplicationContext.html" class="api">applicationContext</a> - ApplicationContextオブジェクト</li>
</ul><p class="paragraph"/><div class="hidden-block">However, filters only support a subset of the methods available to controllers and tag libraries. These include:</div>
フィルタではコントローラやタグライブラリで使用できる一部のメソッドが使用できます:<p class="paragraph"/><div class="hidden-block">
<ul class="star">
<li><a href="../ref/Controllers/redirect.html" class="controllers">redirect</a> - For redirects to other controllers and actions</li>
<li><a href="../ref/Controllers/render.html" class="controllers">render</a> - For rendering custom responses</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li><a href="../ref/Controllers/redirect.html" class="controllers">redirect</a> - 他のコントローラやアクションにリダイレクトを行う</li>
<li><a href="../ref/Controllers/render.html" class="controllers">render</a> - カスタムレスポンスを返す。</li>
</ul><p class="paragraph"/>

<a name="6.6.4 Filter Dependencies"><!-- Legacy link --></a>
<h2 id="filterDependencies">7.6.4 フィルタ依存関係</h2>
<div class="hidden-block">In a <code>Filters</code> class, you can specify any other <code>Filters</code> classes that should first be executed using the <code>dependsOn</code> property. This is used when a <code>Filters</code> class depends on the behavior of another <code>Filters</code> class (e.g. setting up the environment, modifying the request/session, etc.) and is defined as an array of <code>Filters</code> classes.</div>
<code>Filters</code>クラスでは、<code>dependsOn</code>プロパティに他の<code>Filters</code>クラスを定義して先に実行させることが可能です。この機能は<code>Filters</code>クラスが他の<code>Filters</code>クラスの振る舞いに依存する場合等に使用します。<p class="paragraph"/><div class="hidden-block">Take the following example <code>Filters</code> classes:</div>
<code>Filters</code>クラスの例を見ていきましょう:<p class="paragraph"/><div class="code"><pre>class MyFilters &#123;
    def dependsOn = &#91;MyOtherFilters&#93;<p class="paragraph"/>    def filters = &#123;
        checkAwesome(uri: <span class="java&#45;quote">"/&#42;"</span>) &#123;
            before = &#123;
                <span class="java&#45;keyword">if</span> (request.isAwesome) &#123; // <span class="java&#45;keyword">do</span> something awesome &#125;
            &#125;
        &#125;<p class="paragraph"/>        checkAwesome2(uri: <span class="java&#45;quote">"/&#42;"</span>) &#123;
            before = &#123;
                <span class="java&#45;keyword">if</span> (request.isAwesome) &#123; // <span class="java&#45;keyword">do</span> something <span class="java&#45;keyword">else</span> awesome &#125;
            &#125;
        &#125;
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="code"><pre>class MyOtherFilters &#123;
    def filters = &#123;
        makeAwesome(uri: <span class="java&#45;quote">"/&#42;"</span>) &#123;
            before = &#123;
                request.isAwesome = <span class="java&#45;keyword">true</span>
            &#125;
        &#125;
        doNothing(uri: <span class="java&#45;quote">"/&#42;"</span>) &#123;
            before = &#123;
                // <span class="java&#45;keyword">do</span> nothing
            &#125;
        &#125;
    &#125;
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">MyFilters specifically <code>dependsOn</code> MyOtherFilters.  This will cause all the filters in MyOtherFilters whose scope matches the current request to be executed before those in MyFilters. For a request of "/test", which will match the scope of every filter in the example, the execution order would be as follows:</div>
MyFiltersには、<code>dependsOn</code>にMyOtherFiltersを指定しています。これにより、リクエストがフィルタ範囲にマッチしたMyOtherFiltersのフィルタがMyFiltersの前に実行されます。この例では"/test"とリクエストした場合全てのフィルタにマッチします。フィルタ実行順は次のようになります:
<ul class="star">
<li>MyOtherFilters - makeAwesome</li>
<li>MyOtherFilters - doNothing</li>
<li>MyFilters - checkAwesome</li>
<li>MyFilters - checkAwesome2</li>
</ul><p class="paragraph"/><div class="hidden-block">The filters within the MyOtherFilters class are processed in order first, followed by the filters in the MyFilters class.  Execution order between <code>Filters</code> classes are enabled and the execution order of filters within each <code>Filters</code> class are preserved.</div>
MyOtherFiltersクラスのフィルタが先に実行されて、MyFiltersクラスのフィルタへと続きます。<code>Filters</code>クラスの実行順が可能になり、各<code>Filters</code>クラスのフィルタ実行順も保っています。<p class="paragraph"/><div class="hidden-block">If any cyclical dependencies are detected, the filters with cyclical dependencies will be added to the end of the filter chain and processing will continue.  Information about any cyclical dependencies that are detected will be written to the logs.  Ensure that your root logging level is set to at least WARN or configure an appender for the Grails Filters Plugin (<code>org.codehaus.groovy.grails.plugins.web.filters.FiltersGrailsPlugin</code>) when debugging filter dependency issues.</div>
循環依存関係を検出したら、循環依存関係のあるフィルタをフィルタチェインの最後に追加して処理を続行します。その後、循環依存関係を検出した事をログへ出力します。ログを出力するには、ルートロガーレベルがWARNに設定されFilers用のログ定義をする必要があります。


<a name="7.7 Ajax"><!-- Legacy link --></a>
<h2 id="ajax">7.7 Ajax</h2>
<div class="hidden-block">Ajax is the driving force behind the shift to richer web applications. These types of applications in general are better suited to agile, dynamic frameworks written in languages like <a href="http://groovy.codehaus.org" target="blank">Groovy</a> and <a href="http://www.ruby-lang.org/." target="blank">Ruby</a> Grails provides support for building Ajax applications through its Ajax tag library. For a full list of these see the Tag Library Reference.</div>
AjaxはリッチWebアプリケーションでは欠かせない物となっています。この手のアプリケーションには通常、GroovyやRuby等で実装されたアジャイル、ダイナミックフレームワークがお似合いです。GrailsではAjaxアプリケーションを構築をサポートするためのAjaxタグライブラリを提供しています。Ajaxタグライブラリのリストはタグリファレンスを参照してください。<p class="paragraph"/><blockquote class="note">
Note: JavaScript examples use the jQuery library.
</blockquote>


<a name="7.7.1 Ajax Support"><!-- Legacy link --></a>
<h2 id="ajaxSupport">7.7.1 Ajax対応</h2>
<div class="hidden-block">
By default Grails ships with the <a href="http://jquery.com/" target="blank">jQuery</a> library, but through the <a href="../guide/single.html#plugins" class="guide">Plugin system</a> provides support for other frameworks such as <a href="http://www.prototypejs.org/" target="blank">Prototype</a>, Dojo:http://dojotoolkit.org/, Yahoo UI:http://developer.yahoo.com/yui/ and the <a href="http://code.google.com/webtoolkit/" target="blank">Google Web Toolkit</a>.
</div>
Grailsはデフォルトで <a href="http://jquery.com/" target="blank">jQuery</a> を使用しています。他のライブラリ、<a href="http://www.prototypejs.org/" target="blank">Prototype</a>、 <a href="http://dojotoolkit.org/" target="blank">Dojo</a>、 <a href="http://developer.yahoo.com/yui/" target="blank">Yahoo UI</a>、 <a href="http://code.google.com/webtoolkit/" target="blank">Google Web Toolkit</a>等もプラグインで提供しています。<p class="paragraph"/><div class="hidden-block">This section covers Grails' support for Ajax in general. To get started, add this line to the <code>&#60;head&#62;</code> tag of your page:</div>
このセクションでは全般的なAjax対応の説明をします。先ずはじめに、ページの<code>&#60;head&#62;</code>タグ内に以下を追加します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:javascript library=<span class="xml&#45;quote">"jquery"</span> /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">You can replace <code>jQuery</code> with any other library supplied by a plugin you have installed. This works because of Grails' support for adaptive tag libraries. Thanks to Grails' plugin system there is support for a number of different Ajax libraries including (but not limited to):</div>
プラグインで提供された他のライブラリを使用する際は、<code>jquery</code>の部分を入れ換えます。これはGrailsの適用性のあるタグライブラリで可能にしています。Grailsのプラグインには、次の様々なAjaxライブラリが存在します(これは一部です):
<ul class="star">
<li>jQuery</li>
<li>Prototype</li>
<li>Dojo</li>
<li>YUI</li>
<li>MooTools</li>
</ul><p class="paragraph"/>

<a name="7.7.1.1 Remoting Linking"><!-- Legacy link --></a>
<h2 id="remotingLinking">7.7.1.1 リモートリンク</h2>
<div class="hidden-block">Remote content can be loaded in a number of ways, the most commons way is through the <a href="../ref/Tags/remoteLink.html" class="tags">remoteLink</a> tag. This tag allows the creation of HTML anchor tags that perform an asynchronous request and optionally set the response in an element. The simplest way to create a remote link is as follows:</div>
多くの方法でリモートコンテントをロードすることが可能ですが、一般的な方法として<a href="../ref/Tags/remoteLink.html" class="tags">remoteLink</a>タグを使用します。
このタグは、非同期リクエストと結果をエレメントにセット(省略可能)するHTMLアンカータグを生成します。リモートリンクタグを作成する簡単な例は次のようになります:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:remoteLink action=<span class="xml&#45;quote">"delete"</span> id=<span class="xml&#45;quote">"1"</span>&#62;</span>Delete Book<span class="xml&#45;tag">&#60;/g:remoteLink&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">The above link sends an asynchronous request to the <code>delete</code> action of the current controller with an id of <code>1</code>.</div>
上記の例で生成されたタグは、id:1をリクエストパラメータとして<code>delete</code>アクションに非同期リクエストを送信します。


<a name="7.7.1.2 Updating Content"><!-- Legacy link --></a>
<h2 id="updatingContent">7.7.1.2 コンテンツの更新</h2>
<div class="hidden-block">This is great, but usually you provide feedback to the user about what happened:</div>
先ほどの例で非同期送信を行いましたが、通常ユーザへ何が行われたかのフィードバックを提供する必要があります:<p class="paragraph"/><div class="code"><pre>def delete() &#123;
    def b = Book.get(params.id)
    b.delete()
    render <span class="java&#45;quote">"Book $&#123;b.id&#125; was deleted"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">GSP code:</div>
GSPコード:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;div id=<span class="xml&#45;quote">"message"</span>&#62;</span><span class="xml&#45;tag">&#60;/div&#62;</span>
<span class="xml&#45;tag">&#60;g:remoteLink action=<span class="xml&#45;quote">"delete"</span> id=<span class="xml&#45;quote">"1"</span> update=<span class="xml&#45;quote">"message"</span>&#62;</span>
Delete Book
<span class="xml&#45;tag">&#60;/g:remoteLink&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">The above example will call the action and set the contents of the <code>message</code> <code>div</code> to the response in this case <code>"Book 1 was deleted"</code>. This is done by the <code>update</code> attribute on the tag, which can also take a Map to indicate what should be updated on failure:</div>
この例では対象のアクションをコールしてレスポンスを<code>messege</code>のidをもった<code>div</code>エレメントの内容を<code>"Book 1 was deleted"</code>に更新します。この更新動作は、タグの<code>update</code>属性で対象を指定しています。さらにMapを使用して更新失敗時の表示先も指定できます:<p class="paragraph"/>
<div class="code"><pre><span class="xml&#45;tag">&#60;div id=<span class="xml&#45;quote">"message"</span>&#62;</span><span class="xml&#45;tag">&#60;/div&#62;</span>
<span class="xml&#45;tag">&#60;div id=<span class="xml&#45;quote">"error"</span>&#62;</span><span class="xml&#45;tag">&#60;/div&#62;</span>
<span class="xml&#45;tag">&#60;g:remoteLink update=<span class="xml&#45;quote">"&#91;success: 'message', failure: 'error'&#93;"</span>
              action=<span class="xml&#45;quote">"delete"</span> id=<span class="xml&#45;quote">"1"</span>&#62;</span>
Delete Book
<span class="xml&#45;tag">&#60;/g:remoteLink&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Here the <code>error</code> div will be updated if the request failed.</div>
この例ではリクエストに失敗すると、<code>error</code>のIDをもつdivタグ内が更新されます。


<a name="7.7.1.3 Remote Form Submission"><!-- Legacy link --></a>
<h2 id="remoteFormSubmission">7.7.1.3 リモートフォーム送信</h2>
<div class="hidden-block">An HTML form can also be submitted asynchronously in one of two ways. Firstly using the <a href="../ref/Tags/formRemote.html" class="tags">formRemote</a> tag which expects similar attributes to those for the <a href="../ref/Tags/remoteLink.html" class="tags">remoteLink</a> tag:</div>
HTMLフォームを非同期で送信することができます。<a href="../ref/Tags/remoteLink.html" class="tags">remoteLink</a>タグと同じような属性を使用できる<a href="../ref/Tags/formRemote.html" class="tags">formRemote</a>タグを使用する例です:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:formRemote url=<span class="xml&#45;quote">"&#91;controller: 'book', action: 'delete'&#93;"</span>
              update=<span class="xml&#45;quote">"&#91;success: 'message', failure: 'error'&#93;"</span>&#62;</span>
    <span class="xml&#45;tag">&#60;input type=<span class="xml&#45;quote">"hidden"</span> name=<span class="xml&#45;quote">"id"</span> value=<span class="xml&#45;quote">"1"</span> /&#62;</span>
    <span class="xml&#45;tag">&#60;input type=<span class="xml&#45;quote">"submit"</span> value=<span class="xml&#45;quote">"Delete Book!"</span> /&#62;</span>
<span class="xml&#45;tag">&#60;/g:formRemote &#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Or alternatively you can use the <a href="../ref/Tags/submitToRemote.html" class="tags">submitToRemote</a> tag to create a submit button. This allows some buttons to submit remotely and some not depending on the action:</div>
他の方法として、<a href="../ref/Tags/submitToRemote.html" class="tags">submitToRemote</a>タグを使用して送信ボタンを作成します。このボタンで非同期送信ボタンを可能として、アクションに依存させなくできます:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;form action=<span class="xml&#45;quote">"delete"</span>&#62;</span>
    <span class="xml&#45;tag">&#60;input type=<span class="xml&#45;quote">"hidden"</span> name=<span class="xml&#45;quote">"id"</span> value=<span class="xml&#45;quote">"1"</span> /&#62;</span>
    <span class="xml&#45;tag">&#60;g:submitToRemote action=<span class="xml&#45;quote">"delete"</span>
                      update=<span class="xml&#45;quote">"&#91;success: 'message', failure: 'error'&#93;"</span> /&#62;</span>
<span class="xml&#45;tag">&#60;/form&#62;</span></pre></div><p class="paragraph"/>

<a name="7.7.1.4 Ajax Events"><!-- Legacy link --></a>
<h2 id="ajaxEvents">7.7.1.4 Ajaxイベント</h2>
<div class="hidden-block">Specific JavaScript can be called if certain events occur, all the events start with the "on" prefix and let you give feedback to the user where appropriate, or take other action:</div>
指定したJavaScriptを、イベントが発生した際にコールすることができます。全てのイベントは接頭辞"on"で指定します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:remoteLink action=<span class="xml&#45;quote">"show"</span>
              id=<span class="xml&#45;quote">"1"</span>
              update=<span class="xml&#45;quote">"success"</span>
              onLoading=<span class="xml&#45;quote">"showProgress()"</span>
              onComplete=<span class="xml&#45;quote">"hideProgress()"</span>&#62;</span>Show Book 1<span class="xml&#45;tag">&#60;/g:remoteLink&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">The above code will execute the "showProgress()" function which may show a progress bar or whatever is appropriate. Other events include:</div>
上記のコードでは、実行されると、ロード時に指定した"showProgress()"ファンクションがプログレスバーを表示する等ファンクションの実装に対応した動作を行います。他に以下のイベントが使用可能です:<p class="paragraph"/><div class="hidden-block">
<ul class="star">
<li><code>onSuccess</code>  - The JavaScript function to call if successful</li>
<li><code>onFailure</code>  - The JavaScript function to call if the call failed</li>
<li><code>on_ERROR_CODE</code>  - The JavaScript function to call to handle specified error codes (eg on404="alert('not found!')")</li>
<li><code>onUninitialized</code>  - The JavaScript function to call the a Ajax engine failed to initialise</li>
<li><code>onLoading</code>  - The JavaScript function to call when the remote function is loading the response</li>
<li><code>onLoaded</code>  - The JavaScript function to call when the remote function is completed loading the response</li>
<li><code>onComplete</code>  - The JavaScript function to call when the remote function is complete, including any updates</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li><code>onSuccess</code> - 成功した時に呼び出すJavaScriptファンクション</li>
<li><code>onFailure</code> - 失敗した時に呼び出すJavaScriptファンクション</li>
<li><code>on_ERROR_CODE</code> - 指定したエラーコードを取得したら呼び出すJavaScriptファンクション (eg on404="alert('not found!')")</li>
<li><code>onUninitialized</code> - Ajaxエンジンの初期化に失敗したときに呼び出すJavaScriptファンクション</li>
<li><code>onLoading</code> - レスポンスを読み込み中に呼び出すJavaScriptファンクション</li>
<li><code>onLoaded</code> - レスポンスの読み込み完了時に呼び出すJavaScriptファンクション</li>
<li><code>onComplete</code> - リモートファンクションが完全に完了(更新を含む)したら呼び出すJavaScriptファンクション</li>
</ul><p class="paragraph"/><div class="hidden-block">You can simply refer to the <code>XMLHttpRequest</code> variable to obtain the request:</div>
リクエストを取得するには、単純に<code>XMLHttpRequest</code>変数で参照できます:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:javascript&#62;</span>
    function fireMe(event) &#123;
        alert(<span class="xml&#45;quote">"XmlHttpRequest = "</span> + event)
    &#125;
&#125;
<span class="xml&#45;tag">&#60;/g:javascript&#62;</span>
<span class="xml&#45;tag">&#60;g:remoteLink action=<span class="xml&#45;quote">"example"</span>
              update=<span class="xml&#45;quote">"success"</span>
              onFailure=<span class="xml&#45;quote">"fireMe(XMLHttpRequest)"</span>&#62;</span>Ajax Link<span class="xml&#45;tag">&#60;/g:remoteLink&#62;</span></pre></div>


<a name="7.7.2 Ajax with Prototype"><!-- Legacy link --></a>
<h2 id="ajaxWithPrototype">7.7.2 Prototypeを使用したAjax</h2>
<div class="hidden-block">Grails features an external plugin to add <a href="http://www.prototypejs.org/" target="blank">Prototype</a> support to Grails. To install the plugin, list it in BuildConfig.groovy:</div>
<a href="http://www.prototypejs.org/" target="blank">Prototype</a> はプラグインで対応しています。インストールするにはBuildConfig.groovyにプラグインを定義します:<p class="paragraph"/><div class="code"><pre>runtime <span class="java&#45;quote">"&#58;prototype&#58;latest.release"</span></pre></div><p class="paragraph"/><div class="hidden-block">This will download the current supported version of the Prototype plugin and install it into your Grails project. With that done you can add the following reference to the top of your page:</div>
このコマンドでPrototypeプラグインがダウンロードされプロジェクトにインストールされます。そして次のようにページのトップに記述します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:javascript library=<span class="xml&#45;quote">"prototype"</span> /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">If you require <a href="http://script.aculo.us/" target="blank">Scriptaculous</a> too you can do the following instead:</div>
<a href="http://script.aculo.us/" target="blank">Scriptaculous</a> も必要であれば、代わりに次のように指定します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:javascript library=<span class="xml&#45;quote">"scriptaculous"</span> /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Now all of Grails tags such as <a href="../ref/Tags/remoteLink.html" class="tags">remoteLink</a>, <a href="../ref/Tags/formRemote.html" class="tags">formRemote</a> and <a href="../ref/Tags/submitToRemote.html" class="tags">submitToRemote</a> work with Prototype remoting.</div>
この定義で他の<a href="../ref/Tags/remoteLink.html" class="tags">remoteLink</a>,<a href="../ref/Tags/formRemote.html" class="tags">formRemote</a>や<a href="../ref/Tags/submitToRemote.html" class="tags">submitToRemote</a>等のGrailsタグを使用できます。


<a name="7.7.3 Ajax with Dojo"><!-- Legacy link --></a>
<h2 id="ajaxWithDojo">7.7.3 Dojoを使用したAjax</h2>
<div class="hidden-block">Grails features an external plugin to add <a href="http://dojotoolkit.org/" target="blank">Dojo</a> support to Grails. To install the plugin type the following command from the root of your project in a terminal window:</div>
<div class="hidden-block">Grails features an external plugin to add <a href="http://dojotoolkit.org/" target="blank">Dojo</a> support to Grails. To install the plugin, list it in BuildConfig.groovy:</div>
<a href="http://dojotoolkit.org/" target="blank">Dojo</a> はプラグインで対応しています。インストールするにはBuildConfig.groovyにプラグインを定義します:<p class="paragraph"/><div class="code"><pre>compile <span class="java&#45;quote">"&#58;dojo&#58;latest.release"</span></pre></div><p class="paragraph"/><div class="hidden-block">This will download the current supported version of Dojo and install it into your Grails project. With that done you can add the following reference to the top of your page:</div>
このコマンドでDojoプラグインがダウンロードされプロジェクトにインストールされます。そして次のようにページのトップに記述します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:javascript library=<span class="xml&#45;quote">"dojo"</span> /&#62;</span></pre></div><p class="paragraph"/><div class="hidden-block">Now all of Grails tags such as <a href="../ref/Tags/remoteLink.html" class="tags">remoteLink</a>, <a href="../ref/Tags/formRemote.html" class="tags">formRemote</a> and <a href="../ref/Tags/submitToRemote.html" class="tags">submitToRemote</a> work with Dojo remoting.</div>
この定義で他の<a href="../ref/Tags/remoteLink.html" class="tags">remoteLink</a>,<a href="../ref/Tags/formRemote.html" class="tags">formRemote</a>や<a href="../ref/Tags/submitToRemote.html" class="tags">submitToRemote</a>等のGrailsタグを使用できます。


<a name="7.7.4 Ajax with GWT"><!-- Legacy link --></a>
<h2 id="ajaxWithGWT">7.7.4 GWTを使用したAjax</h2>
<div class="hidden-block">Grails also features support for the <a href="http://code.google.com/webtoolkit/" target="blank">Google Web Toolkit</a> through a plugin. There is comprehensive <a href="http://grails.org/plugin/gwt" target="blank">documentation</a> available on the Grails wiki.</div>
<a href="http://code.google.com/webtoolkit/" target="blank">Google Web Toolkit</a> をプラグインでサポートしています。詳しくは<a href="http://grails.org/plugin/gwt" target="blank">ドキュメント</a>を参照してください。


<a name="7.7.5 Ajax on the Server"><!-- Legacy link --></a>
<h2 id="ajaxOnTheServer">7.7.5 Ajax使用時のサーバサイド</h2>
<div class="hidden-block">There are a number of different ways to implement Ajax which are typically broken down into:</div>
Ajaxを実装するには幾つかの方法があります。通常次のように分類できます:<p class="paragraph"/><div class="hidden-block">
<ul class="star">
<li>Content Centric Ajax - Where you just use the HTML result of a remote call to update the page</li>
<li>Data Centric Ajax - Where you actually send an XML or JSON response from the server and programmatically update the page</li>
<li>Script Centric Ajax - Where the server sends down a stream of JavaScript to be evaluated on the fly</li>
</ul><p class="paragraph"/></div>
<ul class="star">
<li>コンテント中心なAjax - リモートコールの結果HTMLページを更新する。</li>
<li>データ中心なAjax - XMLまたはJSONをサーバから送信してページをプログラムで更新する。</li>
<li>スクリプトを使用したAjax - サーバからJavascriptを送信して実行させる。</li>
</ul><p class="paragraph"/><div class="hidden-block">Most of the examples in the <a href="../guide/single.html#ajax" class="guide">Ajax</a> section cover Content Centric Ajax where you are updating the page, but you may also want to use Data Centric or Script Centric. This guide covers the different styles of Ajax.</div>
<a href="../guide/single.html#ajax" class="guide">Ajax</a>セクションでの例のほとんどは、ページの更新を行うコンテント中心なAjaxを説明しました。データ中心やスクリプトを使用したAjaxも使用すると思います。このガイドでは他のスタイル尾Ajaxを解説します。<p class="paragraph"/><h4>コンテント中心のAjax <div class="hidden-block">Content Centric Ajax </div></h4><p class="paragraph"/><div class="hidden-block">Just to re-cap, content centric Ajax involves sending some HTML back from the server and is typically done by rendering a template with the <a href="../ref/Controllers/render.html" class="controllers">render</a> method:</div>
同じ説明になりますが、コンテント中心のAjaxでの要件はHTMLをサーバから返す事です。通常この場合はテンプレートを<a href="../ref/Controllers/render.html" class="controllers">render</a>メソッドで描写して実装します:<p class="paragraph"/><div class="code"><pre>def showBook() &#123;
    def b = Book.get(params.id)<p class="paragraph"/>    render(template: <span class="java&#45;quote">"bookTemplate"</span>, model: &#91;book: b&#93;)
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Calling this on the client involves using the <a href="../ref/Tags/remoteLink.html" class="tags">remoteLink</a> tag:</div>
これをクライアント側で<a href="../ref/Tags/remoteLink.html" class="tags">remoteLink</a>タグを使用して呼び出します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:remoteLink action=<span class="xml&#45;quote">"showBook"</span> id=<span class="xml&#45;quote">"$&#123;book.id&#125;"</span>
              update=<span class="xml&#45;quote">"book$&#123;book.id&#125;"</span>&#62;</span>Update Book<span class="xml&#45;tag">&#60;/g:remoteLink&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;div id=<span class="xml&#45;quote">"book$&#123;book.id&#125;"</span>&#62;</span>
   <span class="xml&#45;comment">&#60;!&#45;&#45;existing book mark&#45;up &#45;&#45;&#62;</span>
<span class="xml&#45;tag">&#60;/div&#62;</span></pre></div><p class="paragraph"/><h4>JSONを使用したデータ中心のAjax <div class="hidden-block">Data Centric Ajax with JSON </div></h4><p class="paragraph"/><div class="hidden-block">Data Centric Ajax typically involves evaluating the response on the client and updating programmatically. For a JSON response with Grails you would typically use Grails' <a href="../guide/single.html#xmlAndJSON" class="guide">JSON marshalling</a> capability:</div>
データ中心のAjaxでは、クライアントがレスポンスで取得した内容を評価してプログラムで更新をします。GrailsではJSONのレスポンスを返すには<a href="../guide/single.html#xmlAndJSON" class="guide">JSONマーシャリング</a>を使用します:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> grails.converters.JSON<p class="paragraph"/>def showBook() &#123;
    def b = Book.get(params.id)<p class="paragraph"/>    render b as JSON
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">And then on the client parse the incoming JSON request using an Ajax event handler:</div>
クライアント側で取得したJSONをAjaxイベントハンドラを使って処理します:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:javascript&#62;</span>
function updateBook(data) &#123;
    $(<span class="xml&#45;quote">"&#35;book"</span> + data.id + <span class="xml&#45;quote">"_title"</span>).html( data.title );
&#125;
<span class="xml&#45;tag">&#60;/g:javascript&#62;</span>
<span class="xml&#45;tag">&#60;g:remoteLink action=<span class="xml&#45;quote">"showBook"</span> id=<span class="xml&#45;quote">"$&#123;book.id&#125;"</span> onSuccess=<span class="xml&#45;quote">"updateBook(data)"</span>&#62;</span>
    Update Book
<span class="xml&#45;tag">&#60;/g:remoteLink&#62;</span>
<span class="xml&#45;tag">&#60;g:set var=<span class="xml&#45;quote">"bookId"</span>&#62;</span>book$&#123;book.id&#125;<span class="xml&#45;tag">&#60;/g:set&#62;</span>
<span class="xml&#45;tag">&#60;div id=<span class="xml&#45;quote">"$&#123;bookId&#125;"</span>&#62;</span>
    <span class="xml&#45;tag">&#60;div id=<span class="xml&#45;quote">"$&#123;bookId&#125;_title"</span>&#62;</span>The Stand<span class="xml&#45;tag">&#60;/div&#62;</span>
<span class="xml&#45;tag">&#60;/div&#62;</span></pre></div><p class="paragraph"/><h4>XMLを使用したデータ中心のAjax <div class="hidden-block">Data Centric Ajax with XML </div></h4><p class="paragraph"/><div class="hidden-block">On the server side using XML is equally simple:</div>
サーバサイドでXMLをえお扱うのも簡単です:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> grails.converters.XML<p class="paragraph"/>def showBook() &#123;
    def b = Book.get(params.id)<p class="paragraph"/>    render b as XML
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">However, since DOM is involved the client gets more complicated:</div>
しかしクライアント側でのDOM操作は複雑になります:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;g:javascript&#62;</span>
function updateBook(data) &#123;
    var id = $(data).find(<span class="xml&#45;quote">"book"</span>).attr(<span class="xml&#45;quote">"id"</span>);
    $(<span class="xml&#45;quote">"&#35;book"</span> + id + <span class="xml&#45;quote">"_title"</span>).html( $(data).find(<span class="xml&#45;quote">"title"</span>).text() );
&#125;
<span class="xml&#45;tag">&#60;g:javascript&#62;</span>
<span class="xml&#45;tag">&#60;g:remoteLink action=<span class="xml&#45;quote">"test"</span> update=<span class="xml&#45;quote">"foo"</span> onSuccess=<span class="xml&#45;quote">"updateBook(e)"</span>&#62;</span>
    Update Book
<span class="xml&#45;tag">&#60;/g:remoteLink&#62;</span>
<span class="xml&#45;tag">&#60;g:set var=<span class="xml&#45;quote">"bookId"</span>&#62;</span>book$&#123;book.id&#125;<span class="xml&#45;tag">&#60;/g:set&#62;</span>
<span class="xml&#45;tag">&#60;div id=<span class="xml&#45;quote">"$&#123;bookId&#125;"</span>&#62;</span>
    <span class="xml&#45;tag">&#60;div id=<span class="xml&#45;quote">"$&#123;bookId&#125;_title"</span>&#62;</span>The Stand<span class="xml&#45;tag">&#60;/div&#62;</span>
<span class="xml&#45;tag">&#60;/div&#62;</span></pre></div><p class="paragraph"/><h4>スクリプトを使用したAjax <div class="hidden-block">Script Centric Ajax with JavaScript </div></h4><p class="paragraph"/><div class="hidden-block">Script centric Ajax involves actually sending JavaScript back that gets evaluated on the client. An example of this can be seen below:</div>
スクリプトを使用したAjaxは、Javascriptを返してクライアント側で動作(評価)させます。以下が例になります:<p class="paragraph"/><div class="code"><pre>def showBook() &#123;
    def b = Book.get(params.id)<p class="paragraph"/>    response.contentType = <span class="java&#45;quote">"text/javascript"</span>
    <span class="java&#45;object">String</span> title = b.title.encodeAsJavaScript()
    render <span class="java&#45;quote">"&#36;('&#35;book$&#123;b.id&#125;_title').html('$&#123;title&#125;');"</span>
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">The important thing to remember is to set the <code>contentType</code> to <code>text/javascript</code>. If you use Prototype on the client the returned JavaScript will automatically be evaluated due to this <code>contentType</code> setting.</div>
重要な部分として<code>contentType</code>を<code>text/javascript</code>にすることを思えて起きましょう。Prototypeを使用した場合はこの<code>contentType</code>で自動的にJavaScriptを評価します。<p class="paragraph"/><div class="hidden-block">Obviously in this case it is critical that you have an agreed client-side API as you don't want changes on the client breaking the server. This is one of the reasons Rails has something like RJS. Although Grails does not currently have a feature such as RJS there is a <a href="http://grails.org/plugin/dynamic-javascript" target="blank">Dynamic JavaScript Plugin</a> that offers similar capabilities.</div>
当然このケースでは、クライアントがサーバを壊す事が無いと認めたクライアントサイトAPIでは無いと危険です。これがRailsではRJSを持っている理由です。Grailsには、RJSに相当する仕組みは存在しませんが、同じような内容の仕組みが <a href="http://grails.org/plugin/dynamic-javascript" target="blank">Dynamic JavaScript</a>プラグインで提供されています。<p class="paragraph"/><h4>AjaxとAjaxでない両方へのレスポンス <div class="hidden-block">Responding to both Ajax and non-Ajax requests </div></h4><p class="paragraph"/><div class="hidden-block">It's straightforward to have the same Grails controller action handle both Ajax and non-Ajax requests. Grails adds the <code>isXhr()</code> method to <code>HttpServletRequest</code> which can be used to identify Ajax requests. For example you could render a page fragment using a template for Ajax requests or the full page for regular HTTP requests:</div>
AjaxとAjaxではないリクエストを同じコントローラアクションで処理ができます。Grailsでは、Ajaxリクエスト判別用に、<code>HttpServletRequest</code>に<code>isXhr()</code>メソッドを追加しています。例として、Ajaxリクエストの場合はテンプレートでページの一部を描写し、それ以外は全ページ描写を行う場合:<p class="paragraph"/><div class="code"><pre>def listBooks() &#123;
    def books = Book.list(params)
    <span class="java&#45;keyword">if</span> (request.xhr) &#123;
        render template: <span class="java&#45;quote">"bookTable"</span>, model: &#91;books: books&#93;
    &#125; <span class="java&#45;keyword">else</span> &#123;
        render view: <span class="java&#45;quote">"list"</span>, model: &#91;books: books&#93;
    &#125;
&#125;</pre></div>


<a name="7.8 Content Negotiation"><!-- Legacy link --></a>
<h2 id="contentNegotiation">7.8 コンテントネゴシエーション</h2>
<div class="hidden-block">Grails has built in support for <a href="http://en.wikipedia.org/wiki/Content_negotiation" target="blank">Content negotiation</a> using either the HTTP <code>Accept</code> header, an explicit format request parameter or the extension of a mapped URI.</div>
Grailsには、明示的なフォーマットに対するリクエストのHTTP <code>Accept</code>ヘッダーまたはマップされたURIの拡張子での<a href="http://en.wikipedia.org/wiki/Content_negotiation" target="blank">コンテントネゴシエーション</a>に対応しています。<p class="paragraph"/><h4>Mimeタイプの定義 <div class="hidden-block">Configuring Mime Types</div></h4><p class="paragraph"/><div class="hidden-block">Before you can start dealing with content negotiation you need to tell Grails what content types you wish to support. By default Grails comes configured with a number of different content types within <code>grails-app/conf/Config.groovy</code> using the <code>grails.mime.types</code> setting: </div>
コンテントネゴシエーションの処理を行うには、どのコンテントタイプをサポートするかをGrailsに教える必要があります。<code>grails-app/conf/Config.groovy</code>の<code>grails.mime.types</code>設定に幾つかのコンテントタイプがデフォルトで定義されています:<p class="paragraph"/><div class="code"><pre>grails.mime.types = &#91; xml: &#91;'text/xml', 'application/xml'&#93;,
                      text: 'text&#45;plain',
                      js: 'text/javascript',
                      rss: 'application/rss+xml',
                      atom: 'application/atom+xml',
                      css: 'text/css',
                      csv: 'text/csv',
                      all: '&#42;/&#42;',
                      json: 'text/json',
                      html: &#91;'text/html','application/xhtml+xml'&#93;
                    &#93;</pre></div><p class="paragraph"/><div class="hidden-block">The above bit of configuration allows Grails to detect to format of a request containing either the 'text/xml' or 'application/xml' media types as simply 'xml'. You can add your own types by simply adding new entries into the map.</div>
この設定の一部を説明すると、'text/xml'または'application/xml'を含むリクエストは単純にコンテントタイプ'xml'としてGrailsが検出するのを可能にします。独自のタイプを追加するには単純にマップにタイプを追加するだけです。<p class="paragraph"/><h4>Content Negotiation using the format parameter</h4><p class="paragraph"/>Let's say a controller action can return a resource in a variety of formats: HTML, XML, and JSON. What format will the client get? The easiest and most reliable way for the client to control this is through a <code>format</code> URL parameter.<p class="paragraph"/>So if you, as a browser or some other client, want a resource as XML, you can use a URL like this:<p class="paragraph"/><div class="code"><pre>http://my.domain.org/books?format=xml</pre></div><p class="paragraph"/>The result of this on the server side is a <code>format</code> property on the <code>response</code> object with the value <code>xml</code> . You could code your controller action to return XML based on this property, but you can also make use of the controller-specific <code>withFormat()</code> method:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> grails.converters.JSON
<span class="java&#45;keyword">import</span> grails.converters.XML<p class="paragraph"/>class BookController &#123;<p class="paragraph"/>    def list() &#123;
        def books = Book.list()<p class="paragraph"/>        withFormat &#123;
            html bookList: books
            json &#123; render books as JSON &#125;
            xml &#123; render books as XML &#125;
        &#125;
    &#125;
&#125;</pre></div><p class="paragraph"/>In this example, Grails will only execute the block inside <code>withFormat()</code> that matches the requested content type. So if the preferred format is <code>html</code> then Grails will execute the <code>html()</code> call only. Each 'block' can either be a map model for the corresponding view (as we are doing for 'html' in the above example) or a closure. The closure can contain any standard action code, for example it can return a model or render content directly.<p class="paragraph"/>There is a special format, "all", that is handled differently from the explicit formats. If "all" is specified (normally this happens through the Accept header - see below), then the first block of <code>withFormat()</code> is executed. You should not add an explicit "all" block. In the above example, a format of "all" will trigger the <code>html</code> handler.<p class="paragraph"/><blockquote class="note">
When using <a href="../ref/Controllers/withFormat.html" class="controllers">withFormat</a> make sure it is the last call in your controller action as the return value of the <code>withFormat</code> method is used by the action to dictate what happens next.
</blockquote><p class="paragraph"/><h4>Acceptヘッダーを使用する <div class="hidden-block">Using the Accept header </div></h4><p class="paragraph"/>Every incoming HTTP request has a special <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html" target="blank">Accept</a> header that defines what media types (or mime types) a client can "accept". In older browsers this is typically:<p class="paragraph"/><div class="code"><pre>&#42;/&#42;</pre></div><p class="paragraph"/>which simply means anything. However, newer browsers send more interesting values such as this one sent by Firefox:<p class="paragraph"/><div class="code"><pre>text/xml, application/xml, application/xhtml+xml, text/html;q=0.9, &#10;    text/plain;q=0.8, image/png, &#42;/&#42;;q=0.5</pre></div><p class="paragraph"/>This particular accept header is unhelpful because it indicates that XML is the preferred response format whereas the user is really expecting HTML. That's why Grails ignores the accept header by default for browsers. However, non-browser clients are typically more specific in their requirements and can send accept headers such as<p class="paragraph"/><div class="code"><pre>application/json</pre></div><p class="paragraph"/>As mentioned the default configuration in Grails is to ignore the accept header for browsers. This is done by the configuration setting <code>grails.mime.disable.accept.header.userAgents</code>, which is configured to detect the major rendering engines and ignore their ACCEPT headers. This allows Grails' content negotiation to continue to work for non-browser clients:<p class="paragraph"/><div class="code"><pre>grails.mime.disable.accept.header.userAgents = &#91;'Gecko', 'WebKit', 'Presto', 'Trident'&#93;</pre></div><p class="paragraph"/>For example, if it sees the accept header above ('application/json') it will set <code>format</code> to <code>json</code> as you'd expect. And of course this works with the <code>withFormat()</code> method in just the same way as when the <code>format</code> URL parameter is set (although the URL parameter takes precedence).<p class="paragraph"/>An accept header of '&#42;/&#42;' results in a value of <code>all</code> for the <code>format</code> property.<p class="paragraph"/>
<h4>リクエストフォーマット vs レスポンスフォーマット <div class="hidden-block">Request format vs. Response format </div></h4><p class="paragraph"/><div class="hidden-block">As of Grails 2.0, there is a separate notion of the  <em class="italic">request</em>  format and the  <em class="italic">response</em>  format. The request format is dictated by the <code>CONTENT_TYPE</code> header and is typically used to detect if the incoming request can be parsed into XML or JSON, whilst the response format uses the file extension, format parameter or ACCEPT header to attempt to deliver an appropriate response to the client.</div>
Grails 2.0からの対応で、リクエストフォーマットとレスポンスフォーマットでは分離して認識するようになりました。リクエストフォーマットは、<code>CONTENT_TYPE</code>ヘッダの指定で入ってくるリクエストを認識してXMLまたJSON等に分類します。レスポンスフォーマットでは、ファイル拡張子、フォーマットパラメータまたはACCEPTヘッダを認識して適したレスポンスをクライアントに返します。<p class="paragraph"/><div class="hidden-block">The <a href="../ref/Controllers/withFormat.html" class="controllers">withFormat</a> available on controllers deals specifically with the response format. If you wish to add logic that deals with the request format then you can do so using a separate <code>withFormat</code> method available on the request:</div>
コントローラでの<a href="../ref/Controllers/withFormat.html" class="controllers">withFormat</a>はレスポンスフォーマット専用となります。リクエストフォーマットでロジックを記述する場合は、requestオブジェクトの<code>withFormat</code>メソッドを使用します:<p class="paragraph"/><div class="code"><pre>request.withFormat &#123;
    xml &#123;
        // read XML
    &#125;
    json &#123;
        // read JSON
    &#125;
&#125;</pre></div><p class="paragraph"/><h4>リクエストパラメータformatでのコンテントネゴシエーション <div class="hidden-block">Content Negotiation with the format Request Parameter </div></h4><p class="paragraph"/><div class="hidden-block">If fiddling with request headers if not your favorite activity you can override the format used by specifying a <code>format</code> request parameter:</div>
リクエストヘッダを参照した方法を行いたく無い場合は、フォーマットを指定するために、リクエストパラメータの<code>format</code>が使用できます:<p class="paragraph"/><div class="code"><pre>/book/list?format=xml</pre></div><p class="paragraph"/><div class="hidden-block">You can also define this parameter in the <a href="../guide/single.html#urlmappings" class="guide">URL Mappings</a> definition:</div>
このパラメータは<a href="../guide/single.html#urlmappings" class="guide">URLマッピング</a>でも定義できます:<p class="paragraph"/><div class="code"><pre><span class="java&#45;quote">"/book/list"</span>(controller:<span class="java&#45;quote">"book"</span>, action:<span class="java&#45;quote">"list"</span>) &#123;
    format = <span class="java&#45;quote">"xml"</span>
&#125;</pre></div><p class="paragraph"/><h4>URI拡張子でのコンテントネゴシエーション <div class="hidden-block">Content Negotiation with URI Extensions </div></h4><p class="paragraph"/><div class="hidden-block">Grails also supports content negotiation using URI extensions. For example given the following URI:</div>
URI拡張子でのコンテントネゴシエーションにも対応しています。例として次のようなURIがあるとします:<p class="paragraph"/><div class="code"><pre>/book/list.xml</pre></div><p class="paragraph"/>This works as a result of the default URL Mapping definition which is:<p class="paragraph"/><div class="code"><pre><span class="java&#45;quote">"/$controller/$action?/$id?(.$&#123;format&#125;)?"</span>&#123;</pre></div><p class="paragraph"/>Note the inclusion of the <code>format</code> variable in the path. If you do not wish to use content negotiation via the file extension then simply remove this part of the URL mapping:<p class="paragraph"/><div class="code"><pre><span class="java&#45;quote">"/$controller/$action?/$id?"</span>&#123;</pre></div><p class="paragraph"/>
<h4>コンテントネゴシエーションをテスト <div class="hidden-block">Testing Content Negotiation </div></h4><p class="paragraph"/><div class="hidden-block">To test content negotiation in a unit or integration test (see the section on <a href="../guide/single.html#testing" class="guide">Testing</a>) you can either manipulate the incoming request headers:</div>
ユニットテストまたは統合テスト(<a href="../guide/single.html#testing" class="guide">テスト</a>のセクションを参照)でコンテントネゴシエーションをテストする際に、入ってくるリクエストヘッダを操作することができます:<p class="paragraph"/><div class="code"><pre>void testJavascriptOutput() &#123;
    def controller = <span class="java&#45;keyword">new</span> TestController()
    controller.request.addHeader <span class="java&#45;quote">"Accept"</span>,
              <span class="java&#45;quote">"text/javascript, text/html, application/xml, text/xml, &#42;/&#42;"</span><p class="paragraph"/>    controller.testAction()
    assertEquals <span class="java&#45;quote">"alert('hello')"</span>, controller.response.contentAsString
&#125;</pre></div><p class="paragraph"/><div class="hidden-block">Or you can set the format parameter to achieve a similar effect:</div>
または、formatパラメータをセットすることが可能です:<p class="paragraph"/><div class="code"><pre>void testJavascriptOutput() &#123;
    def controller = <span class="java&#45;keyword">new</span> TestController()
    controller.params.format = 'js'<p class="paragraph"/>    controller.testAction()
    assertEquals <span class="java&#45;quote">"alert('hello')"</span>, controller.response.contentAsString
&#125;</pre></div>



                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../guide/GORM.html">&lt;&lt; <strong>6</strong><span>O/R&#12510;&#12483;&#12500;&#12531;&#12464; (GORM)</span></a></div>
                
                    <div class="toc-item next-right"><a href="../guide/webServices.html"><strong>8</strong><span>Web&#12469;&#12540;&#12499;&#12473;</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Command Line</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Command%20Line/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/add-proxy.html">add-proxy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/alias.html">alias</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/bootstrap.html">bootstrap</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/bug-report.html">bug-report</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/clean.html">clean</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/clear-proxy.html">clear-proxy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/compile.html">compile</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/console.html">console</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-app.html">create-app</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-controller.html">create-controller</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-domain-class.html">create-domain-class</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-filters.html">create-filters</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-hibernate-cfg-xml.html">create-hibernate-cfg-xml</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-integration-test.html">create-integration-test</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-multi-project-build.html">create-multi-project-build</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-plugin.html">create-plugin</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-pom.html">create-pom</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-scaffold-controller.html">create-scaffold-controller</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-script.html">create-script</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-service.html">create-service</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-tag-lib.html">create-tag-lib</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-unit-test.html">create-unit-test</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/dependency-report.html">dependency-report</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/doc.html">doc</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/generate-all.html">generate-all</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/generate-controller.html">generate-controller</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/generate-views.html">generate-views</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/help.html">help</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/init.html">init</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/install-dependency.html">install-dependency</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/install-plugin.html">install-plugin</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/install-templates.html">install-templates</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/integrate-with.html">integrate-with</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/interactive.html">interactive</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/list-plugin-updates.html">list-plugin-updates</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/list-plugins.html">list-plugins</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/migrate-docs.html">migrate-docs</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/package-plugin.html">package-plugin</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/package.html">package</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/plugin-info.html">plugin-info</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/refresh-dependencies.html">refresh-dependencies</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/remove-proxy.html">remove-proxy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/run-app.html">run-app</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/run-script.html">run-script</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/run-war.html">run-war</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/schema-export.html">schema-export</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/set-proxy.html">set-proxy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/set-version.html">set-version</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/shell.html">shell</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/stats.html">stats</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/stop-app.html">stop-app</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/test-app.html">test-app</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/uninstall-plugin.html">uninstall-plugin</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/upgrade.html">upgrade</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/war.html">war</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/wrapper.html">wrapper</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Constraints</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Constraints/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Constraints/attributes.html">attributes</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/bindable.html">bindable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/blank.html">blank</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/creditCard.html">creditCard</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/email.html">email</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/inList.html">inList</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/matches.html">matches</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/max.html">max</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/maxSize.html">maxSize</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/min.html">min</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/minSize.html">minSize</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/notEqual.html">notEqual</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/nullable.html">nullable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/range.html">range</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/scale.html">scale</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/size.html">size</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/unique.html">unique</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/url.html">url</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/validator.html">validator</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/widget.html">widget</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Controllers</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Controllers/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Controllers/actionName.html">actionName</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/afterInterceptor.html">afterInterceptor</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/allowedMethods.html">allowedMethods</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/beforeInterceptor.html">beforeInterceptor</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/bindData.html">bindData</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/chain.html">chain</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/controllerName.html">controllerName</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/defaultAction.html">defaultAction</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/flash.html">flash</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/forward.html">forward</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/grailsApplication.html">grailsApplication</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/namespace.html">namespace</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/params.html">params</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/redirect.html">redirect</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/render.html">render</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/request.html">request</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/respond.html">respond</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/response.html">response</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/responseFormats.html">responseFormats</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/servletContext.html">servletContext</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/session.html">session</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/withForm.html">withForm</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/withFormat.html">withFormat</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Database Mapping</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Database%20Mapping/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/autoImport.html">autoImport</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/autoTimestamp.html">autoTimestamp</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/batchSize.html">batchSize</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/cache.html">cache</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/cascade.html">cascade</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/column.html">column</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/comment.html">comment</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/discriminator.html">discriminator</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/dynamicInsert.html">dynamicInsert</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/dynamicUpdate.html">dynamicUpdate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/fetch.html">fetch</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/id.html">id</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/ignoreNotFound.html">ignoreNotFound</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/indexColumn.html">indexColumn</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/insertable.html">insertable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/joinTable.html">joinTable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/lazy.html">lazy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/order.html">order</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/sort.html">sort</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/table.html">table</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/type.html">type</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/updateable.html">updateable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/version.html">version</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Domain Classes</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Domain%20Classes/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/addTo.html">addTo</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/attach.html">attach</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/belongsTo.html">belongsTo</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/clearErrors.html">clearErrors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/constraints.html">constraints</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/count.html">count</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/countBy.html">countBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/createCriteria.html">createCriteria</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/delete.html">delete</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/discard.html">discard</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/embedded.html">embedded</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/errors.html">errors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/executeQuery.html">executeQuery</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/executeUpdate.html">executeUpdate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/exists.html">exists</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/fetchMode.html">fetchMode</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/find.html">find</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findAll.html">findAll</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findAllBy.html">findAllBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findAllWhere.html">findAllWhere</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findBy.html">findBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findOrCreateBy.html">findOrCreateBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findOrCreateWhere.html">findOrCreateWhere</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findOrSaveBy.html">findOrSaveBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findOrSaveWhere.html">findOrSaveWhere</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findWhere.html">findWhere</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/first.html">first</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/get.html">get</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/getAll.html">getAll</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/getDirtyPropertyNames.html">getDirtyPropertyNames</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/getPersistentValue.html">getPersistentValue</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/hasErrors.html">hasErrors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/hasMany.html">hasMany</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/hasOne.html">hasOne</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/ident.html">ident</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/instanceOf.html">instanceOf</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/isAttached.html">isAttached</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/isDirty.html">isDirty</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/last.html">last</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/list.html">list</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/listOrderBy.html">listOrderBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/load.html">load</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/lock.html">lock</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/mapWith.html">mapWith</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/mappedBy.html">mappedBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/mapping.html">mapping</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/merge.html">merge</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/namedQueries.html">namedQueries</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/properties.html">properties</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/read.html">read</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/refresh.html">refresh</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/removeFrom.html">removeFrom</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/save.html">save</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/transients.html">transients</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/validate.html">validate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/where.html">where</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/whereAny.html">whereAny</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/withCriteria.html">withCriteria</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/withNewSession.html">withNewSession</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/withSession.html">withSession</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/withTransaction.html">withTransaction</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Plug-ins</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Plug-ins/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/URL%20mappings.html">URL mappings</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/codecs.html">codecs</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/controllers.html">controllers</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/core.html">core</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/dataSource.html">dataSource</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/domainClasses.html">domainClasses</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/filters.html">filters</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/hibernate.html">hibernate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/i18n.html">i18n</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/logging.html">logging</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/scaffolding.html">scaffolding</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/services.html">services</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/servlets.html">servlets</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/web%20flow.html">web flow</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Services</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Services/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Services/scope.html">scope</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Services/transactional.html">transactional</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Servlet API</h1><div class="menu-sub">
                        
                            
                            <div class="menu-item"><a href="../ref/Servlet%20API/request.html">request</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Servlet%20API/response.html">response</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Servlet%20API/servletContext.html">servletContext</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Servlet%20API/session.html">session</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Tag Libraries</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Tag%20Libraries/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Tag%20Libraries/actionName.html">actionName</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tag%20Libraries/controllerName.html">controllerName</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tag%20Libraries/flash.html">flash</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tag%20Libraries/pageScope.html">pageScope</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tag%20Libraries/params.html">params</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tag%20Libraries/request.html">request</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tag%20Libraries/response.html">response</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tag%20Libraries/servletContext.html">servletContext</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tag%20Libraries/session.html">session</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Tags</h1><div class="menu-sub">
                        
                            
                            <div class="menu-item"><a href="../ref/Tags/actionSubmit.html">actionSubmit</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/actionSubmitImage.html">actionSubmitImage</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/applyLayout.html">applyLayout</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/checkBox.html">checkBox</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/collect.html">collect</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/cookie.html">cookie</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/country.html">country</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/countrySelect.html">countrySelect</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/createLink.html">createLink</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/createLinkTo.html">createLinkTo</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/currencySelect.html">currencySelect</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/datePicker.html">datePicker</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/each.html">each</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/eachError.html">eachError</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/else.html">else</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/elseif.html">elseif</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/external.html">external</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/field.html">field</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/fieldValue.html">fieldValue</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/findAll.html">findAll</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/form.html">form</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/formRemote.html">formRemote</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/formatBoolean.html">formatBoolean</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/formatDate.html">formatDate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/formatNumber.html">formatNumber</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/grep.html">grep</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/hasErrors.html">hasErrors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/header.html">header</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/hiddenField.html">hiddenField</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/if.html">if</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/img.html">img</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/include.html">include</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/isAvailable.html">isAvailable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/isNotAvailable.html">isNotAvailable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/javascript.html">javascript</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/join.html">join</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/layoutBody.html">layoutBody</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/layoutHead.html">layoutHead</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/layoutTitle.html">layoutTitle</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/link.html">link</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/localeSelect.html">localeSelect</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/message.html">message</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/meta.html">meta</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/pageProperty.html">pageProperty</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/paginate.html">paginate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/passwordField.html">passwordField</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/radio.html">radio</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/radioGroup.html">radioGroup</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/remoteField.html">remoteField</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/remoteFunction.html">remoteFunction</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/remoteLink.html">remoteLink</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/render.html">render</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/renderErrors.html">renderErrors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/resource.html">resource</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/select.html">select</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/set.html">set</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/setProvider.html">setProvider</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/sortableColumn.html">sortableColumn</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/submitButton.html">submitButton</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/submitToRemote.html">submitToRemote</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/textArea.html">textArea</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/textField.html">textField</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/timeZoneSelect.html">timeZoneSelect</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/unless.html">unless</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/uploadForm.html">uploadForm</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Tags/while.html">while</a>
                            </div>
                            
                            </div>
                    </div>
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    Copies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically. <br/>[注意]このGrails日本語ドキュメントは、有志による翻訳というよりは意訳なドキュメントです。 Grails日本語ドキュメントに関するお問い合わせ、ドキュメントプロジェクトに参加したい等の問い合わせは。 twitter: @tyama 迄<br/>
    Sponsored by <a href="http://springsource.com">SpringSource</a> 
</div>

<script type="text/javascript" src="../../js/docs.js"></script>

</body>
</html>
